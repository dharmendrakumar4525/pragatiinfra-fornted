"use strict";(self.webpackChunkpra=self.webpackChunkpra||[]).push([[384],{2384:(Ze,E,u)=>{u.r(E),u.d(E,{PurchaseOrderModule:()=>be});var _=u(6895),d=u(4006),h=u(8608),P=u(7489),$=u(5439),M=u(2340),t=u(4650),w=u(2126),D=u(6104),S=u(529),f=u(9299),F=u(3238),b=u(9549),Z=u(9602),N=u(4850),C=u(7392),q=u(4144),J=u(4385),L=u(3683);function G(r,n){if(1&r&&(t.TgZ(0,"mat-option",39),t._uU(1),t.qZA()),2&r){const i=n.$implicit;t.Q6J("value",i.value),t.xp6(1),t.Oqu(i.label)}}const B=function(r){return["/purchase-order/update",r]};function H(r,n){if(1&r&&(t.TgZ(0,"td",52),t._uU(1,"View\xa0PO"),t.qZA()),2&r){const i=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,B,i._id))}}const z=function(r){return["/purchase-order/details",r]};function K(r,n){if(1&r&&(t.TgZ(0,"td",53),t._uU(1,"Approved Vendors"),t.qZA()),2&r){const i=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,z,i._id))}}function V(r,n){if(1&r&&(t.TgZ(0,"td",54),t._uU(1,"Rejected Rates"),t.qZA()),2&r){const i=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,z,i._id))}}function X(r,n){if(1&r&&(t.TgZ(0,"td",56),t._uU(1,"Revise Rates"),t.qZA()),2&r){const i=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(1,B,i._id))}}function tt(r,n){if(1&r&&(t.ynx(0),t.YNc(1,X,2,3,"td",55),t.BQk()),2&r){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","revise"==i.status)}}function et(r,n){1&r&&(t.TgZ(0,"td",58),t._uU(1,"No Permission TO Revise Rates"),t.qZA())}function it(r,n){if(1&r&&t.YNc(0,et,2,0,"td",57),2&r){const i=t.oxw().$implicit;t.Q6J("ngIf","revise"==i.status)}}function nt(r,n){if(1&r&&(t.TgZ(0,"tr")(1,"td",40),t._uU(2," Request no : "),t.TgZ(3,"span",41),t._uU(4),t.qZA()(),t.TgZ(5,"td",42),t._uU(6),t._UZ(7,"span",41),t.qZA(),t._UZ(8,"hr",43),t.TgZ(9,"td",44),t._uU(10),t.qZA(),t._UZ(11,"hr",45),t.TgZ(12,"td",46),t._uU(13,"Title\xa0: "),t.TgZ(14,"span",41),t._uU(15),t.qZA()(),t._UZ(16,"hr",43),t.YNc(17,H,2,3,"td",47),t.YNc(18,K,2,3,"td",48),t.YNc(19,V,2,3,"td",49),t.YNc(20,tt,2,1,"ng-container",16),t.YNc(21,it,1,1,"ng-template",null,50,t.W1O),t.TgZ(23,"td",51)(24,"mat-icon"),t._uU(25," arrow_forward_ios "),t.qZA()()()),2&r){const i=n.$implicit,e=t.MAs(22),o=t.oxw(2);t.xp6(4),t.Oqu(o.reqNo(i.title)),t.xp6(2),t.hij(" PO No : ",i.po_number,""),t.xp6(4),t.hij("Requested on: ",i.date,""),t.xp6(5),t.Oqu(i.title),t.xp6(2),t.Q6J("ngIf","pending"==i.status),t.xp6(1),t.Q6J("ngIf","approved"==i.status),t.xp6(1),t.Q6J("ngIf","rejected"==i.status),t.xp6(1),t.Q6J("ngIf",o.editPermission)("ngIfElse",e)}}function ot(r,n){1&r&&(t.TgZ(0,"div",59),t._UZ(1,"img",60),t.TgZ(2,"span"),t._uU(3," No record found"),t.qZA()())}function rt(r,n){if(1&r){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",18)(2,"div",19)(3,"mat-form-field",20)(4,"mat-icon",21),t._uU(5,"search"),t.qZA(),t.TgZ(6,"input",22),t.NdJ("input",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.search(o,"title"))}),t.qZA()()(),t.TgZ(7,"div",23)(8,"div",24)(9,"span"),t._uU(10,"Filter\xa0by"),t.qZA()(),t.TgZ(11,"div")(12,"mat-form-field",25)(13,"input",26),t.NdJ("click",function(){t.CHM(i);const o=t.MAs(16);return t.KtG(o.open())})("dateChange",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.dateFilter(o))}),t.qZA(),t._UZ(14,"mat-datepicker-toggle",27)(15,"mat-datepicker",null,28),t.qZA()()(),t.TgZ(17,"div",23)(18,"div",29)(19,"span"),t._uU(20,"Filter\xa0by"),t.qZA()(),t.TgZ(21,"div")(22,"mat-form-field",25)(23,"input",30),t.NdJ("input",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.search(o,"site"))}),t.qZA()()()(),t.TgZ(24,"div",23)(25,"div",29)(26,"span"),t._uU(27,"Filter by Status"),t.qZA()(),t.TgZ(28,"div",31)(29,"mat-form-field",32)(30,"mat-select",33),t.NdJ("selectionChange",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.onStatusChange(o))}),t.YNc(31,G,2,2,"mat-option",34),t.qZA()()()()(),t.TgZ(32,"div",35)(33,"table",36)(34,"tbody"),t.YNc(35,nt,26,9,"tr",37),t.qZA()(),t.YNc(36,ot,4,0,"div",38),t.qZA(),t.BQk()}if(2&r){const i=t.MAs(16),e=t.oxw();t.xp6(13),t.Q6J("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(16),t.Q6J("formControl",e.statusOption),t.xp6(1),t.Q6J("ngForOf",e.statusList),t.xp6(4),t.Q6J("ngForOf",e.rateComparativeList),t.xp6(1),t.Q6J("ngIf",!(e.rateComparativeList&&e.rateComparativeList.length>0))}}function at(r,n){1&r&&(t.TgZ(0,"h3",61),t._uU(1,"You don't have permissions to view."),t.qZA())}const st=function(){return["/procurement"]},dt=function(){return["/procurement/prlist"]},lt=function(){return["/rate-comparative"]},pt=function(){return["/rate-approval"]},ct=function(){return["/purchase-order"]};let ut=(()=>{class r{constructor(i,e,o){this.httpService=i,this.snack=e,this.http=o,this.apiUrl=h.TK,this.statusOption=new d.NI("pending"),this.statusList=[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"},{value:"revise",label:"Revise"}],this.filter_by="status",this.filter_value="pending",this.requestType="new",this.originalRateComparativeList=[],this.purchaseList=[],this.purchaseOrderList=[],this.purchase_request_number=[],this.getList({filter_by:this.filter_by,filter_value:this.filter_value})}getList(i){this.httpService.GET(h.TK,i).subscribe({next:e=>{e.data.forEach(o=>{o.date=$(o.updated_at).format("DD-MM-YYYY")}),this.originalRateComparativeList=e.data,this.rateComparativeList=e.data,console.log("this.originalRateComparativeList",this.originalRateComparativeList)},error:e=>{if(e.errors&&!(0,P.isEmpty)(e.errors)){let o="<ul>";for(let s in e.errors)o+=`<li>${e.errors[s][0]}</li>`;o+="</ul>",this.snack.notifyHtml(o,2)}else this.snack.notify(e.message,2)}})}onStatusChange(i){this.getList({filter_by:this.filter_by,filter_value:i.value})}dateFilter(i){this.originalRateComparativeList&&this.originalRateComparativeList.length>0&&(this.rateComparativeList=i.value?this.originalRateComparativeList.filter(e=>new Date(e.date)==new Date(i.value)):this.originalRateComparativeList)}search(i,e){this.originalRateComparativeList&&this.originalRateComparativeList.length>0&&(this.rateComparativeList="site"==e?i.target.value?this.originalRateComparativeList.filter(o=>o.siteData.site_name.toLowerCase().includes(i.target.value.toLowerCase())):this.originalRateComparativeList:i.target.value?this.originalRateComparativeList.filter(o=>o.title.toLowerCase().includes(i.target.value.toLowerCase())):this.originalRateComparativeList)}getReqNO(){const i=this.http.get(`${M.N.api_path}${h.Fj}`);this.httpService.multipleRequests([i],{}).subscribe(o=>{o&&(this.purchaseList=o[0].data)});const e=this.http.get(`${M.N.api_path}${h.TK}`);this.httpService.multipleRequests([e],{}).subscribe(o=>{o&&(this.purchaseOrderList=o[0].data)})}reqNo(i){return this.purchaseList.filter(o=>o.title===i)[0].purchase_request_number}poNo(i){return this.purchaseOrderList.filter(s=>s.billing_address.company_name.includes(i.code)).length}ngOnInit(){this.getReqNO(),this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:o=>{this.viewPermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[0].isSelected,this.editPermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[2].isSelected},error:o=>{console.log(o)}})}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(w.s),t.Y36(D.o),t.Y36(S.eN))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-purchase-order-list"]],decls:45,vars:12,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","50px","margin-left","20px"],["src","./assets/images/POL.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],["src","./assets/images/rc.svg"],["src","./assets/images/podown.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],[4,"ngIf","ngIfElse"],["noView",""],[2,"display","flex","flex-direction","row","gap","10px"],[2,"margin-left","40px","width","20%","margin-top","30px"],["appearance","outline",1,"searchbar"],["matSuffix",""],["matInput","","type","search","placeholder","search title",1,"search-input",3,"input"],[2,"margin-top","30px","display","flex","gap","10px"],[2,"margin-top","15px","color","#94A3B8","margin-left","40px"],["appearance","outline",1,"datebar"],["matInput","","placeholder","Date",3,"matDatepicker","click","dateChange"],["matSuffix","",3,"for"],["startPicker",""],[2,"margin-top","15px","color","#94A3B8"],["matInput","","placeholder","Site",3,"input"],[1,"custom-form-control",2,"width","50%"],["appearance","outline",2,"width","100%"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"scroll-bar1",2,"width","93%"],[2,"direction","ltr !important","margin-top","-20px"],[4,"ngFor","ngForOf"],["class","no-record-found",4,"ngIf"],[3,"value"],[2,"color","#4272BF","width","200px","text-align","left","padding","10px","font-size","15px"],[2,"color","#000000"],[2,"color","#4272BF","width","300px","text-align","left","padding","10px","font-size","15px"],[2,"border","1px solid #D9D9D9","height","30px"],[2,"color","#4272BF","width","400px"],[2,"border","1px solid hsl(0, 0%, 85%)","height","30px"],[2,"color","#4272BF","width","500px","font-size","15px"],["style","background-color: #233A61;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["style","background-color: #54AA52;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["style","background-color: #C7323B;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["noEditPermission",""],[2,"width","100px"],[2,"background-color","#233A61","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],[2,"background-color","#54AA52","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],[2,"background-color","#C7323B","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],["style","background-color: #ECD172;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],[2,"background-color","#ECD172","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],["style","background-color: #ECD172;color:#fff;width:200px;font-size: 14px;cursor: pointer;","disabled","",4,"ngIf"],["disabled","",2,"background-color","#ECD172","color","#fff","width","200px","font-size","14px","cursor","pointer"],[1,"no-record-found"],["src","./assets/images/inbox_empty.png","alt",""],[2,"display","flex","justify-content","center","margin-top","2%","font-size","160%","font-weight","bolder","color","grey"]],template:function(i,e){if(1&i&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Purchase Order"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",9),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",13),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",12),t.qZA(),t.TgZ(33,"span",9),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",10),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",14),t.qZA(),t.TgZ(40,"span",15),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.YNc(42,rt,37,6,"ng-container",16),t.YNc(43,at,2,0,"ng-template",null,17,t.W1O)),2&i){const o=t.MAs(44);t.xp6(9),t.Q6J("routerLink",t.DdM(7,st)),t.xp6(7),t.Q6J("routerLink",t.DdM(8,dt)),t.xp6(7),t.Q6J("routerLink",t.DdM(9,lt)),t.xp6(7),t.Q6J("routerLink",t.DdM(10,pt)),t.xp6(7),t.Q6J("routerLink",t.DdM(11,ct)),t.xp6(5),t.Q6J("ngIf",e.viewPermission)("ngIfElse",o)}},dependencies:[f.rH,f.Od,_.sg,_.O5,F.ey,b.KE,b.R9,Z.Mq,Z.hl,Z.nW,N.d,C.Hw,q.Nt,J.gD,L.Ye,d.JJ,d.oH],styles:[".mat-form-field-appearance-outline .mat-form-field-infix{padding:.6em;width:250px}mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}input[type=text][_ngcontent-%COMP%]{width:60%;border-radius:8px;padding:12px 20px;margin:8px 0;box-sizing:border-box;border:.5px solid #94A3B8;transition:.5s;outline:none;font-family:Poppins;font-size:15px}.requests[_ngcontent-%COMP%]{height:40px;width:1120px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:15px}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:15px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:15px;display:flex;align-items:center;justify-content:center}.searchbar[_ngcontent-%COMP%]{width:100%;border-radius:20px;font-family:Poppins}.datebar[_ngcontent-%COMP%]{width:180px;border-radius:20px;font-family:Poppins}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:separate;border-spacing:0 25px;text-align:left;width:100%;font-size:12px;margin-left:30px;margin-bottom:20px;margin-right:-10px}td[_ngcontent-%COMP%]{border:none;text-align:center;padding:8px 1px;color:#233a61;font-style:normal;font-size:medium}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f4f4f5!important}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f4f4f5!important}.scroll-bar1[_ngcontent-%COMP%]{height:600px;width:93%;margin-left:20px;margin-bottom:100px;margin-top:10px;overflow:auto;direction:rtl;overflow-x:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1E293B;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.no-record-found[_ngcontent-%COMP%]{text-align:center;display:flex;gap:10px;flex-direction:column;align-items:center;justify-content:center}.no-record-found[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:188px}"]}),r})();var mt=u(9836),gt=u(8898),ht=u(1283),R=u(5861);class U{constructor(n,i,e,o){if(isNaN(n)||isNaN(i))throw new Error(`Point is invalid: (${n}, ${i})`);this.x=+n,this.y=+i,this.pressure=e||0,this.time=o||Date.now()}distanceTo(n){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))}equals(n){return this.x===n.x&&this.y===n.y&&this.pressure===n.pressure&&this.time===n.time}velocityFrom(n){return this.time!==n.time?this.distanceTo(n)/(this.time-n.time):0}}class I{static fromPoints(n,i){const e=this.calculateControlPoints(n[0],n[1],n[2]).c2,o=this.calculateControlPoints(n[1],n[2],n[3]).c1;return new I(n[1],e,o,n[2],i.start,i.end)}static calculateControlPoints(n,i,e){const o=n.x-i.x,s=n.y-i.y,a=i.x-e.x,l=i.y-e.y,c_x=(n.x+i.x)/2,c_y=(n.y+i.y)/2,p_x=(i.x+e.x)/2,p_y=(i.y+e.y)/2,m=Math.sqrt(o*o+s*s),g=Math.sqrt(a*a+l*l),x=g/(m+g),j=i.x-(p_x+(c_x-p_x)*x),W=i.y-(p_y+(c_y-p_y)*x);return{c1:new U(c_x+j,c_y+W),c2:new U(p_x+j,p_y+W)}}constructor(n,i,e,o,s,a){this.startPoint=n,this.control2=i,this.control1=e,this.endPoint=o,this.startWidth=s,this.endWidth=a}length(){let e,o,i=0;for(let s=0;s<=10;s+=1){const a=s/10,l=this.point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this.point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(s>0){const p=l-e,m=c-o;i+=Math.sqrt(p*p+m*m)}e=l,o=c}return i}point(n,i,e,o,s){return i*(1-n)*(1-n)*(1-n)+3*e*(1-n)*(1-n)*n+3*o*(1-n)*n*n+s*n*n*n}}class O extends class _t{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(n,i,e){this._et.addEventListener(n,i,e)}dispatchEvent(n){return this._et.dispatchEvent(n)}removeEventListener(n,i,e){this._et.removeEventListener(n,i,e)}}{constructor(n,i={}){super(),this.canvas=n,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=e=>{1===e.buttons&&this._strokeBegin(e)},this._handleMouseMove=e=>{this._strokeMoveUpdate(e)},this._handleMouseUp=e=>{1===e.buttons&&this._strokeEnd(e)},this._handleTouchStart=e=>{e.cancelable&&e.preventDefault(),1===e.targetTouches.length&&this._strokeBegin(e.changedTouches[0])},this._handleTouchMove=e=>{e.cancelable&&e.preventDefault(),this._strokeMoveUpdate(e.targetTouches[0])},this._handleTouchEnd=e=>{e.target===this.canvas&&(e.cancelable&&e.preventDefault(),this._strokeEnd(e.changedTouches[0]))},this._handlePointerStart=e=>{e.preventDefault(),this._strokeBegin(e)},this._handlePointerMove=e=>{this._strokeMoveUpdate(e)},this._handlePointerEnd=e=>{this._drawingStroke&&(e.preventDefault(),this._strokeEnd(e))},this.velocityFilterWeight=i.velocityFilterWeight||.7,this.minWidth=i.minWidth||.5,this.maxWidth=i.maxWidth||2.5,this.throttle="throttle"in i?i.throttle:16,this.minDistance="minDistance"in i?i.minDistance:5,this.dotSize=i.dotSize||0,this.penColor=i.penColor||"black",this.backgroundColor=i.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=i.compositeOperation||"source-over",this.canvasContextOptions="canvasContextOptions"in i?i.canvasContextOptions:{},this._strokeMoveUpdate=this.throttle?function ft(r,n=250){let o,s,a,i=0,e=null;const l=()=>{i=Date.now(),e=null,o=r.apply(s,a),e||(s=null,a=[])};return function(...p){const m=Date.now(),g=n-(m-i);return s=this,a=p,g<=0||g>n?(e&&(clearTimeout(e),e=null),i=m,o=r.apply(s,a),e||(s=null,a=[])):e||(e=window.setTimeout(l,g)),o}}(O.prototype._strokeUpdate,this.throttle):O.prototype._strokeUpdate,this._ctx=n.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:n,canvas:i}=this;n.fillStyle=this.backgroundColor,n.clearRect(0,0,i.width,i.height),n.fillRect(0,0,i.width,i.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(n,i={}){return new Promise((e,o)=>{const s=new Image,a=i.ratio||window.devicePixelRatio||1,l=i.width||this.canvas.width/a,c=i.height||this.canvas.height/a,p=i.xOffset||0,m=i.yOffset||0;this._reset(this._getPointGroupOptions()),s.onload=()=>{this._ctx.drawImage(s,p,m,l,c),e()},s.onerror=g=>{o(g)},s.crossOrigin="anonymous",s.src=n,this._isEmpty=!1})}toDataURL(n="image/png",i){return"image/svg+xml"===n?("object"!=typeof i&&(i=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(i))}`):("number"!=typeof i&&(i=void 0),this.canvas.toDataURL(n,i))}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const n=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!n?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(n,{clear:i=!0}={}){i&&this.clear(),this._fromData(n,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(n)}toData(){return this._data}_getPointGroupOptions(n){return{penColor:n&&"penColor"in n?n.penColor:this.penColor,dotSize:n&&"dotSize"in n?n.dotSize:this.dotSize,minWidth:n&&"minWidth"in n?n.minWidth:this.minWidth,maxWidth:n&&"maxWidth"in n?n.maxWidth:this.maxWidth,velocityFilterWeight:n&&"velocityFilterWeight"in n?n.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:n&&"compositeOperation"in n?n.compositeOperation:this.compositeOperation}}_strokeBegin(n){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:n,cancelable:!0})))return;this._drawingStroke=!0;const e=this._getPointGroupOptions(),o=Object.assign(Object.assign({},e),{points:[]});this._data.push(o),this._reset(e),this._strokeUpdate(n)}_strokeUpdate(n){if(!this._drawingStroke)return;if(0===this._data.length)return void this._strokeBegin(n);this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:n}));const s=this._createPoint(n.clientX,n.clientY,void 0!==n.pressure?n.pressure:void 0!==n.force?n.force:0),a=this._data[this._data.length-1],l=a.points,c=l.length>0&&l[l.length-1],p=!!c&&s.distanceTo(c)<=this.minDistance,m=this._getPointGroupOptions(a);if(!c||!c||!p){const g=this._addPoint(s,m);c?g&&this._drawCurve(g,m):this._drawDot(s,m),l.push({time:s.time,x:s.x,y:s.y,pressure:s.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:n}))}_strokeEnd(n){!this._drawingStroke||(this._strokeUpdate(n),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:n})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(n){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(n.minWidth+n.maxWidth)/2,this._ctx.fillStyle=n.penColor,this._ctx.globalCompositeOperation=n.compositeOperation}_createPoint(n,i,e){const o=this.canvas.getBoundingClientRect();return new U(n-o.left,i-o.top,e,(new Date).getTime())}_addPoint(n,i){const{_lastPoints:e}=this;if(e.push(n),e.length>2){3===e.length&&e.unshift(e[0]);const o=this._calculateCurveWidths(e[1],e[2],i),s=I.fromPoints(e,o);return e.shift(),s}return null}_calculateCurveWidths(n,i,e){const o=e.velocityFilterWeight*i.velocityFrom(n)+(1-e.velocityFilterWeight)*this._lastVelocity,s=this._strokeWidth(o,e),a={end:s,start:this._lastWidth};return this._lastVelocity=o,this._lastWidth=s,a}_strokeWidth(n,i){return Math.max(i.maxWidth/(n+1),i.minWidth)}_drawCurveSegment(n,i,e){const o=this._ctx;o.moveTo(n,i),o.arc(n,i,e,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(n,i){const e=this._ctx,o=n.endWidth-n.startWidth,s=2*Math.ceil(n.length());e.beginPath(),e.fillStyle=i.penColor;for(let a=0;a<s;a+=1){const l=a/s,c=l*l,p=c*l,m=1-l,g=m*m,y=g*m;let A=y*n.startPoint.x;A+=3*g*l*n.control1.x,A+=3*m*c*n.control2.x,A+=p*n.endPoint.x;let x=y*n.startPoint.y;x+=3*g*l*n.control1.y,x+=3*m*c*n.control2.y,x+=p*n.endPoint.y;const T=Math.min(n.startWidth+p*o,i.maxWidth);this._drawCurveSegment(A,x,T)}e.closePath(),e.fill()}_drawDot(n,i){const e=this._ctx,o=i.dotSize>0?i.dotSize:(i.minWidth+i.maxWidth)/2;e.beginPath(),this._drawCurveSegment(n.x,n.y,o),e.closePath(),e.fillStyle=i.penColor,e.fill()}_fromData(n,i,e){for(const o of n){const{points:s}=o,a=this._getPointGroupOptions(o);if(s.length>1)for(let l=0;l<s.length;l+=1){const c=s[l],p=new U(c.x,c.y,c.pressure,c.time);0===l&&this._reset(a);const m=this._addPoint(p,a);m&&i(m,a)}else this._reset(a),e(s[0],a)}}toSVG({includeBackgroundColor:n=!1}={}){const i=this._data,e=Math.max(window.devicePixelRatio||1,1),a=this.canvas.width/e,l=this.canvas.height/e,c=document.createElementNS("http://www.w3.org/2000/svg","svg");if(c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),c.setAttribute("viewBox",`0 0 ${a} ${l}`),c.setAttribute("width",a.toString()),c.setAttribute("height",l.toString()),n&&this.backgroundColor){const p=document.createElement("rect");p.setAttribute("width","100%"),p.setAttribute("height","100%"),p.setAttribute("fill",this.backgroundColor),c.appendChild(p)}return this._fromData(i,(p,{penColor:m})=>{const g=document.createElement("path");if(!(isNaN(p.control1.x)||isNaN(p.control1.y)||isNaN(p.control2.x)||isNaN(p.control2.y))){const y=`M ${p.startPoint.x.toFixed(3)},${p.startPoint.y.toFixed(3)} C ${p.control1.x.toFixed(3)},${p.control1.y.toFixed(3)} ${p.control2.x.toFixed(3)},${p.control2.y.toFixed(3)} ${p.endPoint.x.toFixed(3)},${p.endPoint.y.toFixed(3)}`;g.setAttribute("d",y),g.setAttribute("stroke-width",(2.25*p.endWidth).toFixed(3)),g.setAttribute("stroke",m),g.setAttribute("fill","none"),g.setAttribute("stroke-linecap","round"),c.appendChild(g)}},(p,{penColor:m,dotSize:g,minWidth:y,maxWidth:A})=>{const x=document.createElement("circle");x.setAttribute("r",(g>0?g:(y+A)/2).toString()),x.setAttribute("cx",p.x.toString()),x.setAttribute("cy",p.y.toString()),x.setAttribute("fill",m),c.appendChild(x)}),c.outerHTML}}let Y=(()=>{class r{constructor(i){this.elementRef=i,this.options=this.options||{},this.onBeginEvent=new t.vpe,this.onEndEvent=new t.vpe}ngAfterContentInit(){const i=this.elementRef.nativeElement.querySelector("canvas");this.options.canvasHeight&&(i.height=this.options.canvasHeight),this.options.canvasWidth&&(i.width=this.options.canvasWidth),this.signaturePad=new O(i,this.options),this.signaturePad.onBegin=this.onBegin.bind(this),this.signaturePad.onEnd=this.onEnd.bind(this)}ngOnDestroy(){const i=this.elementRef.nativeElement.querySelector("canvas");i.width=0,i.height=0}resizeCanvas(){const i=Math.max(window.devicePixelRatio||1,1),e=this.signaturePad.canvas;e.width=e.offsetWidth*i,e.height=e.offsetHeight*i,e.getContext("2d").scale(i,i),this.signaturePad.clear()}toData(){return this.signaturePad?this.signaturePad.toData():[]}fromData(i){this.signaturePad.fromData(i)}toDataURL(i,e){return this.signaturePad.toDataURL(i,e)}fromDataURL(i,e={}){!e.hasOwnProperty("height")&&this.options.canvasHeight&&(e.height=this.options.canvasHeight),!e.hasOwnProperty("width")&&this.options.canvasWidth&&(e.width=this.options.canvasWidth),this.signaturePad.fromDataURL(i,e)}clear(){this.signaturePad.clear()}isEmpty(){return this.signaturePad.isEmpty()}off(){this.signaturePad.off()}on(){this.signaturePad.on()}set(i,e){switch(i){case"canvasHeight":this.signaturePad.canvas.height=e;break;case"canvasWidth":this.signaturePad.canvas.width=e;break;default:this.signaturePad[i]=e}}onBegin(){this.onBeginEvent.emit(!0)}onEnd(){this.onEndEvent.emit(!0)}queryPad(){return this.signaturePad}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(t.SBq))},r.\u0275cmp=t.Xpm({type:r,selectors:[["signature-pad"]],inputs:{options:"options"},outputs:{onBeginEvent:"onBeginEvent",onEndEvent:"onEndEvent"},decls:1,vars:0,template:function(i,e){1&i&&t._UZ(0,"canvas")},encapsulation:2}),r})(),xt=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[]]}),r})();var v=u(5938);let vt=(()=>{class r{constructor(i,e,o,s){this.dialogRef=i,this.data=e,this.request=o,this.snack=s,this.signaturePadOptions={minWidth:5,canvasWidth:866,canvasHeight:283}}ngOnInit(){}onWindowResize(){let i=document.querySelector(".esign-container");var e=getComputedStyle(i),o=parseInt(e.paddingTop)+parseInt(e.paddingBottom),s=parseInt(e.paddingLeft)+parseInt(e.paddingRight);let a=i.clientHeight-o;this.signaturePad.set("canvasWidth",i.clientWidth-s),this.signaturePad.set("canvasHeight",a)}ngAfterViewInit(){let i=document.querySelector(".esign-container");var e=getComputedStyle(i),o=parseInt(e.paddingTop)+parseInt(e.paddingBottom),s=parseInt(e.paddingLeft)+parseInt(e.paddingRight);let a=i.clientHeight-o;this.signaturePad.set("canvasWidth",i.clientWidth-s),this.signaturePad.set("canvasHeight",a),this.signaturePad.clear()}drawComplete(i){console.log(this.signaturePad.toDataURL())}drawStart(){console.log("begin drawing")}clearSignature(){this.signaturePad.clear()}savePad(){const i=this.signaturePad.toDataURL();if(this.signatureImg=i,this.signaturePad.isEmpty())this.esignRequiredError=!0;else{this.esignRequiredError=!1;let e={data:this.signaturePad.toDataURL()};this.request.POST(h.uv,e).subscribe({next:o=>{o&&(this.snack.notify("Purchase order has been created with Esign.",1),this.dialogRef.close({option:1,data:o.data.s3FileUrl}))},error:o=>{if(o.errors&&!(0,P.isEmpty)(o.errors)){let s="<ul>";for(let a in o.errors)s+=`<li>${o.errors[a][0]}</li>`;s+="</ul>",this.snack.notifyHtml(s,2)}else this.snack.notify(o.message,2)}})}}cancel(){this.dialogRef.close({option:2,data:[]})}convertBase64(i){return i.replace("data:image/jpeg;base64,","").replace("data:image/jpg;base64,","").replace("data:image/png;base64,","").replace("data:image/gif;base64,","").replace("data:application/pdf;base64,","").replace("data:image/tiff;base64,","")}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(v.so),t.Y36(v.WI),t.Y36(w.s),t.Y36(D.o))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-e-sign"]],viewQuery:function(i,e){if(1&i&&t.Gf(Y,5),2&i){let o;t.iGM(o=t.CRH())&&(e.signaturePad=o.first)}},hostBindings:function(i,e){1&i&&t.NdJ("resize",function(s){return e.onWindowResize(s)},!1,t.Jf7)},decls:15,vars:1,consts:[["mat-dialog-title","",1,"mat-dialog-title"],[1,"row","full-width"],[1,"col-md-9"],[1,"col-md-3"],[1,"float-end","close-icon",3,"click"],["mat-dialog-content","",1,"mat-dialog-content-cstm"],[1,"esign-container"],[3,"options","onBeginEvent","onEndEvent"],[2,"text-align","center","margin-bottom","15px"],["type","button","aria-label","Send To Customer",1,"button-outline","button-spacer","cancel-btn",3,"click"],["type","button","id","continueButtonId","aria-label","Continue",1,"button-primary","button-spacer","theme-btn",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," E-Signature "),t.qZA(),t.TgZ(4,"div",3)(5,"mat-icon",4),t.NdJ("click",function(){return e.cancel()}),t._uU(6,"close"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"signature-pad",7),t.NdJ("onBeginEvent",function(){return e.drawStart()})("onEndEvent",function(s){return e.drawComplete(s)}),t.qZA()()(),t.TgZ(10,"div",8)(11,"button",9),t.NdJ("click",function(){return e.clearSignature()}),t._uU(12,"Clear"),t.qZA(),t.TgZ(13,"button",10),t.NdJ("click",function(){return e.savePad()}),t._uU(14,"Continue"),t.qZA()()),2&i&&(t.xp6(9),t.Q6J("options",e.signaturePadOptions))},dependencies:[v.uh,v.xY,C.Hw,Y],styles:[".mat-dialog-title[_ngcontent-%COMP%]{padding:0 0 10px;display:flex;justify-content:space-between;align-items:center;font-style:normal;font-weight:400;font-size:14px;line-height:16px;text-transform:capitalize;color:#28313b;border-bottom:1px solid #ccc}.cancel-btn[_ngcontent-%COMP%]{background:#f3f3f3;color:#333}.space-btn[_ngcontent-%COMP%]{margin:0 5px}.mat-dialog-content[_ngcontent-%COMP%]{margin:0;padding:0 15px}.btn[_ngcontent-%COMP%]{min-width:100px;margin:0 5px}.full-width[_ngcontent-%COMP%]{width:100%}.close-icon[_ngcontent-%COMP%]{background-repeat:no-repeat;display:inline-block;fill:currentColor;cursor:pointer}.theme-btn[_ngcontent-%COMP%]{padding:7px 50px;background-color:#233a61;color:#fff;border-radius:5px;border:0;font-size:14px}.cancel-btn[_ngcontent-%COMP%]{padding:7px 50px;background-color:#fff;color:#333;border-radius:5px;border:1px solid #ccc;font-size:14px;margin:0 10px}"]}),r})();var bt=u(4859);function Zt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"mat-option",28),t.NdJ("click",function(){const s=t.CHM(i).$implicit,a=t.oxw();return t.KtG(a.companySelection(s))}),t._uU(1),t.qZA()}if(2&r){const i=n.$implicit;t.Q6J("value",i._id),t.xp6(1),t.hij(" ",i.companyName," ")}}function yt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function At(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Pt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Ct(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Tt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function wt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Dt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function qt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Ut(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Ot(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function kt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}function Mt(r,n){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," this field is required. "),t.qZA())}let Nt=(()=>{class r{constructor(i,e,o,s,a,l){this.dialogRef=i,this.data=e,this.router=o,this.route=s,this.httpService=a,this.snack=l,this.addForm=new d.cw({address:new d.cw({company_name:new d.NI("",d.kI.required),gst_number:new d.NI({value:"",disabled:!0}),pan_card:new d.NI({value:"",disabled:!0}),code:new d.NI({value:"",disabled:!0}),street_address:new d.NI({value:"",disabled:!0},d.kI.required),street_address2:new d.NI({value:"",disabled:!0},d.kI.required),state:new d.NI({value:"",disabled:!0},d.kI.required),city:new d.NI({value:"",disabled:!0},d.kI.required),zip_code:new d.NI({value:"",disabled:!0},d.kI.required),country:new d.NI({value:"",disabled:!0},d.kI.required),contactPerson:new d.NI({value:"",disabled:!0},d.kI.required),phoneNumber:new d.NI({value:"",disabled:!0},d.kI.required)})}),this.getList()}ngOnInit(){}addAddress(){this.addForm.valid&&this.dialogRef.close({data:this.sendData,type:1})}closeDialog(){this.dialogRef.close({type:0,data:""})}getList(){this.httpService.GET(h.Cf,{}).subscribe(i=>{i&&i.data&&(this.orgList=i.data,console.log(this.orgList))},i=>{if(i.errors&&!(0,P.isEmpty)(i.errors)){let e="<ul>";for(let o in i.errors)e+=`<li>${i.errors[o][0]}</li>`;e+="</ul>",this.snack.notifyHtml(e,2)}else this.snack.notify(i.message,2)})}companySelection(i){this.sendData=i,this.patchData(i)}patchData(i){this.addForm.patchValue({address:{gst_number:i.gst_number,pan_card:i.pan_number,street_address:i.address.street_address,street_address2:i.address.street_address2,state:i.address.state,city:i.address.city,zip_code:i.address.zip_code,country:i.address.country,contactPerson:i.contact_person,code:i.code,phoneNumber:i.phone_number}}),console.log(this.addForm)}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(v.so),t.Y36(v.WI),t.Y36(f.F0),t.Y36(f.gz),t.Y36(w.s),t.Y36(D.o))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-billing-address-popup"]],decls:114,vars:14,consts:[["fxLayout","row","fxLayoutAlign","space-between center",2,"background-color","#233A61","color","white","height","50px","margin-bottom","20px"],[2,"margin-left","20px","margin-top","10px"],[2,"margin-right","10px","cursor","pointer",3,"click"],[1,"material-icons"],[1,"form-section",3,"formGroup"],["formGroupName","address",1,"row"],[1,"col-md-4"],[1,"custom-form-group"],[1,"custom-form-control",2,"position","relative"],["appearance","outline"],["id","site","placeholder","Select Name","formControlName","company_name"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","code"],["matInput","","formControlName","gst_number"],["type","tel","matInput","","formControlName","pan_card"],["matInput","","formControlName","street_address"],["matInput","","formControlName","street_address2"],["matInput","","formControlName","state"],["matInput","","formControlName","city"],["matInput","","formControlName","zip_code","type","number","maxlength","6"],["matInput","","formControlName","country"],["matInput","","formControlName","contactPerson"],["matInput","","formControlName","phoneNumber"],[1,"row"],[1,"col-md-2"],["mat-button","",2,"background-color","#233A61","color","#fff","padding","1px 40px","font-family","Poppins",3,"click"],["mat-button","",2,"background-color","#fff","color","#233A61","padding","1px 40px","font-family","Poppins","border","1px solid #233A61",3,"click"],[3,"value","click"]],template:function(i,e){1&i&&(t.TgZ(0,"div")(1,"div",0)(2,"div")(3,"h2",1),t._uU(4,"Billing Details"),t.qZA()(),t.TgZ(5,"div",2),t.NdJ("click",function(){return e.closeDialog()}),t.TgZ(6,"span",3),t._uU(7,"close"),t.qZA()()(),t.TgZ(8,"form",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"mat-form-field",9)(14,"mat-label"),t._uU(15,"Company Name"),t.qZA(),t.TgZ(16,"mat-select",10),t.YNc(17,Zt,2,2,"mat-option",11),t.qZA(),t.YNc(18,yt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(19,"div",6)(20,"div",7)(21,"div",8)(22,"mat-form-field",9)(23,"mat-label"),t._uU(24,"Organisation Code"),t.qZA(),t._UZ(25,"input",13),t.YNc(26,At,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(27,"div",6)(28,"div",7)(29,"div",8)(30,"mat-form-field",9)(31,"mat-label"),t._uU(32,"GST"),t.qZA(),t._UZ(33,"input",14),t.YNc(34,Pt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(35,"div",6)(36,"div",7)(37,"div",8)(38,"mat-form-field",9)(39,"mat-label"),t._uU(40,"PAN Number"),t.qZA(),t._UZ(41,"input",15),t.YNc(42,Ct,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(43,"div",6)(44,"div",7)(45,"div",8)(46,"mat-form-field",9)(47,"mat-label"),t._uU(48,"Street Address"),t.qZA(),t._UZ(49,"input",16),t.YNc(50,Tt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(51,"div",6)(52,"div",7)(53,"div",8)(54,"mat-form-field",9)(55,"mat-label"),t._uU(56,"Street Address 2"),t.qZA(),t._UZ(57,"input",17),t.YNc(58,wt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(59,"div",6)(60,"div",7)(61,"div",8)(62,"mat-form-field",9)(63,"mat-label"),t._uU(64,"State"),t.qZA(),t._UZ(65,"input",18),t.YNc(66,Dt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(67,"div",6)(68,"div",7)(69,"div",8)(70,"mat-form-field",9)(71,"mat-label"),t._uU(72,"City"),t.qZA(),t._UZ(73,"input",19),t.YNc(74,qt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(75,"div",6)(76,"div",7)(77,"div",8)(78,"mat-form-field",9)(79,"mat-label"),t._uU(80,"Zip Code"),t.qZA(),t._UZ(81,"input",20),t.YNc(82,Ut,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(83,"div",6)(84,"div",7)(85,"div",8)(86,"mat-form-field",9)(87,"mat-label"),t._uU(88,"Country"),t.qZA(),t._UZ(89,"input",21),t.YNc(90,Ot,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(91,"div",6)(92,"div",7)(93,"div",8)(94,"mat-form-field",9)(95,"mat-label"),t._uU(96,"Contact Person"),t.qZA(),t._UZ(97,"input",22),t.YNc(98,kt,2,0,"mat-error",12),t.qZA()()()(),t.TgZ(99,"div",6)(100,"div",7)(101,"div",8)(102,"mat-form-field",9)(103,"mat-label"),t._uU(104,"Phone Number"),t.qZA(),t._UZ(105,"input",23),t.YNc(106,Mt,2,0,"mat-error",12),t.qZA()()()()(),t.TgZ(107,"div",24)(108,"div",25)(109,"button",26),t.NdJ("click",function(){return e.addAddress()}),t._uU(110,"Update"),t.qZA()(),t.TgZ(111,"div",25)(112,"button",27),t.NdJ("click",function(){return e.closeDialog()}),t._uU(113,"Close"),t.qZA()()()()()),2&i&&(t.xp6(8),t.Q6J("formGroup",e.addForm),t.xp6(9),t.Q6J("ngForOf",e.orgList),t.xp6(1),t.Q6J("ngIf",null==e.addForm.get("address.company_name").errors?null:e.addForm.get("address.company_name").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.code").errors?null:e.addForm.get("address.code").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.gst_number").errors?null:e.addForm.get("address.gst_number").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.pan_card").errors?null:e.addForm.get("address.pan_card").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.street_address").errors?null:e.addForm.get("address.street_address").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.street_address2").errors?null:e.addForm.get("address.street_address2").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.state").errors?null:e.addForm.get("address.state").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.city").errors?null:e.addForm.get("address.city").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.zip_code").errors?null:e.addForm.get("address.zip_code").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.country").errors?null:e.addForm.get("address.country").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.contactPerson").errors?null:e.addForm.get("address.contactPerson").errors.required),t.xp6(8),t.Q6J("ngIf",null==e.addForm.get("address.phoneNumber").errors?null:e.addForm.get("address.phoneNumber").errors.required))},dependencies:[_.sg,_.O5,F.ey,b.TO,b.KE,b.hX,bt.lW,q.Nt,J.gD,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.nD,d.sg,d.u,d.x0],styles:["form[_ngcontent-%COMP%]{height:400px}.my-selects[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:80px}ng-select[_ngcontent-%COMP%]{width:200px}.Actual-align[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around}.mat-form-field[_ngcontent-%COMP%]{display:block}a[_ngcontent-%COMP%]{cursor:pointer;padding:5px;float:right}a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}a[_ngcontent-%COMP%]:hover{opacity:.7}"]}),r})(),Lt=(()=>{class r{constructor(){this.addForm=new d.cw({address:new d.cw({street_address:new d.NI("",d.kI.required),street_address2:new d.NI("",d.kI.required),state:new d.NI("",d.kI.required),city:new d.NI("",d.kI.required),zip_code:new d.NI("",d.kI.required),country:new d.NI("",d.kI.required)})})}ngOnInit(){}}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-mailing-address-popup"]],decls:0,vars:0,template:function(i,e){}}),r})();var It=u(3900),Et=u(4128),St=u(9646);function Ft(r,n){if(1&r&&(t.ynx(0),t._uU(1),t.BQk()),2&r){const i=t.oxw().$implicit;t.xp6(1),t.hij(" (",i.item.tax.amount,"%) ")}}function Jt(r,n){if(1&r&&(t.TgZ(0,"tr",52)(1,"td",53),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",54),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td",54),t._uU(12),t.qZA(),t.TgZ(13,"td",54),t._uU(14),t.qZA(),t.TgZ(15,"td",54),t.YNc(16,Ft,2,1,"ng-container",55),t.qZA(),t.TgZ(17,"td",54),t._uU(18),t.qZA()()),2&r){const i=n.$implicit,e=n.index,o=t.oxw(3);t.xp6(2),t.hij(" ",e+1," "),t.xp6(2),t.hij(" ",i.item.item_name," "),t.xp6(2),t.hij(" ",i.item.qty," "),t.xp6(2),t.hij(" ",i.item.uomDetail.uom_name," "),t.xp6(2),t.Oqu(o.getBrandNamesByIds(i.item.brandName)),t.xp6(2),t.hij(" ",i.Rate," "),t.xp6(2),t.hij(" ",i.SubTotalAmount," "),t.xp6(2),t.Q6J("ngIf",i.item.tax&&i.item.tax.amount),t.xp6(2),t.hij(" ",i.Total," ")}}function Bt(r,n){if(1&r){const i=t.EpF();t.ynx(0),t.TgZ(1,"button",56),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.createOrder())}),t._uU(2," Approve "),t.qZA(),t.BQk()}}function zt(r,n){1&r&&(t.TgZ(0,"button",57),t._uU(1," No Permission to Approve "),t.qZA())}function Rt(r,n){if(1&r){const i=t.EpF();t.ynx(0),t.TgZ(1,"button",58),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updateStatus("revise"))}),t._uU(2," Revise "),t.qZA(),t.BQk()}}function Yt(r,n){1&r&&(t.TgZ(0,"button",59),t._uU(1," No Permission To Revise "),t.qZA())}function Qt(r,n){if(1&r){const i=t.EpF();t.ynx(0),t.TgZ(1,"button",58),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updateStatus("rejected"))}),t._uU(2," Reject "),t.qZA(),t.BQk()}}function jt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updateStatus("rejected"))}),t._uU(1," No Permission to Reject "),t.qZA()}}function Wt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"span",23),t._uU(5,"Billing Address"),t.qZA(),t.TgZ(6,"mat-icon",24),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.billingAddressPopup())}),t._uU(7,"border_color"),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"div",25)(10,"span")(11,"b"),t._uU(12,"Company Name: "),t.qZA(),t._uU(13),t.qZA(),t.TgZ(14,"span")(15,"b"),t._uU(16,"Address: "),t.qZA(),t._uU(17),t._UZ(18,"br"),t._uU(19),t.qZA(),t.TgZ(20,"span")(21,"b"),t._uU(22,"GSTIN: "),t.qZA(),t._uU(23),t.qZA(),t.TgZ(24,"span")(25,"b"),t._uU(26,"PAN: "),t.qZA(),t._uU(27),t.qZA(),t.TgZ(28,"span")(29,"b"),t._uU(30,"Contact Person: "),t.qZA(),t._uU(31),t.qZA()()(),t.TgZ(32,"div",26)(33,"span",23),t._uU(34,"Delivery Address"),t.qZA(),t._UZ(35,"br"),t.TgZ(36,"div",27)(37,"span")(38,"b"),t._uU(39,"Date"),t.qZA(),t._uU(40),t.ALo(41,"date"),t.qZA(),t.TgZ(42,"span")(43,"b"),t._uU(44,"Validity"),t.qZA(),t._uU(45,": "),t.TgZ(46,"mat-form-field")(47,"input",28),t.NdJ("focus",function(){t.CHM(i);const o=t.MAs(50);return t.KtG(o.open())}),t.qZA(),t._UZ(48,"mat-datepicker-toggle",29)(49,"mat-datepicker",null,30),t.qZA()(),t.TgZ(51,"span")(52,"b"),t._uU(53,"PO NO"),t.qZA(),t._uU(54),t._UZ(55,"input",31),t.qZA(),t.TgZ(56,"span")(57,"b"),t._uU(58,"Site Address"),t.qZA()(),t.TgZ(59,"span"),t._uU(60),t.qZA(),t.TgZ(61,"span")(62,"b"),t._uU(63,"Contact Person"),t.qZA(),t._uU(64),t._UZ(65,"input",32),t.qZA()()()(),t.TgZ(66,"div",33)(67,"span",23),t._uU(68,"To,"),t.qZA(),t._UZ(69,"br"),t.TgZ(70,"div",34)(71,"div",35)(72,"span",36)(73,"b"),t._uU(74,"Vendor Name: "),t.qZA(),t._uU(75),t._UZ(76,"br"),t.TgZ(77,"span")(78,"b"),t._uU(79,"Vendor Address: "),t.qZA(),t._uU(80),t.qZA()(),t.TgZ(81,"span")(82,"b",37),t._uU(83,"GSTIN: "),t.qZA(),t._uU(84),t.qZA()(),t.TgZ(85,"div",38)(86,"p"),t._uU(87),t.qZA(),t.TgZ(88,"textarea",39),t._uU(89,"            "),t.qZA()()()()(),t.TgZ(90,"div",40)(91,"table",41)(92,"tr")(93,"th"),t._uU(94,"Item\xa0No"),t.qZA(),t.TgZ(95,"th"),t._uU(96,"Item\xa0Name"),t.qZA(),t.TgZ(97,"th"),t._uU(98,"Quantity"),t.qZA(),t.TgZ(99,"th"),t._uU(100,"UOM"),t.qZA(),t.TgZ(101,"th"),t._uU(102,"Brand Name"),t.qZA(),t.TgZ(103,"th"),t._uU(104,"Rate"),t.qZA(),t.TgZ(105,"th"),t._uU(106,"Sub Total"),t.qZA(),t.TgZ(107,"th"),t._uU(108,"Tax"),t.qZA(),t.TgZ(109,"th"),t._uU(110,"Total"),t.qZA()(),t.TgZ(111,"tbody"),t.YNc(112,Jt,19,9,"tr",42),t.qZA(),t.TgZ(113,"tr")(114,"td",43),t._uU(115,"Total\xa0amount"),t.qZA(),t.TgZ(116,"td",43),t._uU(117),t.ALo(118,"currency"),t.qZA()(),t.TgZ(119,"tr")(120,"td",43),t._uU(121,"Total\xa0Freight"),t.qZA(),t.TgZ(122,"td",43),t._uU(123),t.ALo(124,"currency"),t.qZA()(),t.TgZ(125,"tr")(126,"td",43),t._uU(127,"GST\xa0amount"),t.qZA(),t.TgZ(128,"td",43),t._uU(129),t.ALo(130,"currency"),t.qZA()(),t.TgZ(131,"tr")(132,"td",43),t._uU(133,"Grand\xa0total"),t.qZA(),t.TgZ(134,"td",44),t._uU(135),t.ALo(136,"currency"),t.qZA()()()(),t.TgZ(137,"div",45)(138,"div"),t._uU(139,"Vendor terms & other conditions "),t.TgZ(140,"mat-icon",46),t._uU(141,"border_color"),t.qZA()(),t.TgZ(142,"textarea",47),t._uU(143,"              "),t.qZA()(),t.TgZ(144,"div",48)(145,"div"),t.YNc(146,Bt,3,0,"ng-container",16),t.YNc(147,zt,2,0,"ng-template",null,49,t.W1O),t.qZA(),t.TgZ(149,"div"),t.YNc(150,Rt,3,0,"ng-container",16),t.YNc(151,Yt,2,0,"ng-template",null,50,t.W1O),t.qZA(),t.TgZ(153,"div"),t.YNc(154,Qt,3,0,"ng-container",16),t.YNc(155,jt,2,0,"ng-template",null,51,t.W1O),t.qZA()()()}if(2&r){const i=t.MAs(50),e=t.MAs(148),o=t.MAs(152),s=t.MAs(156),a=t.oxw(2);t.xp6(13),t.Oqu(null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.company_name),t.xp6(4),t.AsE(" ",null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.street_address," ",null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.street_address2," "),t.xp6(2),t.lnq("",null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.city," ",null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.state," ",null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.zip_code," "),t.xp6(4),t.Oqu(null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.gst_number),t.xp6(4),t.Oqu(null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.pan_card),t.xp6(4),t.Oqu(null==a.poDetails||null==a.poDetails.billing_address?null:a.poDetails.billing_address.contact_person),t.xp6(9),t.hij(": ",t.xi3(41,44,a.poDetails.date,"dd-MM-yyyy"),""),t.xp6(7),t.Q6J("formControl",a.validityDate)("min",a.minDate)("max",a.maxDate)("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(6),t.hij(": ",null==a.poDetails?null:a.poDetails.po_number,""),t.xp6(6),t.xDo("",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.street_address," ,",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.street_address2,", ",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.city,",",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.state," ,",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.zip_code," "),t.xp6(4),t.hij(": ",null==a.poDetails||null==a.poDetails.delivery_address?null:a.poDetails.delivery_address.contact_person,""),t.xp6(11),t.hij("",a.poDetails.vendor_detail.vendor_name," "),t.xp6(5),t.gL8(" ",a.poDetails.vendor_detail.address.street_address," ",a.poDetails.vendor_detail.address.street_address2," ",a.poDetails.vendor_detail.address.city," ",a.poDetails.vendor_detail.address.state," ",a.poDetails.vendor_detail.address.country," ",a.poDetails.vendor_detail.address.zip_code," "),t.xp6(4),t.Oqu(a.poDetails.vendor_detail.gst_number),t.xp6(3),t.Oqu(a.poDetails.vendor_message_header),t.xp6(1),t.Q6J("formControl",a.mail_section),t.xp6(24),t.Q6J("ngForOf",a.poDetails.items),t.xp6(5),t.Oqu(t.xi3(118,47,a.poDetails.vendors_total[0].subTotal,"INR")),t.xp6(6),t.Oqu(t.xi3(124,50,a.poDetails.vendors_total[0].freightTotal,"INR")),t.xp6(6),t.Oqu(t.xi3(130,53,a.poDetails.vendors_total[0].gstAmount,"INR")),t.xp6(6),t.hij(" ",t.xi3(136,56,a.poDetails.vendors_total[0].total,"INR"),""),t.xp6(7),t.Q6J("formControl",a.term_condition),t.xp6(4),t.Q6J("ngIf",a.addPermission||a.editPermission)("ngIfElse",e),t.xp6(4),t.Q6J("ngIf",a.editPermission)("ngIfElse",o),t.xp6(4),t.Q6J("ngIf",a.deletePermission)("ngIfElse",s)}}function $t(r,n){if(1&r&&(t.ynx(0),t.YNc(1,Wt,157,59,"div",18),t.BQk()),2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.poDetails)}}function Gt(r,n){1&r&&(t.TgZ(0,"h3",61),t._uU(1,"You don't have permissions to view."),t.qZA())}const Ht=function(){return["/procurement"]},Kt=function(){return["/procurement/prlist"]},Vt=function(){return["/rate-comparative"]},Xt=function(){return["/rate-approval"]},te=function(){return["/purchase-order"]};let ee=(()=>{class r{constructor(i,e,o,s,a,l,c){this.dialog=i,this.router=e,this.route=o,this.httpService=s,this.snack=a,this.formBuilder=l,this.http=c,this.term_condition=new d.NI,this.mail_section=new d.NI,this.validityDate=new d.NI("",[d.kI.required]),this.minDate=new Date,this.maxDate=new Date((new Date).setMonth((new Date).getMonth()+12)),this.purchaseOrderList=[]}updateItemsWithDetails(i){this.poDetails.items.map(s=>s.item.item_id);const o=i.reduce((s,a)=>(s[a._id]=a,s),{});this.poDetails.items=this.poDetails.items.map(s=>{const l=o[s.item.item_id]||{};return{...s,item:{...s.item,categoryDetail:l.categoryDetail||{},subCategoryDetail:l.subCategoryDetail||{},uomDetail:l.uomDetail||{},item_name:l.item_name||s.item.item_name,brandName:l.brandName||s.item.brandName,attachment:l.attachment||s.item.attachment}}}),console.log("checkDats",this.poDetails)}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:o=>{this.viewPermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[0].isSelected,this.addPermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[1].isSelected,this.editPermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[2].isSelected,this.deletePermission=o.dashboard_permissions[0].ParentChildchecklist[22].childList[3].isSelected},error:o=>{console.log(o)}}),Promise.all([this.getBrandList(),this.getItemList()]).then(([o,s])=>{this.brandList=o,this.ItemList=s,this.route.params.subscribe(a=>{a.id&&this.httpService.GET(`${h.TK}/detail`,{_id:a.id}).subscribe(l=>{this.poDetails=l.data,this.mail_section.patchValue(this.poDetails.vendor_message),this.term_condition.patchValue(this.poDetails.terms_condition),this.updateItemsWithDetails(this.ItemList)})})}).catch(o=>{console.error("Error fetching data",o)})}updateStatus(i){var e=this;return(0,R.Z)(function*(){if("revise"==i){try{const a={...(yield e.httpService.GET(`${h.bG}`,{_id:e.poDetails.rate_approval_id}).toPromise()).data.details,status:"revise"};yield e.httpService.PUT(`${h.lu}`,a).toPromise(),yield e.httpService.DELETE(`${h.TK}`,{_id:e.poDetails._id}).toPromise(),e.snack.notify("Detail has been updated",1),e.router.navigate(["/purchase-order"]),e.load=!1}catch(s){if(e.load=!1,s.errors&&!(0,P.isEmpty)(s.errors)){const a="<ul>"+Object.values(s.errors).map(l=>`<li>${l[0]}</li>`).join("")+"</ul>";e.snack.notifyHtml(a,2)}else e.snack.notify(s.message,2)}return}let o={};o.status=i,o._id=e.poDetails._id,e.load=!0,e.httpService.PUT(h.TK,o).subscribe({next:s=>{e.load=!1,e.snack.notify("Record has been updated.",1),e.router.navigate(["/purchase-order"])},error:s=>{if(e.load=!1,s.errors&&!(0,P.isEmpty)(s.errors)){let a="<ul>";for(let l in s.errors)a+=`<li>${s.errors[l][0]}</li>`;a+="</ul>",e.snack.notifyHtml(a,2)}else e.snack.notify(s.message,2)}})})()}openEsignModal(){this.validityDate.valid?this.dialog.open(vt,{maxWidth:"80vw",maxHeight:"80vh",autoFocus:!1}).afterClosed().subscribe(e=>{e&&1==e.option&&(this.poDetails.sign=e.data,this.createOrder())}):this.snack.notify("Please provide validity date",2)}createOrder(){if(!this.validityDate.valid)return this.validityDate.markAsTouched(),!1;let i=this.poDetails;for(let s=0;s<i.items.length;s++){const a=this.getBrandNamesByIds(i.items[s].item.brandName);i.items[s].item.brandName=a}console.log("---------------"),console.log("this.purchaseOrderNumber",this.purchaseOrderNumber),console.log("---------------");const e=this.poDetails.billing_address.company_name.toLowerCase().trim(),o=this.purchaseOrderList.filter(s=>(s.billing_address.company_name?s.billing_address.company_name.toLowerCase().trim():"").includes(e));this.purchaseOrderNumber=o.length+1,console.log("-------------"),console.log("this.poDetails.po_number",this.poDetails.po_number),console.log("-------------"),i.po_number=this.poDetails.po_number,i.status="approved",i.due_date=this.validityDate.value,i.vendor_message=this.mail_section.value,i.vendor_detail.terms_condition=this.term_condition.value,this.load=!0,this.httpService.PUT(h.TK,i).pipe((0,It.w)(s=>{let a={0:{...this.poDetails}};"status"in a[0]&&delete a[0].status,console.log("---------------"),console.log(a),console.log("---------------");const l=this.httpService.POST(h.IS,a);return(0,Et.D)([(0,St.of)(s),l])})).subscribe({next:([s,a])=>{this.load=!1,this.snack.notify("purchase Order has been generated.",1),this.router.navigate(["/purchase-order"])},error:s=>{if(this.load=!1,s.errors&&!(0,P.isEmpty)(s.errors)){let a="<ul>";for(let l in s.errors)a+=`<li>${s.errors[l][0]}</li>`;a+="</ul>",this.snack.notifyHtml(a,2),this.router.navigate(["/purchase-order"])}else this.snack.notify(s.message,2),this.router.navigate(["/purchase-order"])}})}getBrandNamesByIds(i){const e=this.brandList.reduce((o,s)=>(o[s._id]=s.brand_name,o),{});return i.map(o=>e[o]).filter(o=>o).join(" / ")}billingAddressPopup(){this.dialog.open(Nt,{autoFocus:!1}).afterClosed().subscribe(e=>{if(console.log("-------------"),console.log("result",e),console.log("-------------"),e&&e.type&&1==e.type){this.poDetails.billing_address.company_name=e.data.companyName,this.poDetails.billing_address.code=e.data.code,this.poDetails.billing_address.street_address=e.data.address.street_address,this.poDetails.billing_address.street_address2=e.data.address.street_address2,this.poDetails.billing_address.city=e.data.address.city,this.poDetails.billing_address.state=e.data.address.state,this.poDetails.billing_address.gst_number=e.data.gst_number,this.poDetails.billing_address.pan_card=e.data.pan_number,this.poDetails.billing_address.contact_person=e.data.contact_person+"-"+e.data.phone_number;const o=this.http.get(`${M.N.api_path}${h.TK}`);this.httpService.multipleRequests([o],{}).subscribe(s=>{if(s){this.purchaseOrderList=s[0].data,console.log("----purchaseOrderListdd----",this.purchaseOrderList),console.log("----purchaseOrderListdd----"),console.log("--this.poDetails.billing_address.company_name--",this.poDetails.billing_address.company_name);const a=this.poDetails.billing_address.company_name.toLowerCase().trim(),l=this.purchaseOrderList.filter(c=>(c.billing_address.company_name?c.billing_address.company_name.toLowerCase().trim():"").includes(a));console.log("--filteredList--",l),this.purchaseOrderNumber=l.length+1,this.poDetails.po_number=`${this.poDetails.billing_address.code}/${this.poDetails.delivery_address.site_code}/${this.getCurrentFinancialYearShort()}/${this.convertToFiveDigitNumber(this.purchaseOrderNumber)}`,console.log("-------------"),console.log("this.poDetails.po_number",this.poDetails.po_number),console.log("-------------")}})}})}mailingAddressPopup(){this.dialog.open(Lt,{autoFocus:!1}).afterClosed().subscribe(e=>{})}getBrandList(){return this.httpService.GET(h.Lk,{}).toPromise().then(i=>i.data)}getItemList(){return this.httpService.GET(h.o7,{}).toPromise().then(i=>i.data)}myBrandName(i){return this.brandList.filter(o=>o._id==i)[0].brand_name}getCurrentFinancialYearShort(){const i=new Date,e=i.getFullYear();return i.getMonth()+1>=4?`${e.toString().slice(-2)} - ${(e+1).toString().slice(-2)}`:`${(e-1).toString().slice(-2)} - ${e.toString().slice(-2)}`}convertToFiveDigitNumber(i){return i.toString().padStart(4,"0")}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(v.uw),t.Y36(f.F0),t.Y36(f.gz),t.Y36(w.s),t.Y36(D.o),t.Y36(d.qu),t.Y36(S.eN))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-purchase-order-update"]],decls:46,vars:12,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","50px","margin-left","20px"],["src","./assets/images/POL.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],["src","./assets/images/rc.svg"],["src","./assets/images/podown.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],[4,"ngIf","ngIfElse"],["noView",""],["class","main-wrapper",4,"ngIf"],[1,"main-wrapper"],[2,"margin-top","20px"],[2,"display","flex","gap","50px","flex-wrap","wrap"],[1,"topleft"],[2,"font-size","14px","font-family","Poppins","color","#3568BA","margin-bottom","10px"],[2,"position","relative","right","27px","top","9px","margin-left","35px","color","#3568BA","width","20px","height","20px","font-size","14px","cursor","pointer",3,"click"],[1,"textarealeft"],[1,"topright",2,"margin-top","10px"],[1,"textarearight"],["matInput","",3,"formControl","min","max","matDatepicker","focus"],["matSuffix","",3,"for"],["picker",""],["type","text",2,"width","120px","padding","5px","border","none","margin-left","16px"],["type","text",2,"width","150px","padding","5px","border","none","margin-left","16px"],[1,"topdown"],[2,"border","1px solid #94A3B8","border-radius","5px","padding","5px 0 20px 0"],["type","text",1,"textareadown"],[2,"margin-left","20px","margin-top","10px","width","500px"],[2,"margin-left","20px"],[1,"msg-teatarea"],[1,"vendor-message-textarea",3,"formControl"],[1,"scroll-bar1"],[2,"direction","ltr !important","border","2px solid #000 !important"],["style","background-color: #F4F4F5;",4,"ngFor","ngForOf"],["colspan","5",2,"border","none","font-size","small"],["colspan","5",2,"border","none","color","#073B4C","font-weight","bold","font-size","small"],[1,"terms-condition-wrap"],[2,"font-size","medium","position","relative","top","10px"],[1,"terms-condition-textarea",3,"formControl"],[2,"display","flex","gap","20px","justify-content","end"],["noAddPermission",""],["noEditPermission",""],["noDeletePermission",""],[2,"background-color","#F4F4F5"],[2,"text-align","center"],[2,"color","#000"],[4,"ngIf"],[2,"padding","8px","width","180px","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-family","Poppins","font-size","14px",3,"click"],["disabled","",2,"padding","8px","width","180px","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-family","Poppins","font-size","14px"],[2,"padding","8px","width","120px","background-color","#fff","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-family","Poppins","font-size","14px",3,"click"],["disabled","",2,"padding","8px","width","120px","background-color","#fff","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-family","Poppins","font-size","14px"],["disabled","",2,"padding","8px","width","120px","background-color","#fff","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-family","Poppins","font-size","14px",3,"click"],[2,"display","flex","justify-content","center","margin-top","2%","font-size","160%","font-weight","bolder","color","grey"]],template:function(i,e){if(1&i&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Purchase orders"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",9),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",13),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",12),t.qZA(),t.TgZ(33,"span",9),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",10),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",14),t.qZA(),t.TgZ(40,"span",15),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"div"),t.YNc(43,$t,2,1,"ng-container",16),t.YNc(44,Gt,2,0,"ng-template",null,17,t.W1O),t.qZA()),2&i){const o=t.MAs(45);t.xp6(9),t.Q6J("routerLink",t.DdM(7,Ht)),t.xp6(7),t.Q6J("routerLink",t.DdM(8,Kt)),t.xp6(7),t.Q6J("routerLink",t.DdM(9,Vt)),t.xp6(7),t.Q6J("routerLink",t.DdM(10,Xt)),t.xp6(7),t.Q6J("routerLink",t.DdM(11,te)),t.xp6(6),t.Q6J("ngIf",e.viewPermission)("ngIfElse",o)}},dependencies:[f.rH,f.Od,_.sg,_.O5,b.KE,b.R9,Z.Mq,Z.hl,Z.nW,N.d,C.Hw,q.Nt,L.Ye,d.Fj,d.JJ,d.oH,_.H9,_.uU],styles:["mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-card[_ngcontent-%COMP%]{margin-left:30px;margin-bottom:20px;margin-top:10px;width:90%;height:240vh;box-shadow:0 2px 8px #00000040!important}.topdown[_ngcontent-%COMP%]{width:800px;min-height:400px;margin-top:50px}@media only screen and (max-width: 965px){.topdown[_ngcontent-%COMP%]{width:90%}}.msg-teatarea[_ngcontent-%COMP%]{width:700px;background-color:#233a61;margin-top:15px;margin-left:15px;border-radius:5px;color:#fff;font-family:Poppins;padding:20px}@media only screen and (max-width: 965px){.msg-teatarea[_ngcontent-%COMP%]{width:90%}}.textarealeft[_ngcontent-%COMP%], .textarearight[_ngcontent-%COMP%]{width:440px;min-height:245px;border-radius:5px;border:1px solid #94a3b8;color:#697e9b;font-size:13px;font-family:Poppins;display:flex;flex-direction:column;gap:5px;padding:10px;margin-top:10px}.textareadown[_ngcontent-%COMP%]{width:780px;color:#697e9b;font-size:13px;font-family:Poppins;display:flex;flex-direction:column;gap:5p}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin:8px 20px 20px 10px;width:1166px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;width:500px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:center;padding:10px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}.scroll-bar1[_ngcontent-%COMP%]{margin-bottom:100px;margin-top:50px;overflow-x:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.paymentconditiontextarea[_ngcontent-%COMP%]{width:690px;height:500px;border-radius:5px;background-color:#233a61;color:#fff}.downtable[_ngcontent-%COMP%]{font-style:normal;font-size:10px;border-collapse:separate;border-spacing:0 10px;height:10px;width:100px!important;position:relative;bottom:10px;padding:0;margin:0}.downtable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#e5e6eb}.imgstyle[_ngcontent-%COMP%]{position:relative;top:1px}.main-wrapper[_ngcontent-%COMP%]{padding:0 15px 0 30px}.vendor-message-textarea[_ngcontent-%COMP%]{width:100%;height:120px;background-color:#233a61;border:1px solid rgba(255,255,255,.3411764706);color:#fff;font-family:Poppins;resize:none;border-radius:4px;padding:10px}.terms-condition-textarea[_ngcontent-%COMP%]{width:100%;height:388px;margin-top:20px;background-color:#233a61;border:1px solid rgba(255,255,255,.3411764706);color:#fff;font-family:Poppins;resize:none;border-radius:4px;padding:10px}.main-wrapper[_ngcontent-%COMP%]{margin:0 26px;padding:0 15px 20px 10px}.terms-condition-wrap[_ngcontent-%COMP%]{width:90%;background-color:#233a61;margin-left:15px;border-radius:5px;color:#fff;font-family:Poppins;padding:20px}"]}),r})();var ie=u(4327),Q=u(9521),k=u(7331);function ne(r,n){1&r&&(t.TgZ(0,"mat-icon",17),t._uU(1,"cancel"),t.qZA())}function oe(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"mat-chip",15),t.NdJ("removed",function(){const s=t.CHM(i).$implicit,a=t.oxw();return t.KtG(a.remove(s))}),t._uU(1),t.YNc(2,ne,2,0,"mat-icon",16),t.qZA()}if(2&r){const i=n.$implicit,e=n.index,o=t.oxw();t.Q6J("selectable",o.selectable)("removable",o.removable),t.xp6(1),t.hij(" ",i," "),t.xp6(1),t.Q6J("ngIf",o.removable&&e+1!=1)}}function re(r,n){1&r&&(t.TgZ(0,"div",18),t._uU(1,"please enter the email "),t.qZA())}let ae=(()=>{class r{constructor(i,e){this.dialogRef=i,this.data=e,this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[Q.K5,Q.OC],this.mailArray=[],this.mails=new d.NI(null),console.log("data",e)}sendMail(){this.mailArray&&this.mailArray.length>0&&this.dialogRef.close({option:1,data:this.mailArray})}add(i){const e=i.input,o=i.value;o.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)&&((o||"").trim()&&this.mailArray.push(o.trim()),e&&(e.value=""))}remove(i){const e=this.mailArray.indexOf(i);e>=0&&this.mailArray.splice(e,1)}ngOnInit(){this.mailArray.push(this.data.vendor_detail.email)}cancel(){this.dialogRef.close({option:2,data:[]})}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(v.so),t.Y36(v.WI))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-mail-popup"]],decls:18,vars:5,consts:[["mat-dialog-title","",1,"mat-dialog-title"],[1,"row","full-width"],[1,"col-md-9"],[1,"col-md-3"],[1,"float-end","close-icon",3,"click"],["mat-dialog-content","",1,"mat-dialog-content-cstm"],[1,"esign-container"],[1,"example-chip-list"],["aria-label","Fruit selection"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New emails...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["style","color: red;",4,"ngIf"],[2,"text-align","center","margin-bottom","15px"],["type","button","id","continueButtonId","aria-label","Continue",1,"button-primary","button-spacer","theme-btn",3,"click"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[2,"color","red"]],template:function(i,e){if(1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Emails "),t.qZA(),t.TgZ(4,"div",3)(5,"mat-icon",4),t.NdJ("click",function(){return e.cancel()}),t._uU(6,"close"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"mat-form-field",7)(10,"mat-chip-list",8,9),t.YNc(12,oe,3,4,"mat-chip",10),t.TgZ(13,"input",11),t.NdJ("matChipInputTokenEnd",function(s){return e.add(s)}),t.qZA()()(),t.YNc(14,re,2,0,"div",12),t.qZA()(),t.TgZ(15,"div",13)(16,"button",14),t.NdJ("click",function(){return e.sendMail()}),t._uU(17,"Send Mails"),t.qZA()()),2&i){const o=t.MAs(11);t.xp6(12),t.Q6J("ngForOf",e.mailArray),t.xp6(1),t.Q6J("matChipInputFor",o)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",e.addOnBlur),t.xp6(1),t.Q6J("ngIf",0==e.mailArray.length)}},dependencies:[_.sg,_.O5,b.KE,k.qn,k.HS,k.oH,k.qH,v.uh,v.xY,C.Hw],styles:[".mat-dialog-title[_ngcontent-%COMP%]{padding:0 0 10px;display:flex;justify-content:space-between;align-items:center;font-style:normal;font-weight:400;font-size:14px;line-height:16px;text-transform:capitalize;color:#28313b;border-bottom:1px solid #ccc}.cancel-btn[_ngcontent-%COMP%]{background:#f3f3f3;color:#333}.space-btn[_ngcontent-%COMP%]{margin:0 5px}.mat-dialog-content[_ngcontent-%COMP%]{margin:0;padding:0 15px}.btn[_ngcontent-%COMP%]{min-width:100px;margin:0 5px}.full-width[_ngcontent-%COMP%]{width:100%}.close-icon[_ngcontent-%COMP%]{background-repeat:no-repeat;display:inline-block;fill:currentColor;cursor:pointer}.theme-btn[_ngcontent-%COMP%]{padding:7px 50px;background-color:#233a61;color:#fff;border-radius:5px;border:0;font-size:14px}.cancel-btn[_ngcontent-%COMP%]{padding:7px 50px;background-color:#fff;color:#333;border-radius:5px;border:1px solid #ccc;font-size:14px;margin:0 10px}"]}),r})();function se(r,n){if(1&r&&(t.ynx(0),t._uU(1),t.BQk()),2&r){const i=t.oxw().$implicit;t.xp6(1),t.hij(" ",i.item.tax.amount,"% ")}}function de(r,n){if(1&r&&(t.TgZ(0,"tr",55)(1,"td",56),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",57),t._uU(10),t.qZA(),t.TgZ(11,"td",58),t._uU(12),t.qZA(),t.TgZ(13,"td",58),t._uU(14),t.qZA(),t.TgZ(15,"td",58),t.YNc(16,se,2,1,"ng-container",51),t.qZA(),t.TgZ(17,"td",58),t._uU(18),t.qZA()()),2&r){const i=n.$implicit,e=n.index,o=t.oxw(2);t.xp6(2),t.hij(" ",e+1," "),t.xp6(2),t.hij(" ",i.item.item_name," "),t.xp6(2),t.hij(" ",i.item.qty," "),t.xp6(2),t.hij(" ",o.getUomName(i.item)," "),t.xp6(2),t.hij(" ",o.isBrandArray(i.item.brandName)," "),t.xp6(2),t.hij(" ",i.Rate," "),t.xp6(2),t.hij(" ",i.SubTotalAmount," "),t.xp6(2),t.Q6J("ngIf",i.item.tax&&i.item.tax.amount),t.xp6(2),t.hij(" ",i.Total," ")}}function le(r,n){1&r&&(t.TgZ(0,"button",59),t._uU(1,"Approved"),t.qZA())}function pe(r,n){1&r&&(t.TgZ(0,"button",60),t._uU(1,"Revise"),t.qZA())}function ce(r,n){1&r&&(t.TgZ(0,"button",61),t._uU(1,"Rejected"),t.qZA())}function ue(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div")(1,"button",53),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.downloadPdf())}),t._uU(2," Download PDF "),t._UZ(3,"img",54),t.qZA()()}}function me(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"span",21),t._uU(5,"Billing Address"),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"div",22)(8,"span")(9,"b"),t._uU(10),t.qZA()(),t.TgZ(11,"span"),t._uU(12),t._UZ(13,"br"),t._uU(14),t.qZA(),t.TgZ(15,"span"),t._uU(16),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.qZA(),t.TgZ(19,"span"),t._uU(20),t.qZA()()(),t.TgZ(21,"div",23)(22,"span",21),t._uU(23,"Delivery Address"),t.qZA(),t._UZ(24,"br"),t.TgZ(25,"div",24)(26,"span")(27,"b"),t._uU(28,"Date"),t.qZA(),t._uU(29),t.ALo(30,"date"),t.qZA(),t.TgZ(31,"span")(32,"b"),t._uU(33,"Validity"),t.qZA(),t._uU(34,": "),t.TgZ(35,"mat-form-field")(36,"input",25),t.NdJ("focus",function(){t.CHM(i);const o=t.MAs(39);return t.KtG(o.open())}),t.qZA(),t._UZ(37,"mat-datepicker-toggle",26)(38,"mat-datepicker",null,27),t.qZA()(),t.TgZ(40,"span")(41,"b"),t._uU(42,"PO NO"),t.qZA(),t._uU(43),t._UZ(44,"input",28),t.qZA(),t.TgZ(45,"span")(46,"b"),t._uU(47,"Site Address"),t.qZA()(),t.TgZ(48,"span"),t._uU(49),t.qZA(),t.TgZ(50,"span")(51,"b"),t._uU(52,"Contact Person"),t.qZA(),t._uU(53),t._UZ(54,"input",29),t.qZA()()()(),t.TgZ(55,"div",30)(56,"span",21),t._uU(57,"To,"),t.qZA(),t._UZ(58,"br"),t.TgZ(59,"div",31)(60,"div",32)(61,"span",33),t._uU(62),t._UZ(63,"br"),t._uU(64),t.qZA(),t.TgZ(65,"span",34),t._uU(66),t.qZA()(),t.TgZ(67,"div",35)(68,"p"),t._uU(69),t.qZA(),t.TgZ(70,"textarea",36),t._uU(71,"            "),t.qZA()()()()(),t.TgZ(72,"div",37)(73,"table",38)(74,"tr")(75,"th"),t._uU(76,"Item\xa0No"),t.qZA(),t.TgZ(77,"th"),t._uU(78,"Item\xa0Name"),t.qZA(),t.TgZ(79,"th"),t._uU(80,"Quantity"),t.qZA(),t.TgZ(81,"th"),t._uU(82,"UOM"),t.qZA(),t.TgZ(83,"th"),t._uU(84,"Brand Name"),t.qZA(),t.TgZ(85,"th"),t._uU(86,"Rate"),t.qZA(),t.TgZ(87,"th"),t._uU(88,"Sub Total"),t.qZA(),t.TgZ(89,"th"),t._uU(90,"Tax"),t.qZA(),t.TgZ(91,"th"),t._uU(92,"Total"),t.qZA()(),t.TgZ(93,"tbody"),t.YNc(94,de,19,9,"tr",39),t.qZA(),t.TgZ(95,"tr")(96,"td",40),t._uU(97,"Total\xa0amount"),t.qZA(),t.TgZ(98,"td",40),t._uU(99),t.ALo(100,"currency"),t.qZA()(),t.TgZ(101,"tr")(102,"td",40),t._uU(103,"Total\xa0Freight"),t.qZA(),t.TgZ(104,"td",40),t._uU(105),t.ALo(106,"currency"),t.qZA()(),t.TgZ(107,"tr")(108,"td",40),t._uU(109,"GST\xa0amount"),t.qZA(),t.TgZ(110,"td",40),t._uU(111),t.ALo(112,"currency"),t.qZA()(),t.TgZ(113,"tr")(114,"td",40),t._uU(115,"Grand\xa0total"),t.qZA(),t.TgZ(116,"td",41),t._uU(117),t.ALo(118,"currency"),t.qZA()()()(),t.TgZ(119,"div",42)(120,"div"),t._uU(121,"Vendor terms & other conditions "),t.TgZ(122,"mat-icon",43),t._uU(123,"border_color"),t.qZA()(),t.TgZ(124,"textarea",44),t._uU(125,"              "),t.qZA()(),t.TgZ(126,"div"),t._UZ(127,"img",45),t.TgZ(128,"p",46),t._uU(129,"Authorised Signatory"),t.qZA()(),t.TgZ(130,"div",47)(131,"div"),t.YNc(132,le,2,0,"button",48),t.qZA(),t.TgZ(133,"div"),t.YNc(134,pe,2,0,"button",49),t.qZA(),t.TgZ(135,"div"),t.YNc(136,ce,2,0,"button",50),t.qZA(),t.YNc(137,ue,4,0,"div",51),t.TgZ(138,"div",52)(139,"button",53),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.enterMail())}),t._uU(140," Send Mail "),t._UZ(141,"img",54),t.qZA()()()()}if(2&r){const i=t.MAs(39),e=t.oxw();t.xp6(10),t.Oqu(null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.company_name),t.xp6(2),t.AsE(" ",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.street_address," ",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.street_address2," "),t.xp6(2),t.lnq("",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.city," ",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.state," ",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.zip_code," "),t.xp6(2),t.hij("GSTIN:",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.gst_number,""),t.xp6(2),t.hij("PAN:",null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.pan_card,""),t.xp6(2),t.Oqu(null==e.poDetails||null==e.poDetails.billing_address?null:e.poDetails.billing_address.contact_person),t.xp6(9),t.hij(": ",t.xi3(30,43,e.poDetails.date,"dd-MM-yyyy"),""),t.xp6(7),t.Q6J("formControl",e.validityDate)("min",e.minDate)("max",e.maxDate)("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(6),t.hij(": ",null==e.poDetails?null:e.poDetails.po_number,""),t.xp6(6),t.xDo("",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.street_address," ",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.street_address2," ",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.city,",",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.state," ",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.zip_code," "),t.xp6(4),t.hij(": ",null==e.poDetails||null==e.poDetails.delivery_address?null:e.poDetails.delivery_address.contact_person,""),t.xp6(9),t.hij("",e.poDetails.vendor_detail.vendor_name," "),t.xp6(2),t.gL8(" ",e.poDetails.vendor_detail.address.street_address," ",e.poDetails.vendor_detail.address.street_address2," ",e.poDetails.vendor_detail.address.city," ",e.poDetails.vendor_detail.address.state," ",e.poDetails.vendor_detail.address.country," ",e.poDetails.vendor_detail.address.zip_code," "),t.xp6(2),t.hij("GSTIN:",e.poDetails.vendor_detail.gst_number,""),t.xp6(3),t.Oqu(e.poDetails.vendor_message_header),t.xp6(1),t.Q6J("formControl",e.mail_section),t.xp6(24),t.Q6J("ngForOf",e.poDetails.items),t.xp6(5),t.Oqu(t.xi3(100,46,e.poDetails.vendors_total[0].subTotal,"INR")),t.xp6(6),t.Oqu(t.xi3(106,49,e.poDetails.vendors_total[0].freightTotal,"INR")),t.xp6(6),t.Oqu(t.xi3(112,52,e.poDetails.vendors_total[0].gstAmount,"INR")),t.xp6(6),t.hij(" ",t.xi3(118,55,e.poDetails.vendors_total[0].total,"INR"),""),t.xp6(7),t.Q6J("formControl",e.term_condition),t.xp6(3),t.Q6J("src",e.esignImage,t.LSH),t.xp6(5),t.Q6J("ngIf","approved"==e.poDetails.status),t.xp6(2),t.Q6J("ngIf","revise"==e.poDetails.status),t.xp6(2),t.Q6J("ngIf","rejected"==e.poDetails.status),t.xp6(1),t.Q6J("ngIf","rejected"!==e.poDetails.status)}}const ge=function(){return["/procurement"]},he=function(){return["/procurement/prlist"]},_e=function(){return["/rate-comparative"]},fe=function(){return["/rate-approval"]},xe=function(){return["/purchase-order"]},ve=[{path:"",component:ut},{path:"details/:id",component:(()=>{class r{constructor(i,e,o){this.route=i,this.httpService=e,this.dialog=o,this.term_condition=new d.NI,this.mail_section=new d.NI,this.validityDate=new d.NI,this.minDate=new Date,this.maxDate=new Date((new Date).setMonth((new Date).getMonth()+12)),this.load=!1,this.downloadLoading=!1}ngOnInit(){this.route.params.subscribe(i=>{this.pageId=i.id,this.pageId&&this.fetchPurchaseOrderDetails(this.pageId)})}fetchPurchaseOrderDetails(i){this.httpService.GET(`${h.TK}/detail`,{_id:i}).subscribe(e=>{this.poDetails=e.data,this.esignImage=this.poDetails.sign,this.validityDate.patchValue(this.poDetails.due_date),this.term_condition.patchValue(this.poDetails.terms_condition),this.mail_section.patchValue(this.poDetails.vendor_message),this.mail_section.disable(),this.term_condition.disable(),this.validityDate.disable(),this.loadData()})}loadData(){var i=this;return(0,R.Z)(function*(){try{const[e,o]=yield Promise.all([i.getItemList(),i.getBrandList()]);i.updateItemsWithDetails(e),i.brandList=o,i.load=!0}catch(e){console.error("Error loading data:",e)}})()}getItemList(){return this.httpService.GET(h.o7,{}).toPromise().then(i=>i.data)}getBrandList(){return this.httpService.GET(h.Lk,{}).toPromise().then(i=>i.data)}updateItemsWithDetails(i){console.log(i),this.poDetails.items.map(s=>s.item.item_id);const o=i.reduce((s,a)=>(s[a._id]=a,s),{});this.poDetails.items=this.poDetails.items.map(s=>{const l=o[s.item.item_id]||{};return{...s,item:{...s.item,categoryDetail:l.categoryDetail||{},subCategoryDetail:l.subCategoryDetail||{},uomDetail:l.uomDetail||{},item_name:l.item_name||s.item.item_name,brandName:l.brandName||s.item.brandName,attachment:l.attachment||s.item.attachment}}}),console.log("Updated Items",this.poDetails)}downloadPdf(){this.downloadLoading=!0,this.httpService.GETPDF("generate/pdf",{template:"po",id:this.pageId}).subscribe(i=>{this.downloadLoading=!1;var e=new Blob([i],{type:"application/pdf"});let o=(new Date).getTime();(0,ie.saveAs)(e,`po-${o}.pdf`)})}isBrandArray(i){return Array.isArray(i)?this.getBrandNamesByIds(i):i}getUomName(i){return i&&i.uomDetail&&i.uomDetail.uom_name?i.uomDetail.uom_name:"Unknown UOM"}sendEmail(i){this.downloadLoading=!0,this.httpService.POST("/mail/template",{template:"po",id:this.pageId,mails:i}).subscribe(()=>{this.downloadLoading=!1})}enterMail(){this.dialog.open(ae,{maxWidth:"80vw",maxHeight:"80vh",autoFocus:!1,data:this.poDetails}).afterClosed().subscribe(e=>{e&&1===e.option&&this.sendEmail(e.data)})}getBrandNamesByIds(i){const e=this.brandList.reduce((o,s)=>(o[s._id]=s.brand_name,o),{});return i.map(o=>e[o]).filter(o=>o).join(" / ")}}return r.\u0275fac=function(i){return new(i||r)(t.Y36(f.gz),t.Y36(w.s),t.Y36(v.uw))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-purchase-order-details"]],decls:44,vars:11,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","50px","margin-left","20px"],["src","./assets/images/POL.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],["src","./assets/images/rc.svg"],["src","./assets/images/podown.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],["class","main-wrapper",4,"ngIf"],[1,"main-wrapper"],[2,"margin-top","20px"],[2,"display","flex","gap","50px","flex-wrap","wrap"],[1,"topleft"],[2,"font-size","14px","font-family","Poppins","color","#3568BA","margin-bottom","10px"],[1,"textarealeft"],[1,"topright",2,"margin-top","10px"],[1,"textarearight"],["matInput","",3,"formControl","min","max","matDatepicker","focus"],["matSuffix","",3,"for"],["picker",""],["type","text",2,"width","120px","padding","5px","border","none","margin-left","16px"],["type","text",2,"width","150px","padding","5px","border","none","margin-left","16px"],[1,"topdown"],[2,"border","1px solid #94A3B8","border-radius","5px","padding","5px 0 20px 0"],["type","text",1,"textareadown"],[2,"margin-left","20px","margin-top","10px","width","500px"],[2,"margin-left","20px"],[1,"msg-teatarea"],[1,"vendor-message-textarea",3,"formControl"],[1,"scroll-bar1"],[2,"direction","ltr !important","border","2px solid #000 !important"],["style","background-color: #F4F4F5;",4,"ngFor","ngForOf"],["colspan","5",2,"border","none","font-size","small"],["colspan","5",2,"border","none","color","#073B4C","font-weight","bold","font-size","small"],[1,"terms-condition-wrap"],[2,"font-size","medium","position","relative","top","10px"],[1,"terms-condition-textarea",3,"formControl"],["alt","",2,"width","20%","padding","2%",3,"src"],[2,"margin-left","4%","margin-top","-1%","font-weight","bold","font-size","large"],[2,"display","flex","gap","20px","justify-content","end"],["style","padding: 8px;width: 180px;background-color: #54AA52;color: #fff;border-radius: 5px;border-color: lightgrey;font-family: 'Poppins';font-size: 14px;",4,"ngIf"],["style","padding: 8px;width: 120px;background-color: #ECD172;color:#fff;border: 1px solid #94A3B8;border-radius: 5px;font-family: 'Poppins';font-size: 14px;",4,"ngIf"],["style","padding: 8px;width: 120px;background-color: #C7323B;color: #fff;border: 1px solid #94A3B8;border-radius: 5px;font-family: 'Poppins';font-size: 14px;",4,"ngIf"],[4,"ngIf"],[2,"display","none"],[2,"padding","8px","width","180px","background-color","#fff","cursor","pointer","border","0.5px solid #94A3B8","border-radius","5px","color","#797979","font-family","Poppins","font-size","14px",3,"click"],["src","./assets/images/pdfd.svg",1,"imgstyle"],[2,"background-color","#F4F4F5"],[2,"text-align","center"],["td","",2,"color","#000"],[2,"color","#000"],[2,"padding","8px","width","180px","background-color","#54AA52","color","#fff","border-radius","5px","border-color","lightgrey","font-family","Poppins","font-size","14px"],[2,"padding","8px","width","120px","background-color","#ECD172","color","#fff","border","1px solid #94A3B8","border-radius","5px","font-family","Poppins","font-size","14px"],[2,"padding","8px","width","120px","background-color","#C7323B","color","#fff","border","1px solid #94A3B8","border-radius","5px","font-family","Poppins","font-size","14px"]],template:function(i,e){1&i&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Purchase orders"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",9),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",13),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",12),t.qZA(),t.TgZ(33,"span",9),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",10),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",14),t.qZA(),t.TgZ(40,"span",15),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"div"),t.YNc(43,me,142,58,"div",16),t.qZA()),2&i&&(t.xp6(9),t.Q6J("routerLink",t.DdM(6,ge)),t.xp6(7),t.Q6J("routerLink",t.DdM(7,he)),t.xp6(7),t.Q6J("routerLink",t.DdM(8,_e)),t.xp6(7),t.Q6J("routerLink",t.DdM(9,fe)),t.xp6(7),t.Q6J("routerLink",t.DdM(10,xe)),t.xp6(6),t.Q6J("ngIf",e.poDetails))},dependencies:[f.rH,f.Od,_.sg,_.O5,b.KE,b.R9,Z.Mq,Z.hl,Z.nW,N.d,C.Hw,q.Nt,L.Ye,d.Fj,d.JJ,d.oH,_.H9,_.uU],styles:["mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-card[_ngcontent-%COMP%]{margin-left:30px;margin-bottom:20px;margin-top:10px;width:90%;height:240vh;box-shadow:0 2px 8px #00000040!important}.topdown[_ngcontent-%COMP%]{width:800px;min-height:400px;margin-top:50px}@media only screen and (max-width: 965px){.topdown[_ngcontent-%COMP%]{width:90%}}.msg-teatarea[_ngcontent-%COMP%]{width:700px;background-color:#233a61;margin-top:15px;margin-left:15px;border-radius:5px;color:#fff;font-family:Poppins;padding:20px}@media only screen and (max-width: 965px){.msg-teatarea[_ngcontent-%COMP%]{width:90%}}.textarealeft[_ngcontent-%COMP%], .textarearight[_ngcontent-%COMP%]{width:440px;min-height:245px;border-radius:5px;border:1px solid #94a3b8;color:#697e9b;font-size:13px;font-family:Poppins;display:flex;flex-direction:column;gap:5px;padding:10px;margin-top:10px}.textareadown[_ngcontent-%COMP%]{width:780px;color:#697e9b;font-size:13px;font-family:Poppins;display:flex;flex-direction:column;gap:5p}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin:8px 20px 20px 10px;width:1166px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;width:500px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:center;padding:10px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}.scroll-bar1[_ngcontent-%COMP%]{margin-bottom:100px;margin-top:50px;overflow-x:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.paymentconditiontextarea[_ngcontent-%COMP%]{width:690px;height:500px;border-radius:5px;background-color:#233a61;color:#fff}.downtable[_ngcontent-%COMP%]{font-style:normal;font-size:10px;border-collapse:separate;border-spacing:0 10px;height:10px;width:100px!important;position:relative;bottom:10px;padding:0;margin:0}.downtable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#e5e6eb}.imgstyle[_ngcontent-%COMP%]{position:relative;top:1px}.main-wrapper[_ngcontent-%COMP%]{padding:0 15px 0 30px}.vendor-message-textarea[_ngcontent-%COMP%]{width:100%;height:120px;background-color:#233a61;border:1px solid rgba(255,255,255,.3411764706);color:#fff;font-family:Poppins;resize:none;border-radius:4px;padding:10px}.terms-condition-textarea[_ngcontent-%COMP%]{width:100%;height:388px;background-color:#233a61;border:1px solid rgba(255,255,255,.3411764706);color:#fff;font-family:Poppins;resize:none;border-radius:4px;padding:10px}.main-wrapper[_ngcontent-%COMP%]{margin:0 26px;padding:0 15px 20px 10px}.terms-condition-wrap[_ngcontent-%COMP%]{background-color:#233a61;margin-left:15px;border-radius:5px;color:#fff;font-family:Poppins;padding:20px}"]}),r})()},{path:"update/:id",component:ee}];let be=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[f.Bz.forChild(ve)],_.ez,f.Bz,gt.S,d.UX,mt.w,ht.Z,xt,C.Ps]}),r})()}}]);