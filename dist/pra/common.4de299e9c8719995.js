(self.webpackChunkpra=self.webpackChunkpra||[]).push([[592],{9715:(B,T,m)=>{"use strict";m.d(T,{x:()=>p});var R=m(4327),F=m(1158),M=m(4650);let h=new ExcelJS.Workbook,p=(()=>{class y{constructor(){}generateExcel(t,n,c,o,i=[],w=[]){let s=h.addWorksheet(o),g=s.addRow([o]);if(g.font={name:"Calibri",family:4,size:14,underline:!1,bold:!0},g.alignment={vertical:"middle",horizontal:"center"},g.eachCell((a,e)=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"dce6f1"},bgColor:{argb:"FFFFFFFF"}},a.font={color:{argb:333333},size:16,bold:!0},a.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),s.mergeCells("A1:D2"),n&&"date_range"==n.type){let a=s.addRow([n.data]);a.font={name:"Calibri",family:4,size:10,underline:!1,bold:!1},a.alignment={vertical:"middle",horizontal:"center"},a.eachCell((e,d)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"dce6f1"},bgColor:{argb:"FFFFFFFF"}},e.font={color:{argb:333333},size:12,bold:!1},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),s.mergeCells("A3:D3")}s.addRow([]),t&&t.length>0&&s.addRow(t).eachCell((e,d)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"d9d9d9"},bgColor:{argb:"FFFFFFFF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),c.forEach((a,e)=>{let d=s.addRow(a);d.alignment={vertical:"middle",horizontal:"left"};let b=i[e],_=!1;if(b&&b.length>0&&b.map(l=>{let r=d.getCell(l.columnIndex);r.alignment={vertical:"middle",horizontal:"left"},r.font={color:{argb:l.fontColor},underline:!!l.underline&&l.underline,bold:!!l.bold&&l.bold},l.hAlign&&(r.alignment.horizontal=l.hAlign),l.vAlign&&(r.alignment.vertical=l.vAlign),l.fgColor&&(r.fill={type:"pattern",pattern:"solid",fgColor:{argb:l.fgColor},bgColor:{argb:"FFFFFFFF"}}),l.rowBorder&&(_=l.rowBorder);let v=!1,f={};l.cellTopBorder&&(v=!0,f={...f,top:{style:"thin"}}),l.cellLeftBorder&&(v=!0,f={...f,left:{style:"thin"}}),l.cellBottomBorder&&(v=!0,f={...f,bottom:{style:"thin"}}),l.cellRightBorder&&(v=!0,f={...f,right:{style:"thin"}}),v&&(r.border=f)}),w[e]&&w[e].length>0&&w[e].map(l=>{s.mergeCells(l.range)}),_)for(let l=1;l<=a.length;l++){d.getCell(l).border=l!=a.length?{top:{style:"thin"},bottom:{style:"thin"}}:{top:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}}),s.getColumn(3).width=30,s.getColumn(4).width=30,s.addRow([]),s.columns.forEach(function(a,e){var d=0;a.eachCell({includeEmpty:!0},function(b){var _=b.value?b.value.toString().length:10;_>d&&(d=_)}),a.width=d<10?12:d+2});var E=o.replace(/[^\w\u0621-\u064A\s]/gi,"_").toLowerCase();h.xlsx.writeBuffer().then(a=>{let e=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});R.saveAs(e,`${E}.xlsx`)}),setTimeout(()=>{h.eachSheet(a=>{h.removeWorksheet(a.name)})},1e3)}mapArrayToExcel(t,n,c,o,i,w=""){let s=[],g=[],E=[],a=[];i.map((e,d)=>{let b=[],l=e.cellDataType?e.cellDataType:"";c.map((r,v)=>{let f=l?l[v+1]:o[v],u="";"string"==f&&(u=e[r]),"date"==f&&(u=e[r],u=u?F(u).format("DD-MM-YYYY"):""),"monthyear"==f&&(u=e[r],u=u?F(u).format("MMM, YYYY"):""),"one_level"==f&&(u=e[r[0]]&&e[r[0]][r[1]]?e[r[0]][r[1]]:""),"percent"==f&&(u=e[r]?`${e[r]}%`:0),"tax_percent"==f&&(u=e[r[0]]&&e[r[0]][r[1]]?`${e[r[0]][r[1]]}(${e[r[0]][r[2]]}%)`:""),b.push(u)}),g.push(b),s[d]=[],e.columnStyle&&(E[d]=e.columnStyle),e.mergeCells&&(a[d]=e.mergeCells)}),this.generateExcel(n,w,g,t,E,a)}}return y.\u0275fac=function(t){return new(t||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},4327:function(B,T){var D;void 0!==(D=function(){"use strict";function C(t,n,c){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){A(o.response,n,c)},o.onerror=function(){console.error("could not download file")},o.send()}function M(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch{}return 200<=n.status&&299>=n.status}function h(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var p="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,y=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),A=p.saveAs||("object"!=typeof window||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(t,n,c){var o=p.URL||p.webkitURL,i=document.createElement("a");i.download=n=n||t.name||"download",i.rel="noopener","string"==typeof t?(i.href=t,i.origin===location.origin?h(i):M(i.href)?C(t,n,c):h(i,i.target="_blank")):(i.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(i.href)},4e4),setTimeout(function(){h(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,c){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function F(t,n){return typeof n>"u"?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,c),n);else if(M(t))C(t,n,c);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){h(o)})}}:function(t,n,c,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return C(t,n,c);var i="application/octet-stream"===t.type,w=/constructor/i.test(p.HTMLElement)||p.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&w||y)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var e=g.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},g.readAsDataURL(t)}else{var E=p.URL||p.webkitURL,a=E.createObjectURL(t);o?o.location=a:location.href=a,o=null,setTimeout(function(){E.revokeObjectURL(a)},4e4)}});p.saveAs=A.saveAs=A,B.exports=A}.apply(T,[]))&&(B.exports=D)}}]);