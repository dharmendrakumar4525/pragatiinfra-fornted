"use strict";(self.webpackChunkpra=self.webpackChunkpra||[]).push([[686],{5686:(Je,N,d)=>{d.r(N),d.d(N,{ProcurmentModuleModule:()=>Oe});var h=d(6895),m=d(9299),D=d(1283),o=d(4006),p=d(8608),Z=d(5439),_=d(2340),t=d(4650),b=d(2126),v=d(6104),C=d(529),I=d(7957),P=d(3238),f=d(9549),w=d(3546),g=d(9602),A=d(4850),R=d(7392),y=d(4144),U=d(4385),T=d(3683),M=d(4564);function Q(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function S(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.site_name," ")}}function Y(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.vendor_name," ")}}function j(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",26)(1,"label",27),t._uU(2,"Vendor"),t.TgZ(3,"span",28),t._uU(4,"*"),t.qZA()(),t.TgZ(5,"mat-select",49),t.NdJ("selectionChange",function(r){t.CHM(e);const s=t.oxw(3);return t.KtG(s.onVendorSelection(r))}),t.YNc(6,Y,2,2,"mat-option",30),t.qZA()()}if(2&n){const e=t.oxw(3);t.xp6(6),t.Q6J("ngForOf",e.vendorList)}}function B(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.item_name," ")}}function E(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.brand_name," ")}}function $(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"a",74),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index,s=t.oxw(4);return t.KtG(s.delete(r))}),t._UZ(1,"i",75),t.qZA()}}function z(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",58)(1,"td",59),t._uU(2),t.qZA(),t.ynx(3,60),t.TgZ(4,"td")(5,"mat-form-field",61)(6,"input",62),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(4);return t.KtG(s.searchItem(r))}),t.qZA(),t.TgZ(7,"mat-autocomplete",63,64),t.NdJ("optionSelected",function(r){const c=t.CHM(e).index,l=t.oxw(4);return t.KtG(l.selectedItem(r,c))}),t.YNc(9,B,2,2,"mat-option",30),t.qZA()()(),t.TgZ(10,"td",65),t._uU(11),t.qZA(),t.TgZ(12,"td",65),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._UZ(17,"input",66),t.qZA(),t.TgZ(18,"td")(19,"mat-form-field",61)(20,"input",67),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(4);return t.KtG(s.searchBrand(r))}),t.qZA(),t.TgZ(21,"mat-autocomplete",68,69),t.YNc(23,E,2,2,"mat-option",30),t.qZA()()(),t.TgZ(24,"td"),t._UZ(25,"input",70),t.qZA(),t.TgZ(26,"td"),t._UZ(27,"input",71),t.qZA(),t.TgZ(28,"td")(29,"div",72),t.YNc(30,$,2,0,"a",73),t.qZA()(),t.BQk(),t.qZA()}if(2&n){const e=a.$implicit,i=a.index,r=t.MAs(8),s=t.MAs(22),c=t.oxw(4);let l,u,x;t.xp6(2),t.hij(" ",i+1," "),t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Q6J("matAutocomplete",r),t.xp6(1),t.Q6J("panelWidth","auto")("displayWith",c.displayItemFn),t.xp6(2),t.Q6J("ngForOf",c.filteredItemList),t.xp6(2),t.hij(" ",null==(l=e.get("category"))?null:l.value," "),t.xp6(2),t.hij(" ",null==(u=e.get("subCategory"))?null:u.value," "),t.xp6(2),t.hij(" ",null==(x=e.get("uom"))?null:x.value," "),t.xp6(5),t.Q6J("matAutocomplete",s),t.xp6(1),t.Q6J("displayWith",c.displayBrandFn)("panelWidth","auto"),t.xp6(2),t.Q6J("ngForOf",c.filteredBrandList),t.xp6(7),t.Q6J("ngIf",i>0)}}function G(n,a){1&n&&(t.TgZ(0,"button",76),t._uU(1," Submit "),t.qZA())}function V(n,a){1&n&&(t.TgZ(0,"h2",77),t._uU(1," You don't have permission to add "),t.qZA())}function K(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",50)(2,"table",51)(3,"tr")(4,"th"),t._uU(5,"S\xa0No"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Item*"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Category"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Sub\xa0category"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Uom*"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Quantity*"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Brand Name"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Rate"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Remarks"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Action"),t.qZA()(),t.TgZ(24,"tbody"),t.YNc(25,z,31,14,"tr",52),t.qZA()()(),t.TgZ(26,"div",53)(27,"div")(28,"button",54),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3);return t.KtG(r.addItem())}),t._uU(29," Add Item + "),t.qZA()()(),t.TgZ(30,"div",55),t.YNc(31,G,2,0,"button",56),t.YNc(32,V,2,0,"h2",57),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(25),t.Q6J("ngForOf",e.purchaseRequestForm.get("items").controls),t.xp6(6),t.Q6J("ngIf",e.addPermission),t.xp6(1),t.Q6J("ngIf",!e.addPermission)}}function H(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.item_name," ")}}function W(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.brand_name," ")}}function X(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"a",74),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index,s=t.oxw(4);return t.KtG(s.delete(r))}),t._UZ(1,"i",75),t.qZA()}}function tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",58)(1,"td",59),t._uU(2),t.qZA(),t.ynx(3,60),t.TgZ(4,"td")(5,"mat-form-field",61)(6,"input",62),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(4);return t.KtG(s.searchItem(r))}),t.qZA(),t.TgZ(7,"mat-autocomplete",63,64),t.NdJ("optionSelected",function(r){const c=t.CHM(e).index,l=t.oxw(4);return t.KtG(l.selectedItem(r,c))}),t.YNc(9,H,2,2,"mat-option",30),t.qZA()()(),t.TgZ(10,"td",65),t._uU(11),t.qZA(),t.TgZ(12,"td",65),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._UZ(17,"input",66),t.qZA(),t.TgZ(18,"td")(19,"mat-form-field",61)(20,"input",67),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(4);return t.KtG(s.searchBrand(r))}),t.qZA(),t.TgZ(21,"mat-autocomplete",68,69),t.YNc(23,W,2,2,"mat-option",30),t.qZA()()(),t.TgZ(24,"td"),t._UZ(25,"input",71),t.qZA(),t.TgZ(26,"td")(27,"div",72),t.YNc(28,X,2,0,"a",73),t.qZA()(),t.BQk(),t.qZA()}if(2&n){const e=a.$implicit,i=a.index,r=t.MAs(8),s=t.MAs(22),c=t.oxw(4);let l,u,x;t.xp6(2),t.hij(" ",i+1," "),t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Q6J("matAutocomplete",r),t.xp6(1),t.Q6J("panelWidth","auto")("displayWith",c.displayItemFn),t.xp6(2),t.Q6J("ngForOf",c.filteredItemList),t.xp6(2),t.hij(" ",null==(l=e.get("category"))?null:l.value," "),t.xp6(2),t.hij(" ",null==(u=e.get("subCategory"))?null:u.value," "),t.xp6(2),t.hij(" ",null==(x=e.get("uom"))?null:x.value," "),t.xp6(5),t.Q6J("matAutocomplete",s),t.xp6(1),t.Q6J("displayWith",c.displayBrandFn)("panelWidth","auto"),t.xp6(2),t.Q6J("ngForOf",c.filteredBrandList),t.xp6(5),t.Q6J("ngIf",i>0)}}function et(n,a){1&n&&(t.TgZ(0,"button",76),t._uU(1," Submit "),t.qZA())}function nt(n,a){1&n&&(t.TgZ(0,"h2",77),t._uU(1," You don't have permission to add "),t.qZA())}function it(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",50)(1,"table",51)(2,"tr")(3,"th"),t._uU(4,"S\xa0No"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Item*"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sub\xa0category"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Uom*"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Quantity*"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Brand Name"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Remarks"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Action"),t.qZA()(),t.TgZ(21,"tbody"),t.YNc(22,tt,29,14,"tr",52),t.qZA()()(),t.TgZ(23,"div",53)(24,"div")(25,"button",54),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3);return t.KtG(r.addItem())}),t._uU(26," Add Item + "),t.qZA()()(),t.TgZ(27,"div",55),t.YNc(28,et,2,0,"button",78),t.YNc(29,nt,2,0,"h2",57),t.qZA()}if(2&n){const e=t.oxw(3);t.xp6(22),t.Q6J("ngForOf",e.purchaseRequestForm.get("items").controls),t.xp6(6),t.Q6J("ngIf",e.addPermission),t.xp6(1),t.Q6J("ngIf",!e.addPermission)}}function rt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",23),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onSubmit())}),t.TgZ(2,"mat-card",24)(3,"div",25)(4,"div",26)(5,"label",27),t._uU(6,"Request title "),t.TgZ(7,"span",28),t._uU(8,"*"),t.qZA()(),t.TgZ(9,"mat-select",29),t.NdJ("selectionChange",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.selectedTitle(r))}),t.YNc(10,Q,2,2,"mat-option",30),t.qZA()(),t.TgZ(11,"div",31)(12,"label",27),t._uU(13,"Request date"),t.qZA(),t.TgZ(14,"div",32)(15,"mat-form-field",33),t._UZ(16,"input",34)(17,"mat-datepicker-toggle",35)(18,"mat-datepicker"),t.qZA()()(),t.TgZ(19,"div",36)(20,"label",37),t._uU(21," Required By "),t.TgZ(22,"span",28),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"div",32)(25,"mat-form-field",33)(26,"input",38),t.NdJ("click",function(){t.CHM(e);const r=t.MAs(29);return t.KtG(r.open())}),t.qZA(),t._UZ(27,"mat-datepicker-toggle",39)(28,"mat-datepicker",null,40),t.qZA()()(),t.TgZ(30,"div",26)(31,"label",27),t._uU(32,"Site name "),t.TgZ(33,"span",28),t._uU(34,"*"),t.qZA()(),t.TgZ(35,"mat-select",41),t.NdJ("selectionChange",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.selectedSite(r))}),t.YNc(36,S,2,2,"mat-option",30),t.qZA()(),t.TgZ(37,"div",26)(38,"label",42),t._uU(39,"Local Purchase "),t.TgZ(40,"input",43),t.NdJ("change",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.handleLocalPurchaseChange())}),t.qZA()()(),t.TgZ(41,"div",44)(42,"label",27),t._uU(43,"Purchase request no "),t.qZA(),t._UZ(44,"input",45),t.qZA(),t.YNc(45,j,7,1,"div",46),t.qZA()(),t.YNc(46,K,33,3,"ng-container",18),t.YNc(47,it,30,3,"ng-template",null,47,t.W1O),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(29),i=t.MAs(48),r=t.oxw(2);let s,c;t.xp6(1),t.Q6J("formGroup",r.purchaseRequestForm),t.xp6(9),t.Q6J("ngForOf",r.categoryList),t.xp6(6),t.Q6J("readonly",!0),t.xp6(10),t.Q6J("matDatepicker",e)("min",r.requredByMinDate),t.xp6(1),t.Q6J("for",e),t.xp6(9),t.Q6J("ngForOf",r.siteList),t.xp6(8),t.Q6J("value",r.requestNo),t.xp6(1),t.Q6J("ngIf","yes"===(null==(s=r.purchaseRequestForm.get("local_purchase"))?null:s.value)),t.xp6(1),t.Q6J("ngIf","yes"===(null==(c=r.purchaseRequestForm.get("local_purchase"))?null:c.value))("ngIfElse",i)}}function ot(n,a){if(1&n&&(t.TgZ(0,"mat-option",48),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.label)}}const k=function(n){return["/procurement/details",n]};function at(n,a){if(1&n&&(t.TgZ(0,"td",99)(1,"a",100),t._uU(2," View\xa0details "),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(1,k,e._id))}}function st(n,a){if(1&n&&(t.TgZ(0,"td",99)(1,"a",101),t._uU(2," Approved ticket "),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(1,k,e._id))}}function ct(n,a){if(1&n&&(t.TgZ(0,"td",99)(1,"a",102),t._uU(2," Rejected "),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(1,k,e._id))}}const lt=function(n){return["/procurement/revise",n]};function pt(n,a){if(1&n&&(t.TgZ(0,"a",105),t._uU(1," Revise "),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(1,lt,e._id))}}function ut(n,a){1&n&&(t.TgZ(0,"span",106),t._uU(1," No permission to revise "),t.qZA())}function dt(n,a){if(1&n&&(t.TgZ(0,"td",99),t.YNc(1,pt,2,3,"a",103),t.YNc(2,ut,2,0,"ng-template",null,104,t.W1O),t.qZA()),2&n){const e=t.MAs(3),i=t.oxw(4);t.xp6(1),t.Q6J("ngIf",i.editPermission)("ngIfElse",e)}}function _t(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",94),t._uU(2),t.qZA(),t.TgZ(3,"td",95),t._uU(4),t.qZA(),t.TgZ(5,"td",96),t._uU(6),t.qZA(),t.YNc(7,at,3,3,"td",97),t.YNc(8,st,3,3,"td",97),t.YNc(9,ct,3,3,"td",97),t.YNc(10,dt,4,2,"td",97),t.TgZ(11,"td",98)(12,"mat-icon"),t._uU(13," arrow_forward_ios "),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(2),t.hij("Request\xa0no: ",e.purchase_request_number,""),t.xp6(2),t.hij("Title: ",e.title,""),t.xp6(2),t.hij("Site: ",e.siteData.site_name," "),t.xp6(1),t.Q6J("ngIf","pending"==e.status),t.xp6(1),t.Q6J("ngIf","approved"==e.status),t.xp6(1),t.Q6J("ngIf","rejected"==e.status),t.xp6(1),t.Q6J("ngIf","revise"==e.status)}}function mt(n,a){1&n&&(t.TgZ(0,"div",107),t._UZ(1,"img",108),t.TgZ(2,"span"),t._uU(3," No record found"),t.qZA()())}function gt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",79)(2,"div")(3,"div",80)(4,"span"),t._uU(5,"Filter by title "),t.qZA()(),t.TgZ(6,"mat-form-field",81)(7,"mat-icon",35),t._uU(8,"search"),t.qZA(),t.TgZ(9,"input",82),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.search(r,"title"))}),t.qZA()()(),t.TgZ(10,"div")(11,"div",80)(12,"span"),t._uU(13,"Filter by date"),t.qZA()(),t.TgZ(14,"div")(15,"mat-form-field",83)(16,"input",84),t.NdJ("dateChange",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.dateFilter(r))})("click",function(){t.CHM(e);const r=t.MAs(19);return t.KtG(r.open())}),t.qZA(),t._UZ(17,"mat-datepicker-toggle",39)(18,"mat-datepicker",null,85),t.qZA()()(),t.TgZ(20,"div")(21,"div",80)(22,"span"),t._uU(23,"Filter by site"),t.qZA()(),t.TgZ(24,"div")(25,"mat-form-field",83)(26,"input",86),t.NdJ("input",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.search(r,"site"))}),t.qZA()()()(),t.TgZ(27,"div",87)(28,"div",80)(29,"span"),t._uU(30,"Filter by Status"),t.qZA()(),t.TgZ(31,"div",88)(32,"mat-form-field",33)(33,"mat-select",89),t.NdJ("selectionChange",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onStatusChange(r))}),t.YNc(34,ot,2,2,"mat-option",30),t.qZA()()()()(),t.TgZ(35,"div",90)(36,"table",91)(37,"tbody"),t.YNc(38,_t,14,7,"tr",92),t.qZA()(),t.YNc(39,mt,4,0,"div",93),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(19),i=t.oxw(2);t.xp6(16),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(16),t.Q6J("formControl",i.statusOption),t.xp6(1),t.Q6J("ngForOf",i.statusList),t.xp6(4),t.Q6J("ngForOf",i.purchaseList),t.xp6(1),t.Q6J("ngIf",!(i.purchaseList&&i.purchaseList.length>0))}}const L=function(n){return{active:n}};function ht(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",20)(2,"div",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.option=1)}),t._uU(3,"Create request"),t.qZA(),t.TgZ(4,"div",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.option=2,t.KtG(r.getPurchaseList({filter_by:r.filter_by,filter_value:r.statusOption.value}))}),t._uU(5," Request list "),t.qZA()(),t.YNc(6,rt,49,11,"ng-container",22),t.YNc(7,gt,40,6,"ng-container",22),t.BQk()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngClass",t.VKq(4,L,1==e.option)),t.xp6(2),t.Q6J("ngClass",t.VKq(6,L,2==e.option)),t.xp6(2),t.Q6J("ngIf",1==e.option),t.xp6(1),t.Q6J("ngIf",2==e.option)}}function ft(n,a){1&n&&(t.TgZ(0,"h3",109),t._uU(1,"You don't have permissions to view."),t.qZA())}const xt=function(){return["/procurement"]},Zt=function(){return["/procurement/prlist"]},qt=function(){return["/rate-comparative"]},bt=function(){return["/rate-approval"]},vt=function(){return["/purchase-order"]};let At=(()=>{class n{constructor(e,i,r,s,c,l){this.router=e,this.httpService=i,this.snack=r,this.formBuilder=s,this.http=c,this.route=l,this.statusOption=new o.NI("pending"),this.statusList=[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"},{value:"revise",label:"Revise"}],this.requredByMinDate=new Date,this.vendorSearch="",this.filteredVendorList=[],this.load=!1,this.items=[],this.option=1,this.purchaseList=[],this.filter_by="status",this.originalPurchaseList=[],this.filter_value="pending",this.requestNo=0,this.details={},this.purchaseRequestForm=new o.cw({title:new o.NI("",o.kI.required),date:new o.NI(Z().format("DD-MM-YYYY"),o.kI.required),expected_delivery_date:new o.NI(Z().add(1,"days").format("DD-MM-YYYY"),o.kI.required),purchase_request_number:new o.NI(null,o.kI.required),site:new o.NI("",o.kI.required),local_purchase:new o.NI("no",o.kI.required),remarks:new o.NI(""),items:this.formBuilder.array([]),vendor:new o.NI})}onSubmit(){if(this.load||!this.purchaseRequestForm.valid)return;let e=this.purchaseRequestForm.value;const i=this.categoryList.find(r=>r._id==e.title);if(console.log(i),e.title=i.name,e.requestNo=this.requestNo,e.date=Z(e.date,"DD-MM-YYYY").toDate(),e.expected_delivery_date=new Date(e.expected_delivery_date),console.log(e),"yes"===this.purchaseRequestForm.get("local_purchase").value){let r=[],s={Vendor:e.vendor||null,items:[]};if(e.items&&this.itemList)for(let c of e.items){let l={item:this.itemList.find(u=>u._id===c.item_id)||null,RequiredQuantity:c.qty,Rate:c.rate,SubTotalAmount:c.qty*c.rate,Total:0};l.item&&(delete l.item.category,delete l.item.created_at,delete l.item.gst,l.item.gstDetail&&(l.item.tax={amount:l.item.gstDetail.gst_percentage||0,name:l.item.gstDetail.gst_name||""},delete l.item.gstDetail),delete l.item.item_number,delete l.item.specification,delete l.item.sub_category,delete l.item.uom,delete l.item.updated_at,l.item.qty=l.RequiredQuantity,l.item.item_id=c.item_id,l.item.remark=c.remark,l.Total=c.qty*c.rate+c.qty*c.rate*(l.item.tax?l.item.tax.amount:0)/100,s.items.push(l))}r.push(s),e.vendorItems=r}this.load=!0,this.httpService.POST(p.Fj,e).subscribe({next:r=>{this.load=!1,this.snack.notify("Purchase request has been created.",1),this.purchaseRequestForm.reset(),this.purchaseRequestForm.markAsUntouched(),this.option=2,this.getPurchaseList({filter_by:this.filter_by,filter_value:this.statusOption.value})},error:r=>{if(this.load=!1,r.errors&&Object.keys(r.errors).length>0){let s="<ul>";for(let c in r.errors)s+=`<li>${r.errors[c][0]}</li>`;s+="</ul>",this.snack.notifyHtml(s,2)}else this.snack.notify(r.message||"An error occurred",2)}})}getList(){const e=this.http.get(`${_.N.api_path}${p.PE}`),i=this.http.get(`${_.N.api_path}${p.o7}`),r=this.http.get(`${_.N.api_path}${p.S3}`),s=this.http.get(`${_.N.api_path}${p.ds}`),c=this.http.get(`${_.N.api_path}${p.Lk}`),l=this.http.get(`${_.N.api_path}${p.jz}`);this.httpService.multipleRequests([e,i,s,c,r,l],{}).subscribe(u=>{u&&(this.uomList=u[0].data,this.itemList=u[1].data,this.vendorList=u[2].data,this.brandList=u[3].data,console.log(this.brandList),this.superSiteList=u[4].data,this.categoryList=u[5].data,this.filteredItemList=this.itemList,this.filteredBrandList=this.brandList,"superadmin"===this.permissions.user.role&&(this.siteList=this.superSiteList))})}addItem(){this.items=this.purchaseRequestForm.get("items"),"yes"===this.purchaseRequestForm.get("local_purchase").value?this.items.push(this.createLocalItem()):this.items.push(this.createItem())}createItem(){return this.formBuilder.group({item_id:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),category:new o.NI(null),subCategory:new o.NI(null),attachment:new o.NI(""),remark:new o.NI(""),uom:new o.NI(""),brandName:new o.NI("",o.kI.required)})}createLocalItem(){return this.formBuilder.group({item_id:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),category:new o.NI(null),subCategory:new o.NI(null),attachment:new o.NI(""),remark:new o.NI(""),uom:new o.NI(""),brandName:new o.NI("",o.kI.required),rate:new o.NI(""),gst:new o.NI(""),freight:new o.NI("")})}handleLocalPurchaseChange(){"yes"===this.purchaseRequestForm.get("local_purchase").value?this.purchaseRequestForm.get("local_purchase").setValue("no"):this.purchaseRequestForm.get("local_purchase").setValue("yes"),this.purchaseRequestForm.get("items").clear(),this.addItem()}onVendorSelection(e){const i=this.vendorList.find(r=>r._id===e.value);i?this.filteredItemList=this.itemList.filter(r=>{const s=i.category.some(l=>l===r.category),c=i.SubCategory.some(l=>l===r.sub_category);return s&&c}):(console.warn("No matching vendor found for the selected ID."),this.filteredItemList=[])}delete(e){this.purchaseRequestForm.get("items").removeAt(e)}onStatusChange(e){this.getPurchaseList({filter_by:this.filter_by,filter_value:e.value})}selectedTitle(e){this.categoryList.find(s=>s._id==e.value).name.replace(/[ ,]/g,"_"),console.log("titleSelected",this.purchaseRequestForm)}selectedSite(e){const i=this.siteList.find(l=>l._id==e.value);i.site_name.replace(/[ ,]/g,"_"),console.log("title",this.purchaseRequestForm);const c=this.http.get(`${_.N.api_path}${p.Fj}`);this.httpService.multipleRequests([c],{}).subscribe(l=>{if(l){this.purchaseList=l[0].data;const u=this.purchaseList.filter(x=>x.siteData.site_name.includes(i.site_name));this.requestNo=u.length+1,this.purchaseRequestForm.controls.purchase_request_number.setValue(this.requestNo)}})}getPurchaseList(e){this.httpService.GET(p.Fj,e).subscribe({next:i=>{this.originalPurchaseList=i.data,this.purchaseList=i.data}})}dateFilter(e){this.originalPurchaseList&&this.originalPurchaseList.length>0&&(this.purchaseList=e.value?this.originalPurchaseList.filter(i=>new Date(i.date)==new Date(e.value)):this.originalPurchaseList)}search(e,i){this.originalPurchaseList&&this.originalPurchaseList.length>0&&(this.purchaseList="site"==i?e.target.value?this.originalPurchaseList.filter(r=>r.siteData.site_name.toLowerCase().includes(e.target.value.toLowerCase())):this.originalPurchaseList:e.target.value?this.originalPurchaseList.filter(r=>r.title.toLowerCase().includes(e.target.value.toLowerCase())):this.originalPurchaseList)}displayItemFn(e){return e?e.item_name:""}displayBrandFn(e){return e?e.brand_name:""}selectedItem(e,i){let r=this.itemList.filter(l=>l._id==e.option.value._id)[0]?.categoryDetail.name,s=this.itemList.filter(l=>l._id==e.option.value._id)[0]?.subCategoryDetail.subcategory_name,c=this.itemList.filter(l=>l._id==e.option.value._id)[0]?.uomDetail.uom_name;this.items.at(i).patchValue({category:r,subCategory:s,uom:c})}searchItem(e){const i=e.target.value.toLowerCase();this.itemList&&this.itemList.length>0&&(this.filteredItemList=e.target.value?this.itemList.filter(r=>r.item_name.toLowerCase().includes(i)):this.itemList)}searchBrand(e){const i=e.target.value.toLowerCase();this.brandList&&this.brandList.length>0&&(this.filteredBrandList=e.target.value?this.brandList.filter(r=>r.brand_name.toLowerCase().includes(i)):this.brandList)}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:r=>{this.viewPermission=r.dashboard_permissions[0].ParentChildchecklist[18].childList[0].isSelected,this.addPermission=r.dashboard_permissions[0].ParentChildchecklist[18].childList[1].isSelected,this.editPermission=r.dashboard_permissions[0].ParentChildchecklist[18].childList[2].isSelected},error:r=>{console.log(r)}}),this.siteList=this.permissions.user.sites,console.log(this.siteList),this.getList(),this.addItem()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(b.s),t.Y36(v.o),t.Y36(o.qu),t.Y36(C.eN),t.Y36(m.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-purchase-request"]],decls:46,vars:12,consts:[[1,"main-container"],[2,"height","100px","background-color","#fff"],[2,"margin-top","40px","margin-left","20px"],["src","./assets/images/preq.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/prl.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],["src","./assets/images/rc.svg"],[2,"width","100px","margin-left","10px","margin-top","10px","border","1px dashed"],["src","./assets/images/po.svg"],[4,"ngIf","ngIfElse"],["noView",""],[1,"requests"],[3,"ngClass","click"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"topcard"],[2,"display","flex","flex-wrap","wrap","gap","10px","max-width","100%"],[1,"flex-div",2,"display","flex","flex-direction","column"],[2,"color","#4272BF","font-size","14px"],[1,"star"],["id","title","placeholder","Select title","formControlName","title",2,"padding","10px","width","75%","border","1px solid #ccc","border-radius","6px","cursor","pointer","font-family","Poppins",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-div","custom-form-group"],[1,"custom-form-control"],["appearance","outline"],["matInput","","formControlName","date","placeholder","Enter Required by date",3,"readonly"],["matSuffix",""],[1,"flex-div","custom-form-group",2,"margin-right","45px"],["for","",1,"custom-label",2,"color","#4272BF","font-size","14px"],["matInput","","formControlName","expected_delivery_date","placeholder","Enter Required by date",2,"width","100%",3,"matDatepicker","min","click"],["matSuffix","",3,"for"],["requiredByStartDate",""],["id","site","placeholder","Select site","formControlName","site",2,"padding","10px","width","75%","border","1px solid #ccc","border-radius","6px","cursor","pointer","font-family","Poppins",3,"selectionChange"],[2,"color","#4272BF"],["type","checkbox","name","local_purchase_checkbox",2,"transform","scale(1.5)","margin-left","20px","margin-top","30px",3,"change"],[2,"display","flex","flex-direction","column"],["placeholder","Select Site Name First","formControlName","purchase_request_number","readonly","",1,"reqNO",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins",3,"value"],["class","flex-div","style","display: flex; flex-direction: column;",4,"ngIf"],["noLocalPurchase",""],[3,"value"],["id","site","placeholder","Select Vendor","formControlName","vendor",2,"padding","10px","width","75%","border","1px solid #ccc","border-radius","6px","cursor","pointer","font-family","Poppins",3,"selectionChange"],[1,"scroll-bar1"],[1,"items-table",2,"direction","ltr !important","border-left","2px solid #000 !important"],["style","background-color: #F4F4F5;","formArrayName","items",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","gap","40px","margin-left","38px","margin-bottom","100px","margin-top","100px","top","-50px","position","relative"],[2,"padding","8px","width","120px","background-color","#fff","cursor","pointer","border","0.5px solid #94A3B8","border-radius","5px","font-size","14px","font-family","Poppins",3,"click"],[2,"display","flex","justify-content","center","margin-top","-126px","margin-bottom","20px"],["style","\n            padding: 8px;\n            width: 120px;\n            background-color: #233A61;\n            color: #fff;\n            border-radius: 5px;\n            border-color: lightgrey;\n            font-size: 14px;\n            font-family: 'Poppins';\n          ",4,"ngIf"],["style","color: red;",4,"ngIf"],["formArrayName","items",2,"background-color","#F4F4F5"],[2,"text-align","center"],[3,"formGroupName"],[1,"example-full-width"],["type","text","placeholder","Select Item","aria-label","Item","matInput","","formControlName","item_id",3,"matAutocomplete","input"],[3,"panelWidth","displayWith","optionSelected"],["auto","matAutocomplete"],[2,"color","#000"],["type","text","placeholder","Enter","digitOnly","","formControlName","qty",1,"pr-form-field"],["type","text","placeholder","Select Brand","aria-label","Brand","matInput","","formControlName","brandName",3,"matAutocomplete","input"],[3,"displayWith","panelWidth"],["fill","matAutocomplete"],["type","text","placeholder","Enter","digitOnly","","formControlName","rate",1,"pr-form-field"],["placeholder","Enter","formControlName","remark",1,"pr-form-field"],[1,"action-btn-wrapper"],["class","action-btn","title","Delete",3,"click",4,"ngIf"],["title","Delete",1,"action-btn",3,"click"],[1,"fa","fa-trash"],[2,"padding","8px","width","120px","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-size","14px","font-family","Poppins"],[2,"color","red"],["style","\n              padding: 8px;\n              width: 120px;\n              background-color: #233A61;\n              color: #fff;\n              border-radius: 5px;\n              border-color: lightgrey;\n              font-size: 14px;\n              font-family: 'Poppins';\n            ",4,"ngIf"],[2,"display","flex","flex-direction","row","gap","10px","margin","0 27px"],[2,"margin-top","15px","color","#94A3B8"],["appearance","outline",1,"searchbar"],["matInput","","type","search","placeholder","search title",1,"search-input",3,"input"],["appearance","outline",1,"datebar"],["matInput","","placeholder","Date",3,"matDatepicker","dateChange","click"],["startPicker",""],["matInput","","placeholder","Site",3,"input"],[1,"custom-form-group"],[1,"custom-form-control",2,"position","relative"],[3,"formControl","selectionChange"],[1,"scroll-bar1",2,"width","93%"],[1,"r-list",2,"direction","ltr !important","margin-top","-20px"],[4,"ngFor","ngForOf"],["class","no-record-found",4,"ngIf"],[2,"color","#4272BF","width","300px","text-align","left","padding","18px"],[2,"color","#4272BF","width","200px"],[2,"color","#4272BF","width","800px","text-align","left","padding","18px"],["style","width: 20%;\n            text-align: right;",4,"ngIf"],[2,"width","100px"],[2,"width","20%","text-align","right"],[1,"viewdetail-btn",3,"routerLink"],[1,"viewdetail-btn",2,"background-color","#54AA52","color","#fff",3,"routerLink"],[1,"viewdetail-btn",2,"background-color","#C7323B","color","#fff",3,"routerLink"],["class","viewdetail-btn","style","background-color: #ECD172;color:#fff;",3,"routerLink",4,"ngIf","ngIfElse"],["disabledState",""],[1,"viewdetail-btn",2,"background-color","#ECD172","color","#fff",3,"routerLink"],[1,"viewdetail-btn",2,"background-color","#ECD172","color","#fff"],[1,"no-record-found"],["src","./assets/images/inbox_empty.png","alt",""],[2,"display","flex","justify-content","center","margin-top","2%","font-size","160%","font-weight","bolder","color","grey"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2),t._UZ(3,"img",3),t.qZA(),t.TgZ(4,"span",4),t._uU(5,"Purchase Request "),t.qZA(),t._UZ(6,"span",5),t.qZA(),t.TgZ(7,"div"),t._UZ(8,"hr",6),t.qZA(),t.TgZ(9,"div",7)(10,"div",8)(11,"div"),t._UZ(12,"img",9),t.qZA(),t.TgZ(13,"span",10),t._uU(14,"Purchase\xa0request"),t.qZA(),t.TgZ(15,"div"),t._UZ(16,"mat-divider",11),t.qZA()(),t.TgZ(17,"div",12)(18,"div"),t._UZ(19,"img",13),t.qZA(),t.TgZ(20,"span",14),t._uU(21,"Approvals"),t.qZA(),t.TgZ(22,"div"),t._UZ(23,"mat-divider",11),t.qZA()(),t.TgZ(24,"div",12)(25,"div"),t._UZ(26,"img",15),t.qZA(),t.TgZ(27,"span",14),t._uU(28,"Rate\xa0Comparative"),t.qZA(),t.TgZ(29,"div"),t._UZ(30,"mat-divider",11),t.qZA()(),t.TgZ(31,"div",12)(32,"div"),t._UZ(33,"img",13),t.qZA(),t.TgZ(34,"span",14),t._uU(35,"Rate\xa0Approvals"),t.qZA(),t.TgZ(36,"div"),t._UZ(37,"mat-divider",16),t.qZA()(),t.TgZ(38,"div",12)(39,"div"),t._UZ(40,"img",17),t.qZA(),t.TgZ(41,"span",14),t._uU(42,"Purchase\xa0orders"),t.qZA()()(),t.YNc(43,ht,8,8,"ng-container",18),t.YNc(44,ft,2,0,"ng-template",null,19,t.W1O),t.qZA()),2&e){const r=t.MAs(45);t.xp6(10),t.Q6J("routerLink",t.DdM(7,xt)),t.xp6(7),t.Q6J("routerLink",t.DdM(8,Zt)),t.xp6(7),t.Q6J("routerLink",t.DdM(9,qt)),t.xp6(7),t.Q6J("routerLink",t.DdM(10,bt)),t.xp6(7),t.Q6J("routerLink",t.DdM(11,vt)),t.xp6(5),t.Q6J("ngIf",i.viewPermission)("ngIfElse",r)}},dependencies:[I.XC,I.ZL,P.ey,f.KE,f.R9,w.a8,g.Mq,g.hl,g.nW,A.d,R.Hw,y.Nt,U.gD,T.Ye,h.mk,h.sg,h.O5,o._Y,o.Fj,o.JJ,o.JL,o.oH,o.sg,o.u,o.x0,o.CE,M.L,m.rH,m.yS,m.Od],styles:['mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.requests[_ngcontent-%COMP%]{height:40px;width:1140px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:14px}.requests[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{height:40px;width:250px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;flex:1}.requests[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background:rgba(0,0,0,.2)}.requests[_ngcontent-%COMP%]   div.active[_ngcontent-%COMP%]{background-color:#233a61!important;color:#fff}.topcard[_ngcontent-%COMP%]{width:1140px;height:auto;margin-left:30px;margin-top:30px;box-shadow:0 2px 12px #00000040;font-family:Poppins}table.items-table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin:8px 20px 20px 10px}.items-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;width:1000px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}.items-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:left;padding:20px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}.items-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}.scroll-bar1[_ngcontent-%COMP%]{height:auto;width:calc(100% - 25px);margin-left:25px;margin-bottom:10px;margin-top:50px;overflow:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.pr-form-field[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:6px;border:1px solid #9f9f9f;cursor:pointer;background:none}.select-form-field[_ngcontent-%COMP%]{padding:10px;width:150px;border:1px solid #9f9f9f;border-radius:20px;cursor:pointer;background-color:"Transparent "!important}.action-btn-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.r-list[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0 25px}.r-list[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#e5e6eb!important}.viewdetail-btn[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;cursor:pointer;text-align:center;padding:18px 25px}.no-record-found[_ngcontent-%COMP%]{text-align:center;display:flex;gap:10px;flex-direction:column;align-items:center;justify-content:center}.no-record-found[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:188px}.mat-radio-button[_ngcontent-%COMP%]   .mat-radio-label[_ngcontent-%COMP%]{margin-right:5px!important}.flex-div[_ngcontent-%COMP%]{width:31%}.main-container[_ngcontent-%COMP%]{margin:10px 20px 0 15px}']}),n})();var q=d(1948);function yt(n,a){if(1&n&&(t.TgZ(0,"mat-option",49),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.site_name," ")}}function Tt(n,a){if(1&n&&(t.TgZ(0,"div",50)(1,"label",21),t._uU(2,"Vendor "),t.qZA(),t._UZ(3,"input",51),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("readonly",!0)("value",e.selectedVendor)}}function Ct(n,a){if(1&n&&(t.TgZ(0,"tr",55)(1,"td",56),t._uU(2),t.qZA(),t.ynx(3),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",57),t._uU(7),t.qZA(),t.TgZ(8,"td",57),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td",57),t._uU(13),t.qZA(),t.TgZ(14,"td",57),t._uU(15),t.qZA(),t.TgZ(16,"td",57),t._uU(17),t.qZA(),t.TgZ(18,"td",57),t._uU(19),t.qZA(),t.BQk(),t.qZA()),2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);t.xp6(2),t.hij(" ",i+1," "),t.xp6(3),t.hij(" ",r.getItemName(e.item_id)," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.hij(" ",r.myBrandName(e.brandName)," "),t.xp6(2),t.hij(" ",e.rate," "),t.xp6(2),t.hij(" ",e.remark," ")}}function Pt(n,a){if(1&n&&(t.TgZ(0,"div")(1,"div",52)(2,"table",53)(3,"tr")(4,"th"),t._uU(5,"S\xa0No"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Item*"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Category"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Sub\xa0category"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Uom*"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Quantity*"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Brand Name"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Rate"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Remarks"),t.qZA()(),t.TgZ(22,"tbody"),t.YNc(23,Ct,20,9,"tr",54),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(23),t.Q6J("ngForOf",null==e.details?null:e.details.items)}}function wt(n,a){if(1&n&&(t.TgZ(0,"tr",55)(1,"td",56),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",57),t._uU(6),t.qZA(),t.TgZ(7,"td",57),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA()()),2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);t.xp6(2),t.hij(" ",i+1," "),t.xp6(2),t.hij(" ",r.getItemName(e.item_id)," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.hij(" ",r.myBrandName(e.brandName)," "),t.xp6(2),t.hij(" ",e.remark," ")}}function Ut(n,a){if(1&n&&(t.TgZ(0,"div",52)(1,"table",58)(2,"tr")(3,"th"),t._uU(4,"S\xa0No"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Item*"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sub\xa0category"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Uom*"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Quantity*"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Brand Name"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Remarks"),t.qZA()(),t.TgZ(19,"tbody"),t.YNc(20,wt,17,8,"tr",54),t.qZA()()()),2&n){const e=t.oxw();t.xp6(20),t.Q6J("ngForOf",null==e.details?null:e.details.items)}}function kt(n,a){1&n&&(t.TgZ(0,"button",59),t._uU(1,"Pending"),t.qZA())}function Nt(n,a){1&n&&(t.TgZ(0,"button",60),t._uU(1,"Approved"),t.qZA())}function It(n,a){1&n&&(t.TgZ(0,"button",61),t._uU(1,"Rejected"),t.qZA())}const Rt=function(){return["/procurement"]},Mt=function(){return["/procurement/prlist"]},Lt=function(){return["/rate-comparative"]},Ft=function(){return["/rate-approval"]},Ot=function(){return["/purchase-order"]};let Jt=(()=>{class n{constructor(e,i,r,s,c,l){this.router=e,this.httpService=i,this.snack=r,this.formBuilder=s,this.route=c,this.http=l,this.load=!1,this.purchaseRequestForm=new o.cw({title:new o.NI("",o.kI.required),date:new o.NI("",o.kI.required),expected_delivery_date:new o.NI("",o.kI.required),purchase_request_number:new o.NI(""),site:new o.NI({value:"",disabled:!0},o.kI.required),local_purchase:new o.NI({value:"",disabled:!0},o.kI.required),remarks:new o.NI("",[]),items:this.formBuilder.array([]),_id:new o.NI}),this.details={},this.getList()}getList(){const e=this.http.get(`${_.N.api_path}${p.PE}`),i=this.http.get(`${_.N.api_path}${p.o7}`),r=this.http.get(`${_.N.api_path}${p.S3}`),s=this.http.get(`${_.N.api_path}${p.Lk}`);this.httpService.multipleRequests([e,i,r,s],{}).subscribe(c=>{c&&(this.uomList=c[0].data,this.itemList=c[1].data,this.siteList=c[2].data,this.brandList=c[3].data)})}patchData(e){this.purchaseRequestForm.patchValue({title:e.title,date:e.date,expected_delivery_date:e.expected_delivery_date,purchase_request_number:e.purchase_request_number,site:e.site,local_purchase:e.local_purchase,remarks:e.remarks}),this.purchaseRequestForm.controls.remarks.disable()}createItemArrayForm(){return new o.cw({item_id:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),category:new o.NI(""),subCategory:new o.NI(""),attachment:new o.NI(""),remark:new o.NI("",o.kI.required),uom:new o.NI("",o.kI.required),brandName:new o.NI("")})}addItems(e){this.items=this.purchaseRequestForm.get("items"),e&&this.items.push(this.createItem(e))}createItem(e){if(e)return new o.cw({item_id:new o.NI(e.item_id,o.kI.required),qty:new o.NI(e.qty,o.kI.required),category:new o.NI(e.categoryDetail.name),subCategory:new o.NI(e.subCategoryDetail.subcategory_name),attachment:new o.NI(e.attachment),remark:new o.NI(e.remark,o.kI.required),uom:new o.NI(e.uomDetail._id,o.kI.required),brandName:new o.NI(e.brandName)})}myBrandName(e){if(this.brandList)return this.brandList.filter(r=>r._id==e)[0].brand_name}getSiteList(){this.httpService.GET(p.S3,{}).subscribe(e=>{this.siteList=e})}getItemName(e){if(this.itemList&&this.itemList.length>0)return this.itemList.filter(i=>i._id==e)[0].item_name}updateRequest(e){this.httpService.PUT(p.Fj,{_id:this.details._id,status:e,remarks:this.purchaseRequestForm.value.remarks}).subscribe(i=>{this.router.navigate(["/procurement/prlist"])})}getVendorName(){if(this.details.vendor){const e=this.http.get(`${_.N.api_path}${p.Iy}?_id=${this.details.vendor}`);this.httpService.multipleRequests(e,{}).subscribe(i=>{i&&(console.log(i[0]),this.selectedVendor=i[0].data[0].vendor_name)})}}ngOnInit(){this.route.params.subscribe(e=>{e.id&&this.httpService.GET(`${p.Fj}/detail`,{_id:e.id}).subscribe({next:i=>{this.details=i.data[0],console.log(this.details),this.getVendorName(),this.patchData(i.data[0])},error:i=>{this.router.navigate(["/procurement/prlist"])}})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(b.s),t.Y36(v.o),t.Y36(o.qu),t.Y36(m.gz),t.Y36(C.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-purchase-request-details"]],decls:101,vars:27,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-left","20px"],["src","./assets/images/preq.svg",2,"width","30px"],[2,"font-family","Poppins","font-style","normal","font-weight","600","font-size","22px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","100%","border","2px solid #C5C5C5"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/prl.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],["src","./assets/images/rc.svg"],[2,"width","100px","margin-left","10px","margin-top","10px","border","1px dashed"],["src","./assets/images/po.svg"],[3,"formGroup"],[1,"topcard"],[2,"display","flex","flex-wrap","wrap","gap","10px","max-width","100%"],[1,"flex-div",2,"display","flex","flex-direction","column"],[2,"color","#4272BF","font-size","14px"],["placeholder","Enter title","formControlName","title",2,"width","100%","padding","10px","border-radius","6px","border","1px solid #ccc","cursor","pointer","margin-top","3px","font-family","Poppins","height","50px",3,"readonly"],["appearance","outline"],["matInput","","formControlName","date","placeholder","Auto generate Request Date",3,"matDatepicker","readonly"],["matSuffix","",3,"for"],["date",""],[1,"flex-div","custom-form-group"],["for","",1,"custom-label",2,"color","#4272BF","font-size","14px"],[1,"star"],[1,"custom-form-control"],["matInput","","formControlName","expected_delivery_date","placeholder","Enter Required by",3,"matDatepicker","readonly"],["requiredByStartDate",""],["placeholder","Auto generate","formControlName","purchase_request_number","readonly","",2,"width","100%","padding","10px","border-radius","6px","border","1px solid #ccc","cursor","pointer","margin-top","10px","font-family","Poppins"],["id","site","placeholder","Select site","formControlName","site",2,"padding","10px","width","100","border","1px solid #ccc","border-radius","6px","cursor","pointer","margin-top","10px","font-family","Poppins"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-div",2,"display","flex","flex-direction","column","align-items","center"],[2,"color","#4272BF","margin-bottom","10px"],["aria-labelledby","example-radio-group-label","color","primary","formControlName","local_purchase",1,"example-radio-group"],[1,"example-radio-button",3,"value"],["style","display: flex;flex-direction: column;",4,"ngIf"],[4,"ngIf","ngIfElse"],["noLocalPurchase",""],[1,"text-area-section"],["name","","id","","cols","30","rows","5","formControlName","remarks"],[1,"button-list"],["class","pending",4,"ngIf"],["style","padding: 8px;width: 120px;background-color: #35B568;color: #fff;border-radius: 5px;border-color: lightgrey;font-size: 14px;font-family: 'Poppins';",4,"ngIf"],["style","padding: 8px;width: 120px;background-color: #C7323B;color: #233A61;border: 1px solid #94A3B8;border-radius: 5px;font-size: 14px;font-family: 'Poppins';",4,"ngIf"],[3,"value"],[2,"display","flex","flex-direction","column"],["placeholder","Enter Vendor",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins",3,"readonly","value"],[1,"scroll-bar1"],[2,"direction","ltr !important","border-left","2px solid #000 !important"],["style","background-color: #F4F4F5;",4,"ngFor","ngForOf"],[2,"background-color","#F4F4F5"],[2,"text-align","center"],[2,"color","#000"],[2,"direction","ltr !important","border-left","2px solid #000 !important","width","100%"],[1,"pending"],[2,"padding","8px","width","120px","background-color","#35B568","color","#fff","border-radius","5px","border-color","lightgrey","font-size","14px","font-family","Poppins"],[2,"padding","8px","width","120px","background-color","#C7323B","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-size","14px","font-family","Poppins"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Summary "),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",13),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",14),t.qZA(),t.TgZ(26,"span",13),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",12),t.qZA(),t.TgZ(33,"span",13),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",15),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",16),t.qZA(),t.TgZ(40,"span",13),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"form",17)(43,"mat-card",18)(44,"div",19)(45,"div",20)(46,"label",21),t._uU(47,"Request title "),t.qZA(),t._UZ(48,"input",22),t.qZA(),t.TgZ(49,"div",20)(50,"label",21),t._uU(51,"Request date"),t.qZA(),t.TgZ(52,"mat-form-field",23),t._UZ(53,"input",24)(54,"mat-datepicker-toggle",25)(55,"mat-datepicker",null,26),t.qZA()(),t.TgZ(57,"div",27)(58,"label",28),t._uU(59," Required by "),t.TgZ(60,"span",29),t._uU(61,"*"),t.qZA()(),t.TgZ(62,"div",30)(63,"mat-form-field",23),t._UZ(64,"input",31)(65,"mat-datepicker-toggle",25)(66,"mat-datepicker",null,32),t.qZA()()(),t.TgZ(68,"div",20)(69,"label",21),t._uU(70,"Purchase request no "),t.qZA(),t._UZ(71,"input",33),t.qZA(),t.TgZ(72,"div",20)(73,"label",21),t._uU(74,"Site name "),t.TgZ(75,"span",29),t._uU(76,"*"),t.qZA()(),t.TgZ(77,"mat-select",34),t.YNc(78,yt,2,2,"mat-option",35),t.qZA()(),t.TgZ(79,"div",36)(80,"label",37),t._uU(81,"Local Purchase "),t.TgZ(82,"span",29),t._uU(83,"*"),t.qZA()(),t.TgZ(84,"mat-radio-group",38)(85,"mat-radio-button",39),t._uU(86," Yes "),t.qZA(),t.TgZ(87,"mat-radio-button",39),t._uU(88," No "),t.qZA()()(),t.YNc(89,Tt,4,2,"div",40),t.qZA()(),t.YNc(90,Pt,24,1,"div",41),t.YNc(91,Ut,21,1,"ng-template",null,42,t.W1O),t.TgZ(93,"div",43)(94,"label",21),t._uU(95,"Remarks "),t.qZA(),t._UZ(96,"textarea",44),t.qZA(),t.TgZ(97,"div",45),t.YNc(98,kt,2,0,"button",46),t.YNc(99,Nt,2,0,"button",47),t.YNc(100,It,2,0,"button",48),t.qZA()()),2&e){const r=t.MAs(56),s=t.MAs(67),c=t.MAs(92);t.xp6(9),t.Q6J("routerLink",t.DdM(22,Rt)),t.xp6(7),t.Q6J("routerLink",t.DdM(23,Mt)),t.xp6(7),t.Q6J("routerLink",t.DdM(24,Lt)),t.xp6(7),t.Q6J("routerLink",t.DdM(25,Ft)),t.xp6(7),t.Q6J("routerLink",t.DdM(26,Ot)),t.xp6(5),t.Q6J("formGroup",i.purchaseRequestForm),t.xp6(6),t.Q6J("readonly",!0),t.xp6(5),t.Q6J("matDatepicker",r)("readonly",!0),t.xp6(1),t.Q6J("for",r),t.xp6(10),t.Q6J("matDatepicker",s)("readonly",!0),t.xp6(1),t.Q6J("for",s),t.xp6(13),t.Q6J("ngForOf",i.siteList),t.xp6(7),t.Q6J("value","yes"),t.xp6(2),t.Q6J("value","no"),t.xp6(2),t.Q6J("ngIf","yes"==(null==i.details?null:i.details.local_purchase)),t.xp6(1),t.Q6J("ngIf","yes"==(null==i.details?null:i.details.local_purchase))("ngIfElse",c),t.xp6(8),t.Q6J("ngIf","pending"==i.details.status),t.xp6(1),t.Q6J("ngIf","approved"==i.details.status),t.xp6(1),t.Q6J("ngIf","rejected"==i.details.status)}},dependencies:[P.ey,f.KE,f.R9,w.a8,g.Mq,g.hl,g.nW,A.d,y.Nt,q.VQ,q.U0,U.gD,T.Ye,h.sg,h.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,m.rH,m.Od],styles:['mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.requests[_ngcontent-%COMP%]{height:40px;width:1140px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:14px}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:flex;align-items:center;justify-content:center}.topcard[_ngcontent-%COMP%]{width:100%;height:auto;font-family:Poppins;box-shadow:none;border:1px solid #ccc;border-radius:4px}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin-bottom:20px;margin-right:20px;margin-top:8px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:left;padding:20px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}form[_ngcontent-%COMP%]{padding:10px 20px}.scroll-bar1[_ngcontent-%COMP%]{height:auto;width:calc(100% - 25px);margin-left:25px;margin-bottom:10px;margin-top:50px;overflow:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.pr-form-field[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:6px;border:1px solid #9f9f9f;cursor:pointer;background-color:"Transparent"}.select-form-field[_ngcontent-%COMP%]{padding:10px;width:150px;border:1px solid #9f9f9f;border-radius:20px;cursor:pointer;background-color:"Transparent "!important}.action-btn-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.button-list[_ngcontent-%COMP%]{display:inline-flex;margin:15px 0 20px;float:right;gap:10px}.text-area-section[_ngcontent-%COMP%]{width:100%;height:auto;margin:30px 0 0}.text-area-section[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{display:block;width:100%}.flex-div[_ngcontent-%COMP%]{width:31%}.mat-form-field[_ngcontent-%COMP%]{display:block}.pending[_ngcontent-%COMP%]{padding:8px;width:120px;background-color:#ccc;color:#333;font-size:14px;font-family:Poppins;height:50px;border:none}.main-container[_ngcontent-%COMP%]{margin:10px 20px 0 15px}']}),n})();var Dt=d(8898),F=d(7489);function Qt(n,a){if(1&n&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.Udp("color",i.getRemainingDays(e.expected_delivery_date)>=0?"green":"red"),t.xp6(1),t.hij(" \xa0 ",i.getRemainingDays(e.expected_delivery_date)>=0?i.getRemainingDays(e.expected_delivery_date)+" days left":"Delayed by "+-1*i.getRemainingDays(e.expected_delivery_date)+" days"," ")}}function St(n,a){1&n&&t._UZ(0,"td",47)}const Yt=function(n){return{"background-color":n}},jt=function(n){return["/procurement/update",n]};function Bt(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",39),t._uU(2),t.qZA(),t._UZ(3,"hr",40),t.TgZ(4,"td",41),t._uU(5),t.qZA(),t._UZ(6,"hr",40),t.TgZ(7,"td",42),t._uU(8),t.qZA(),t._UZ(9,"hr",40),t.YNc(10,Qt,2,3,"td",43),t.YNc(11,St,1,0,"td",44),t.TgZ(12,"td",45),t._uU(13," View\xa0details "),t.qZA(),t.TgZ(14,"td",46)(15,"mat-icon"),t._uU(16," arrow_forward_ios "),t.qZA()()()),2&n){const e=a.$implicit,i=t.oxw(2);t.xp6(2),t.hij("Request\xa0no\xa0 ",e.purchase_request_number,""),t.xp6(3),t.hij("Title \xa0 ",e.title,""),t.xp6(3),t.hij("Site \xa0 ",e.siteData.site_name," "),t.xp6(2),t.Q6J("ngIf",void 0!==i.getRemainingDays(e.expected_delivery_date)&&i.getRemainingDays(e.expected_delivery_date)<=2),t.xp6(1),t.Q6J("ngIf",void 0===i.getRemainingDays(e.expected_delivery_date)||i.getRemainingDays(e.expected_delivery_date)>2),t.xp6(1),t.Q6J("ngStyle",t.VKq(7,Yt,"new"==i.requestType?"#233A61":"#1abcfe"))("routerLink",t.VKq(9,jt,e._id))}}function Et(n,a){1&n&&(t.TgZ(0,"div",48),t._UZ(1,"img",49),t.TgZ(2,"span"),t._uU(3," No record found"),t.qZA()())}function $t(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",35)(2,"table",36)(3,"tbody"),t.YNc(4,Bt,17,11,"tr",37),t.qZA()(),t.YNc(5,Et,4,0,"div",38),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.purchaseList),t.xp6(1),t.Q6J("ngIf",!(e.purchaseList&&e.purchaseList.length>0))}}function zt(n,a){1&n&&(t.TgZ(0,"h3",50),t._uU(1,"You don't have permissions to view."),t.qZA())}const Gt=function(){return["/procurement"]},Vt=function(){return["/procurement/prlist"]},Kt=function(){return["/rate-comparative"]},Ht=function(){return["/rate-approval"]},Wt=function(){return["/purchase-order"]},O=function(n){return[n]};let Xt=(()=>{class n{constructor(e,i,r){this.router=e,this.httpService=i,this.snack=r,this.filter_by="status",this.filter_value="pending",this.requestType="new",this.originalPurchaseList=[],this.getList({filter_by:this.filter_by,filter_value:this.filter_value})}getList(e){this.httpService.GET(p.Fj,e).subscribe({next:i=>{this.originalPurchaseList=i.data,this.purchaseList=i.data},error:i=>{if(i.errors&&!(0,F.isEmpty)(i.errors)){let r="<ul>";for(let s in i.errors)r+=`<li>${i.errors[s][0]}</li>`;r+="</ul>",this.snack.notifyHtml(r,2)}else this.snack.notify(i.message,2)}})}getRemainingDays(e){const i=new Date(e),r=new Date;i.setHours(0,0,0,0),r.setHours(0,0,0,0);const s=i.getTime()-r.getTime();return Math.floor(s/864e5)}dateFilter(e){this.originalPurchaseList&&this.originalPurchaseList.length>0&&(this.purchaseList=e.value?this.originalPurchaseList.filter(i=>new Date(i.date)==new Date(e.value)):this.originalPurchaseList)}search(e,i){this.originalPurchaseList&&this.originalPurchaseList.length>0&&(this.purchaseList="site"==i?e.target.value?this.originalPurchaseList.filter(r=>r.siteData.site_name.toLowerCase().includes(e.target.value.toLowerCase())):this.originalPurchaseList:e.target.value?this.originalPurchaseList.filter(r=>r.title.toLowerCase().includes(e.target.value.toLowerCase())):this.originalPurchaseList)}changeRequestType(e){this.requestType=e,"new"==e?(this.filter_value="pending",this.getList({filter_by:this.filter_by,filter_value:this.filter_value})):(this.filter_value="revised",this.getList({filter_by:this.filter_by,filter_value:this.filter_value}))}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:r=>{console.log(r),this.viewPermission=r.dashboard_permissions[0].ParentChildchecklist[19].childList[0].isSelected},error:r=>{console.log(r)}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(b.s),t.Y36(v.o))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-purchase-request-list"]],decls:73,vars:20,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","40px","margin-left","20px"],["src","./assets/images/preq.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","20px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/app.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],["src","./assets/images/rc.svg"],["src","./assets/images/approval.svg"],["src","./assets/images/po.svg"],[2,"display","flex","flex-direction","row","gap","10px"],[2,"margin-left","40px","width","100%","margin-top","30px"],["appearance","outline",1,"searchbar"],["matSuffix",""],["matInput","","type","search","placeholder","search title",1,"search-input",3,"input"],[2,"margin-right","600px","margin-top","30px","display","flex","gap","10px"],[2,"margin-top","15px","color","#94A3B8","margin-left","30px"],["appearance","outline",1,"datebar"],["matInput","","placeholder","Date",3,"matDatepicker","dateChange","click"],["matSuffix","",3,"for"],["startPicker",""],[2,"margin-top","30px","display","flex","position","relative","right","570px","gap","10px"],[2,"margin-top","15px","color","#94A3B8","margin-left","-10px"],["matInput","","placeholder","Site",3,"input"],[2,"margin-top","50px","position","relative","right","520px"],[2,"cursor","pointer",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["noView",""],[1,"scroll-bar1",2,"width","93%"],[2,"direction","ltr !important","margin-top","-20px"],[4,"ngFor","ngForOf"],["class","no-record-found",4,"ngIf"],[2,"color","#4272BF","width","300px","text-align","left","padding","10px"],[2,"border","1px solid #D9D9D9","height","30px"],[2,"color","#4272BF","width","200px"],[2,"color","#4272BF","width","800px","text-align","left","padding","10px"],["style","width:200px;",3,"color",4,"ngIf"],["style","width:200px;",4,"ngIf"],[2,"color","#fff","width","150px","cursor","pointer",3,"ngStyle","routerLink"],[2,"width","100px"],[2,"width","200px"],[1,"no-record-found"],["src","./assets/images/inbox_empty.png","alt",""],[2,"display","flex","justify-content","center","margin-top","2%","font-size","160%","font-weight","bolder","color","grey"]],template:function(e,i){if(1&e){const r=t.EpF();t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Purchase request list"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",13),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",14),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",15),t.qZA(),t.TgZ(33,"span",9),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",10),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",16),t.qZA(),t.TgZ(40,"span",9),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"div",17)(43,"div",18)(44,"mat-form-field",19)(45,"mat-icon",20),t._uU(46,"search"),t.qZA(),t.TgZ(47,"input",21),t.NdJ("input",function(c){return i.search(c,"title")}),t.qZA()()(),t.TgZ(48,"div",22)(49,"div",23)(50,"span"),t._uU(51,"Filter\xa0by"),t.qZA()(),t.TgZ(52,"div")(53,"mat-form-field",24)(54,"input",25),t.NdJ("dateChange",function(c){return i.dateFilter(c)})("click",function(){t.CHM(r);const c=t.MAs(57);return t.KtG(c.open())}),t.qZA(),t._UZ(55,"mat-datepicker-toggle",26)(56,"mat-datepicker",null,27),t.qZA()()(),t.TgZ(58,"div",28)(59,"div",29)(60,"span"),t._uU(61,"Filter\xa0by"),t.qZA()(),t.TgZ(62,"div")(63,"mat-form-field",24)(64,"input",30),t.NdJ("input",function(c){return i.search(c,"site")}),t.qZA()()()(),t.TgZ(65,"div",31)(66,"span",32),t.NdJ("click",function(){return i.changeRequestType("new")}),t._uU(67,"New\xa0request\xa0|"),t.qZA(),t.TgZ(68,"span",32),t.NdJ("click",function(){return i.changeRequestType("revise")}),t._uU(69,"\xa0Revised\xa0request"),t.qZA()()(),t.YNc(70,$t,6,2,"ng-container",33),t.YNc(71,zt,2,0,"ng-template",null,34,t.W1O)}if(2&e){const r=t.MAs(57),s=t.MAs(72);t.xp6(9),t.Q6J("routerLink",t.DdM(11,Gt)),t.xp6(7),t.Q6J("routerLink",t.DdM(12,Vt)),t.xp6(7),t.Q6J("routerLink",t.DdM(13,Kt)),t.xp6(7),t.Q6J("routerLink",t.DdM(14,Ht)),t.xp6(7),t.Q6J("routerLink",t.DdM(15,Wt)),t.xp6(17),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(11),t.Q6J("ngClass",t.VKq(16,O,"new"==i.requestType?"active":"inactive")),t.xp6(2),t.Q6J("ngClass",t.VKq(18,O,"revise"==i.requestType?"active":"inactive")),t.xp6(2),t.Q6J("ngIf",i.viewPermission)("ngIfElse",s)}},dependencies:[f.KE,f.R9,g.Mq,g.hl,g.nW,A.d,R.Hw,y.Nt,T.Ye,h.mk,h.sg,h.O5,h.PC,m.rH,m.Od],styles:[".mat-form-field-appearance-outline .mat-form-field-infix{padding:.6em;width:250px}mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.searchbar[_ngcontent-%COMP%]{width:350px;border-radius:20px;font-family:Poppins}.active[_ngcontent-%COMP%]{color:#233a61}.inactive[_ngcontent-%COMP%]{color:#94a3b8}.datebar[_ngcontent-%COMP%]{width:140px;border-radius:20px;font-family:Poppins}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:separate;border-spacing:0 25px;text-align:left;width:100%;font-size:14px;margin-left:30px;margin-bottom:20px;margin-right:-10px}td[_ngcontent-%COMP%]{border:none;text-align:center;padding:8px 1px;color:#233a61;font-style:normal;font-size:14px}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f4f4f5!important}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f4f4f5!important}.scroll-bar1[_ngcontent-%COMP%]{height:600px;width:93%;margin-left:20px;margin-bottom:100px;margin-top:10px;overflow:auto;direction:rtl;overflow-x:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.no-record-found[_ngcontent-%COMP%]{text-align:center;display:flex;gap:10px;flex-direction:column;align-items:center;justify-content:center}.no-record-found[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:188px}"]}),n})();var J=d(5861);function te(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.site_name," ")}}function ee(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.vendor_name," ")}}function ne(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",20)(1,"label",21),t._uU(2,"Vendor"),t.TgZ(3,"span",22),t._uU(4,"*"),t.qZA()(),t.TgZ(5,"mat-select",48),t.NdJ("selectionChange",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.onVendorSelection(r))}),t.YNc(6,ee,2,2,"mat-option",36),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.vendorList)}}function ie(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.item_name," ")}}function re(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.brand_name," ")}}function oe(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"a",65),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index,s=t.oxw(2);return t.KtG(s.delete(r))}),t._UZ(1,"i",66),t.qZA()}}function ae(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",54)(1,"td",55),t._uU(2),t.qZA(),t.ynx(3,56),t.TgZ(4,"td")(5,"mat-select",57),t.NdJ("selectionChange",function(r){const c=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.selectedItem(r,c))}),t.YNc(6,ie,2,2,"mat-option",36),t.qZA()(),t.TgZ(7,"td",58),t._uU(8),t.qZA(),t.TgZ(9,"td",58),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"input",59),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"input",60),t.qZA(),t.TgZ(17,"td")(18,"mat-select",61),t.YNc(19,re,2,2,"mat-option",36),t.qZA()(),t.TgZ(20,"td"),t._UZ(21,"input",62),t.qZA(),t.TgZ(22,"td")(23,"div",63),t.YNc(24,oe,2,0,"a",64),t.qZA()(),t.BQk(),t.qZA()}if(2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);let s,c,l;t.xp6(2),t.hij(" ",i+1," "),t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Q6J("ngForOf",r.filteredItemList),t.xp6(2),t.hij(" ",null==(s=e.get("category"))?null:s.value," "),t.xp6(2),t.hij(" ",null==(c=e.get("subCategory"))?null:c.value," "),t.xp6(2),t.hij(" ",null==(l=e.get("uom"))?null:l.value," "),t.xp6(7),t.Q6J("ngForOf",r.brandList),t.xp6(5),t.Q6J("ngIf",i>0)}}function se(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",49)(2,"table",50)(3,"tr")(4,"th"),t._uU(5,"S\xa0No"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Item*"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Category"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Sub\xa0category"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Uom*"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Quantity*"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Rate"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Brand Name"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Remarks"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Action"),t.qZA()(),t.TgZ(24,"tbody"),t.YNc(25,ae,25,8,"tr",51),t.qZA()()(),t.TgZ(26,"div",52)(27,"div")(28,"button",53),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addItem())}),t._uU(29," Add Item + "),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(25),t.Q6J("ngForOf",e.purchaseRequestForm.get("items").controls)}}function ce(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.item_name," ")}}function le(n,a){if(1&n&&(t.TgZ(0,"mat-option",47),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.brand_name," ")}}function pe(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"a",65),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index,s=t.oxw(2);return t.KtG(s.delete(r))}),t._UZ(1,"i",66),t.qZA()}}function ue(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",54)(1,"td",55),t._uU(2),t.qZA(),t.ynx(3,56),t.TgZ(4,"td")(5,"mat-select",57),t.NdJ("selectionChange",function(r){const c=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.selectedItem(r,c))}),t.YNc(6,ce,2,2,"mat-option",36),t.qZA()(),t.TgZ(7,"td",58),t._uU(8),t.qZA(),t.TgZ(9,"td",58),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"input",59),t.qZA(),t.TgZ(15,"td")(16,"mat-select",61),t.YNc(17,le,2,2,"mat-option",36),t.qZA()(),t.TgZ(18,"td"),t._UZ(19,"input",62),t.qZA(),t.TgZ(20,"td")(21,"div",63),t.YNc(22,pe,2,0,"a",64),t.qZA()(),t.BQk(),t.qZA()}if(2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);let s,c,l;t.xp6(2),t.hij(" ",i+1," "),t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Q6J("ngForOf",r.itemList),t.xp6(2),t.hij(" ",null==(s=e.get("category"))?null:s.value," "),t.xp6(2),t.hij(" ",null==(c=e.get("subCategory"))?null:c.value," "),t.xp6(2),t.hij(" ",null==(l=e.get("uom"))?null:l.value," "),t.xp6(5),t.Q6J("ngForOf",r.brandList),t.xp6(5),t.Q6J("ngIf",i>0)}}function de(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",49)(1,"table",50)(2,"tr")(3,"th"),t._uU(4,"S\xa0No"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Item*"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sub\xa0category"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Uom*"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Quantity*"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Brand Name"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Remarks"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Action"),t.qZA()(),t.TgZ(21,"tbody"),t.YNc(22,ue,23,8,"tr",51),t.qZA()()(),t.TgZ(23,"div",52)(24,"div")(25,"button",53),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addItem())}),t._uU(26," Add Item + "),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(22),t.Q6J("ngForOf",e.purchaseRequestForm.get("items").controls)}}const _e=function(){return["/procurement"]},me=function(){return["/procurement/prlist"]},ge=function(){return["/rate-comparative"]},he=function(){return["/rate-approval"]},fe=function(){return["/purchase-order"]};let xe=(()=>{class n{constructor(e,i,r,s,c,l){this.router=e,this.route=i,this.httpService=r,this.snack=s,this.formBuilder=c,this.http=l,this.requredByMinDate=new Date,this.load=!1,this.purchaseRequestForm=new o.cw({title:new o.NI("",o.kI.required),date:new o.NI(Z().format("DD-MM-YYYY"),o.kI.required),expected_delivery_date:new o.NI(Z().add(1,"days").format("DD-MM-YYYY"),o.kI.required),purchase_request_number:new o.NI(""),site:new o.NI("",o.kI.required),local_purchase:new o.NI("yes",o.kI.required),remarks:new o.NI(""),items:this.formBuilder.array([]),_id:new o.NI(""),vendor:new o.NI("")})}handleLocalPurchaseChange(){this.purchaseRequestForm.get("items").clear(),this.addItem()}onVendorSelection(e){if(console.log(e),null==e.value)return;const i=this.vendorList.find(r=>r._id===e.value);i?this.filteredItemList=this.itemList.filter(r=>{const s=i.category.some(l=>l===r.category),c=i.SubCategory.some(l=>l===r.sub_category);return s&&c}):(console.warn("No matching vendor found for the selected ID."),this.filteredItemList=[]),e.value!==this.initialVendor.vendor&&(this.purchaseRequestForm.get("items").clear(),this.addItem())}createItemArrayForm(){return new o.cw({item_id:new o.NI("",o.kI.required),rate:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),category:new o.NI(null),subCategory:new o.NI(null),attachment:new o.NI(null),remark:new o.NI(null),uom:new o.NI(null),itemName:new o.NI(null),brandName:new o.NI(null)})}onSubmit(){if(this.load||(console.log(this.purchaseRequestForm),console.log(this.purchaseRequestForm.valid),!this.purchaseRequestForm.valid))return;let e=this.purchaseRequestForm.value;e.date=Z(e.date,"DD-MM-YYYY").toDate(),e.expected_delivery_date=new Date(e.expected_delivery_date),e.status="revised",this.load=!0,this.httpService.PUT(p.Fj,e).subscribe({next:i=>{this.load=!1,this.snack.notify("Record has been updated.",1),this.router.navigate(["/procurement"])},error:i=>{if(this.load=!1,i.errors&&!(0,F.isEmpty)(i.errors)){let r="<ul>";for(let s in i.errors)r+=`<li>${i.errors[s][0]}</li>`;r+="</ul>",this.snack.notifyHtml(r,2)}else this.snack.notify(i.message,2)}})}getList(){var e=this;return(0,J.Z)(function*(){const i=e.http.get(`${_.N.api_path}${p.PE}`),r=e.http.get(`${_.N.api_path}${p.o7}`),s=e.http.get(`${_.N.api_path}${p.S3}`),c=e.http.get(`${_.N.api_path}${p.ds}`),l=e.http.get(`${_.N.api_path}${p.Lk}`);try{const u=yield e.httpService.multipleRequests([i,r,s,c,l],{}).toPromise();u&&(e.uomList=u[0].data,e.itemList=u[1].data,e.siteList=u[2].data,e.vendorList=u[3].data,e.brandList=u[4].data)}catch(u){console.error("Error fetching data:",u)}})()}selectedItem(e,i){let r=this.itemList.filter(l=>l._id==e.value)[0]?.categoryDetail.name,s=this.itemList.filter(l=>l._id==e.value)[0]?.subCategoryDetail.subcategory_name,c=this.itemList.filter(l=>l._id==e.value)[0]?.uomDetail.uom_name;this.items.at(i).patchValue({category:r,subCategory:s,uom:c})}createItem(e){return new o.cw(e?{item_id:new o.NI(e.item_id,o.kI.required),qty:new o.NI(e.qty,o.kI.required),rate:new o.NI(e.rate),category:new o.NI(e.categoryDetail.name),subCategory:new o.NI(e.subCategoryDetail.subcategory_name),attachment:new o.NI(e.attachment),remark:new o.NI(e.remark),uom:new o.NI(e.uomDetail.uom_name),brandName:new o.NI(e.brandName)}:{item_id:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),rate:new o.NI(""),category:new o.NI(""),subCategory:new o.NI(""),attachment:new o.NI,remark:new o.NI(""),uom:new o.NI(""),brandName:new o.NI("")})}delete(e){this.purchaseRequestForm.get("items").removeAt(e)}patchData(e){this.purchaseRequestForm.patchValue({title:e.title,date:e.date,expected_delivery_date:e.expected_delivery_date,purchase_request_number:e.purchase_request_number,site:e.site,local_purchase:e.local_purchase,remarks:e.remarks,_id:e._id,vendor:e.vendor}),e.items&&e.items.length>0&&e.items.map(i=>{this.addItems(i)}),this.purchaseRequestForm.controls.remarks.disable()}addItem(){this.items=this.purchaseRequestForm.get("items"),this.items.push(this.createItem())}addItems(e){this.items=this.purchaseRequestForm.get("items"),e&&this.items.push(this.createItem(e))}ngOnInit(){var e=this;this.route.params.subscribe(i=>{i.id&&this.httpService.GET(`${p.Fj}/detail`,{_id:i.id}).subscribe(function(){var r=(0,J.Z)(function*(s){yield e.getList(),e.initialVendor=s.data[0],e.onVendorSelection({value:e.initialVendor.vendor}),e.patchData(s.data[0])});return function(s){return r.apply(this,arguments)}}())})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(b.s),t.Y36(v.o),t.Y36(o.qu),t.Y36(C.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-revise-purchase-request"]],decls:103,vars:22,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","40px","margin-left","20px"],["src","./assets/images/preq.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/prl.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],["src","./assets/images/rc.svg"],[2,"width","100px","margin-left","10px","margin-top","10px","border","1px dashed"],["src","./assets/images/po.svg"],[3,"formGroup","ngSubmit"],[1,"topcard"],[2,"display","flex","flex-wrap","wrap","gap","40px","width","1000px"],[2,"display","flex","flex-direction","column"],[2,"color","#4272BF","font-size","14px"],[1,"star"],["placeholder","Enter title","formControlName","title",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins"],[2,"display","flex","flex-direction","column","margin-left","100px"],[1,"custom-form-control"],["appearance","outline"],["matInput","","formControlName","date","placeholder","Enter base Line Start Date",3,"matDatepicker","click"],["matSuffix","",3,"for"],["date",""],[1,"custom-form-group"],["for","",1,"custom-label",2,"color","#4272BF","font-size","14px"],["matInput","","formControlName","expected_delivery_date","placeholder","Enter base Line Start Date",3,"matDatepicker","min","click"],["requiredByStartDate",""],["placeholder","Auto generate","formControlName","purchase_request_number","readonly","",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins"],["id","site","placeholder","Select site","formControlName","site",2,"padding","10px","width","200px","border","1px solid #9F9F9F","border-radius","6px","cursor","pointer","margin-top","10px","font-family","Poppins"],[3,"value",4,"ngFor","ngForOf"],[2,"color","#4272BF"],["aria-labelledby","example-radio-group-label","color","primary","formControlName","local_purchase",1,"example-radio-group",3,"change"],[1,"example-radio-button",3,"value"],["style","display: flex;flex-direction: column;",4,"ngIf"],[4,"ngIf","ngIfElse"],["noLocalPurchase",""],[1,"row","text-area-section"],["name","","id","","cols","30","rows","10","formControlName","remarks"],[1,"row","button-list"],[2,"padding","8px","width","auto","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-size","14px","font-family","Poppins"],[3,"value"],["id","site","placeholder","Select Vendor","formControlName","vendor",2,"padding","10px","width","200px","border","1px solid #ccc","border-radius","6px","cursor","pointer","font-family","Poppins",3,"selectionChange"],[1,"scroll-bar1"],[1,"items-table",2,"direction","ltr !important","border-left","2px solid #000 !important"],["style","background-color: #F4F4F5;","formArrayName","items",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","gap","40px","margin-left","38px","margin-bottom","100px","margin-top","100px","top","-50px","position","relative"],[2,"padding","8px","width","120px","background-color","#fff","cursor","pointer","border","0.5px solid #94A3B8","border-radius","5px","font-size","14px","font-family","Poppins",3,"click"],["formArrayName","items",2,"background-color","#F4F4F5"],[2,"text-align","center"],[3,"formGroupName"],["id","itemName","placeholder","Select Item","formControlName","item_id",1,"select-form-field",3,"selectionChange"],[2,"color","#000"],["type","text","placeholder","Enter","digitOnly","","formControlName","qty",1,"pr-form-field"],["type","text","placeholder","Enter","digitOnly","","formControlName","rate",1,"pr-form-field"],["id","brandName","placeholder","Select Brand","formControlName","brandName",1,"select-form-field"],["placeholder","Enter","formControlName","remark",1,"pr-form-field"],[1,"action-btn-wrapper"],["class","action-btn","title","Delete",3,"click",4,"ngIf"],["title","Delete",1,"action-btn",3,"click"],[1,"fa","fa-trash"]],template:function(e,i){if(1&e){const r=t.EpF();t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Revise purchase request "),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",13),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",14),t.qZA(),t.TgZ(26,"span",13),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",12),t.qZA(),t.TgZ(33,"span",13),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",15),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",16),t.qZA(),t.TgZ(40,"span",13),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"form",17),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(43,"mat-card",18)(44,"div",19)(45,"div",20)(46,"label",21),t._uU(47,"Request title "),t.TgZ(48,"span",22),t._uU(49,"*"),t.qZA()(),t._UZ(50,"input",23),t.qZA(),t.TgZ(51,"div",24)(52,"label",21),t._uU(53,"Request date"),t.qZA(),t.TgZ(54,"div",25)(55,"mat-form-field",26)(56,"input",27),t.NdJ("click",function(){t.CHM(r);const c=t.MAs(59);return t.KtG(c.open())}),t.qZA(),t._UZ(57,"mat-datepicker-toggle",28)(58,"mat-datepicker",null,29),t.qZA()()(),t.TgZ(60,"div",30)(61,"label",31),t._uU(62," Required by "),t.TgZ(63,"span",22),t._uU(64,"*"),t.qZA()(),t.TgZ(65,"div",25)(66,"mat-form-field",26)(67,"input",32),t.NdJ("click",function(){t.CHM(r);const c=t.MAs(70);return t.KtG(c.open())}),t.qZA(),t._UZ(68,"mat-datepicker-toggle",28)(69,"mat-datepicker",null,33),t.qZA()()(),t.TgZ(71,"div",20)(72,"label",21),t._uU(73,"Purchase request no "),t.qZA(),t._UZ(74,"input",34),t.qZA(),t.TgZ(75,"div",24)(76,"label",21),t._uU(77,"Site name "),t.TgZ(78,"span",22),t._uU(79,"*"),t.qZA()(),t.TgZ(80,"mat-select",35),t.YNc(81,te,2,2,"mat-option",36),t.qZA()(),t.TgZ(82,"div",24)(83,"label",37),t._uU(84,"Local Purchase "),t.TgZ(85,"span",22),t._uU(86,"*"),t.qZA()(),t.TgZ(87,"mat-radio-group",38),t.NdJ("change",function(){return i.handleLocalPurchaseChange()}),t.TgZ(88,"mat-radio-button",39),t._uU(89," Yes "),t.qZA(),t.TgZ(90,"mat-radio-button",39),t._uU(91," No "),t.qZA()()(),t.YNc(92,ne,7,1,"div",40),t.qZA()(),t.YNc(93,se,30,1,"ng-container",41),t.YNc(94,de,27,1,"ng-template",null,42,t.W1O),t.TgZ(96,"div",43)(97,"label",21),t._uU(98,"Remarks "),t.qZA(),t._UZ(99,"textarea",44),t.qZA(),t.TgZ(100,"div",45)(101,"button",46),t._uU(102,"Update Material Request"),t.qZA()()()}if(2&e){const r=t.MAs(59),s=t.MAs(70),c=t.MAs(95);let l,u;t.xp6(9),t.Q6J("routerLink",t.DdM(17,_e)),t.xp6(7),t.Q6J("routerLink",t.DdM(18,me)),t.xp6(7),t.Q6J("routerLink",t.DdM(19,ge)),t.xp6(7),t.Q6J("routerLink",t.DdM(20,he)),t.xp6(7),t.Q6J("routerLink",t.DdM(21,fe)),t.xp6(5),t.Q6J("formGroup",i.purchaseRequestForm),t.xp6(14),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(10),t.Q6J("matDatepicker",s)("min",i.requredByMinDate),t.xp6(1),t.Q6J("for",s),t.xp6(13),t.Q6J("ngForOf",i.siteList),t.xp6(7),t.Q6J("value","yes"),t.xp6(2),t.Q6J("value","no"),t.xp6(2),t.Q6J("ngIf","yes"===(null==(l=i.purchaseRequestForm.get("local_purchase"))?null:l.value)),t.xp6(1),t.Q6J("ngIf","yes"===(null==(u=i.purchaseRequestForm.get("local_purchase"))?null:u.value))("ngIfElse",c)}},dependencies:[P.ey,f.KE,f.R9,w.a8,g.Mq,g.hl,g.nW,A.d,y.Nt,q.VQ,q.U0,U.gD,T.Ye,h.sg,h.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,o.x0,o.CE,M.L,m.rH,m.Od],styles:['mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.requests[_ngcontent-%COMP%]{height:40px;width:1140px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:14px}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:flex;align-items:center;justify-content:center}.topcard[_ngcontent-%COMP%]{width:1110px;height:auto;margin-left:30px;margin-top:30px;box-shadow:0 2px 12px #00000040;font-family:Poppins}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin:8px 20px 20px 10px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;width:1000px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:left;padding:20px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}.scroll-bar1[_ngcontent-%COMP%]{height:auto;width:auto;margin-left:25px;margin-bottom:100px;margin-top:50px;overflow:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.pr-form-field[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:6px;border:1px solid #9f9f9f;cursor:pointer;background:none}.select-form-field[_ngcontent-%COMP%]{padding:10px;width:150px;border:1px solid #9f9f9f;border-radius:20px;cursor:pointer;background-color:"Transparent "!important}.action-btn-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.text-area-section[_ngcontent-%COMP%]{width:1334px;height:auto;margin-left:30px}.button-list[_ngcontent-%COMP%]{display:inline-flex;margin:15px 30px 20px 0;float:right;gap:10px}']}),n})();function Ze(n,a){if(1&n&&(t.TgZ(0,"mat-option",52),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.site_name," ")}}function qe(n,a){if(1&n&&(t.TgZ(0,"div",53)(1,"label",22),t._uU(2,"Vendor "),t.TgZ(3,"span",31),t._uU(4,"*"),t.qZA()(),t._UZ(5,"input",54),t.qZA()),2&n){const e=t.oxw();t.xp6(5),t.Q6J("readonly",!0)("value",e.selectedVendor)}}function be(n,a){if(1&n&&(t.TgZ(0,"tr",58)(1,"td",59),t._uU(2),t.qZA(),t.ynx(3),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",60),t._uU(7),t.qZA(),t.TgZ(8,"td",60),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td",60),t._uU(13),t.qZA(),t.TgZ(14,"td",60),t._uU(15),t.qZA(),t.TgZ(16,"td",60),t._uU(17),t.qZA(),t.TgZ(18,"td",60),t._uU(19),t.qZA(),t.BQk(),t.qZA()),2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);t.xp6(2),t.hij(" ",i+1," "),t.xp6(3),t.hij(" ",r.getItemName(e.item_id)," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.hij(" ",r.myBrandName(e.brandName)," "),t.xp6(2),t.hij(" ",e.rate," "),t.xp6(2),t.hij(" ",e.remark," ")}}function ve(n,a){if(1&n&&(t.TgZ(0,"div",55)(1,"table",56)(2,"tr")(3,"th"),t._uU(4,"S\xa0No"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Item*"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sub\xa0category"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Uom*"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Quantity*"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Brand Name"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Rate"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Remarks"),t.qZA()(),t.TgZ(21,"tbody"),t.YNc(22,be,20,9,"tr",57),t.qZA()()()),2&n){const e=t.oxw();t.xp6(22),t.Q6J("ngForOf",null==e.details?null:e.details.items)}}function Ae(n,a){if(1&n&&(t.TgZ(0,"tr",58)(1,"td",59),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",60),t._uU(6),t.qZA(),t.TgZ(7,"td",60),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td",60),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA()()),2&n){const e=a.$implicit,i=a.index,r=t.oxw(2);t.xp6(2),t.hij(" ",i+1," "),t.xp6(2),t.hij(" ",r.getItemName(e.item_id)," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.hij(" ",r.myBrandName(e.brandName)," "),t.xp6(2),t.hij(" ",e.remark," ")}}function ye(n,a){if(1&n&&(t.TgZ(0,"div",55)(1,"table",56)(2,"tr")(3,"th"),t._uU(4,"S\xa0No"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Item*"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sub\xa0category"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Uom*"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Quantity*"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Brand Name"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Remarks"),t.qZA()(),t.TgZ(19,"tbody"),t.YNc(20,Ae,17,8,"tr",57),t.qZA()()()),2&n){const e=t.oxw();t.xp6(20),t.Q6J("ngForOf",null==e.details?null:e.details.items)}}function Te(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",61),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.updateRequest("approved"))}),t._uU(2," Approve "),t.qZA(),t.BQk()}}function Ce(n,a){1&n&&(t.TgZ(0,"button",62),t._uU(1," No Permission to Approve\n"),t.qZA())}function Pe(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",63),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.updateRequest("rejected"))}),t._uU(2," Rejected "),t.qZA(),t.BQk()}}function we(n,a){1&n&&(t.TgZ(0,"button",64),t._uU(1," No Permission To Reject "),t.qZA())}function Ue(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",63),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.updateRequest("revise"))}),t._uU(2," Revise Request "),t.qZA(),t.BQk()}}function ke(n,a){1&n&&(t.TgZ(0,"button",64),t._uU(1," No Permission To Revise Request "),t.qZA())}const Ne=function(){return["/procurement"]},Ie=function(){return["/procurement/prlist"]},Re=function(){return["/rate-comparative"]},Me=function(){return["/rate-approval"]},Le=function(){return["/purchase-order"]},Fe=[{path:"",component:At},{path:"prlist",component:Xt},{path:"details/:id",component:Jt},{path:"update/:id",component:(()=>{class n{constructor(e,i,r,s,c,l){this.router=e,this.httpService=i,this.snack=r,this.formBuilder=s,this.route=c,this.http=l,this.load=!1,this.purchaseRequestForm=new o.cw({title:new o.NI("",o.kI.required),date:new o.NI("",o.kI.required),expected_delivery_date:new o.NI("",o.kI.required),purchase_request_number:new o.NI(""),site:new o.NI({value:"",disabled:!0},o.kI.required),local_purchase:new o.NI({value:"",disabled:!0},o.kI.required),remarks:new o.NI(""),items:this.formBuilder.array([]),_id:new o.NI}),this.details={},this.getList()}getList(){const e=this.http.get(`${_.N.api_path}${p.PE}`),i=this.http.get(`${_.N.api_path}${p.o7}`),r=this.http.get(`${_.N.api_path}${p.S3}`),s=this.http.get(`${_.N.api_path}${p.Lk}`);this.httpService.multipleRequests([e,i,r,s],{}).subscribe(c=>{c&&(this.uomList=c[0].data,this.itemList=c[1].data,this.siteList=c[2].data,this.brandList=c[3].data)})}patchData(e){this.purchaseRequestForm.patchValue({title:e.title,date:e.date,expected_delivery_date:e.expected_delivery_date,purchase_request_number:e.purchase_request_number,site:e.site,local_purchase:e.local_purchase,remarks:e.remarks})}createItemArrayForm(){return new o.cw({item_id:new o.NI("",o.kI.required),qty:new o.NI("",o.kI.required),category:new o.NI(""),subCategory:new o.NI(""),attachment:new o.NI(""),remark:new o.NI("",o.kI.required),uom:new o.NI("",o.kI.required),brandName:new o.NI("",o.kI.required)})}addItems(e){this.items=this.purchaseRequestForm.get("items"),e&&this.items.push(this.createItem(e))}createItem(e){if(e)return new o.cw({item_id:new o.NI(e.item_id,o.kI.required),qty:new o.NI(e.qty,o.kI.required),category:new o.NI(e.categoryDetail.name),subCategory:new o.NI(e.subCategoryDetail.subcategory_name),attachment:new o.NI(e.attachment),remark:new o.NI(e.remark,o.kI.required),uom:new o.NI(e.uomDetail._id,o.kI.required),brandName:new o.NI(e.brandName,o.kI.required)})}myBrandName(e){return null==this.brandList?void 0:this.brandList.filter(r=>r._id==e)[0].brand_name}getSiteList(){this.httpService.GET(p.S3,{}).subscribe(e=>{this.siteList=e})}getItemName(e){if(this.itemList&&e)return this.itemList.filter(i=>i._id==e)[0].item_name}updateRequest(e){console.log("meaafsdfs",this.details._id,this.purchaseRequestForm.value.remarks,e),this.httpService.PUT(p.Fj,{_id:this.details._id,status:e,remarks:this.purchaseRequestForm.value.remarks}).subscribe(i=>{this.router.navigate(["/procurement/prlist"])})}getVendorList(){if(null!=this.details.vendor){const e=this.http.get(`${_.N.api_path}${p.Iy}?_id=${this.details.vendor}`);console.log("this is res : "),this.httpService.multipleRequests(e,{}).subscribe(i=>{i&&(this.selectedVendor=i[0].data[0].vendor_name)})}}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:r=>{console.log(r),this.viewPermission=r.dashboard_permissions[0].ParentChildchecklist[19].childList[0].isSelected,this.addPermission=r.dashboard_permissions[0].ParentChildchecklist[19].childList[1].isSelected,this.editPermission=r.dashboard_permissions[0].ParentChildchecklist[19].childList[2].isSelected,this.deletePermission=r.dashboard_permissions[0].ParentChildchecklist[19].childList[3].isSelected},error:r=>{console.log(r)}}),this.route.params.subscribe(r=>{r.id&&this.httpService.GET(`${p.Fj}/detail`,{_id:r.id}).subscribe({next:s=>{this.details=s.data[0],this.getVendorList(),this.patchData(s.data[0])},error:s=>{this.router.navigate(["/procurement/prlist"])}})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(b.s),t.Y36(v.o),t.Y36(o.qu),t.Y36(m.gz),t.Y36(C.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-update-pr-status"]],decls:107,vars:30,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","40px","margin-left","20px"],["src","./assets/images/approval.svg","height","45px"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/app.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],["src","./assets/images/rc.svg"],["src","./assets/images/approval.svg"],[2,"width","100px","margin-left","10px","margin-top","10px","border","1px dashed"],["src","./assets/images/po.svg"],[3,"formGroup"],[1,"topcard"],[2,"display","flex","flex-wrap","wrap","gap","40px","width","1000px"],[2,"display","flex","flex-direction","column"],[2,"color","#4272BF","font-size","14px"],["placeholder","Enter title","formControlName","title",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins",3,"readonly"],[2,"display","flex","flex-direction","column","margin-left","100px"],["appearance","outline"],["matInput","","formControlName","date","placeholder","Auto generate Request Date",3,"matDatepicker","readonly"],["matSuffix","",3,"for"],["date",""],[1,"custom-form-group"],["for","",1,"custom-label",2,"color","#4272BF","font-size","14px"],[1,"star"],[1,"custom-form-control"],["matInput","","formControlName","expected_delivery_date","placeholder","Enter Required by",3,"matDatepicker","readonly"],["requiredByStartDate",""],["placeholder","Auto generate","formControlName","purchase_request_number","readonly","",2,"width","200px","padding","10px","border-radius","6px","border","1px solid #9F9F9F","cursor","pointer","margin-top","10px","font-family","Poppins"],["id","site","placeholder","Select site","formControlName","site",2,"padding","10px","width","200px","border","1px solid #9F9F9F","border-radius","6px","cursor","pointer","margin-top","10px","font-family","Poppins"],[3,"value",4,"ngFor","ngForOf"],["class","flex-div","style","display: flex; flex-direction: column;",4,"ngIf"],[1,"flex-div",2,"display","flex","flex-direction","column","margin","auto"],[2,"color","#4272BF"],["aria-labelledby","example-radio-group-label","color","primary","formControlName","local_purchase",1,"example-radio-group"],[1,"example-radio-button",3,"value"],["class","scroll-bar1",4,"ngIf","ngIfElse"],["noLocalPurchase",""],[1,"row","text-area-section"],["name","","id","","cols","30","rows","10","formControlName","remarks"],[1,"row","button-list"],[4,"ngIf","ngIfElse"],["noAddPermission",""],["noDeletePermission",""],["noEditPermission",""],[3,"value"],[1,"flex-div",2,"display","flex","flex-direction","column"],["placeholder","Enter Vendor",2,"padding","10px","width","75%","border","1px solid #ccc","border-radius","6px","cursor","pointer","font-family","Poppins",3,"readonly","value"],[1,"scroll-bar1"],[2,"direction","ltr !important","border-left","2px solid #000 !important"],["style","background-color: #F4F4F5;",4,"ngFor","ngForOf"],[2,"background-color","#F4F4F5"],[2,"text-align","center"],[2,"color","#000"],[2,"padding","8px","width","120px","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-size","14px","font-family","Poppins",3,"click"],["disabled","",2,"padding","8px","width","120px","background-color","#233A61","color","#fff","border-radius","5px","border-color","lightgrey","font-size","14px","font-family","Poppins"],[2,"padding","8px","width","120px","background-color","#fff","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-size","14px","font-family","Poppins",3,"click"],["disabled","",2,"padding","8px","width","120px","background-color","#fff","color","#233A61","border","1px solid #94A3B8","border-radius","5px","font-size","14px","font-family","Poppins"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Requisition Approvals"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",13),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",14),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",15),t.qZA(),t.TgZ(33,"span",9),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",16),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",17),t.qZA(),t.TgZ(40,"span",9),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.TgZ(42,"form",18)(43,"mat-card",19)(44,"div",20)(45,"div",21)(46,"label",22),t._uU(47,"Request title "),t.qZA(),t._UZ(48,"input",23),t.qZA(),t.TgZ(49,"div",24)(50,"label",22),t._uU(51,"Request date"),t.qZA(),t.TgZ(52,"mat-form-field",25),t._UZ(53,"input",26)(54,"mat-datepicker-toggle",27)(55,"mat-datepicker",null,28),t.qZA()(),t.TgZ(57,"div",29)(58,"label",30),t._uU(59," Required by "),t.TgZ(60,"span",31),t._uU(61,"*"),t.qZA()(),t.TgZ(62,"div",32)(63,"mat-form-field",25),t._UZ(64,"input",33)(65,"mat-datepicker-toggle",27)(66,"mat-datepicker",null,34),t.qZA()()(),t.TgZ(68,"div",21)(69,"label",22),t._uU(70,"Purchase request no "),t.qZA(),t._UZ(71,"input",35),t.qZA(),t.TgZ(72,"div",24)(73,"label",22),t._uU(74,"Site name "),t.TgZ(75,"span",31),t._uU(76,"*"),t.qZA()(),t.TgZ(77,"mat-select",36),t.YNc(78,Ze,2,2,"mat-option",37),t.qZA()(),t.YNc(79,qe,6,2,"div",38),t.TgZ(80,"div",39)(81,"label",40),t._uU(82,"Local Purchase "),t.TgZ(83,"span",31),t._uU(84,"*"),t.qZA()(),t.TgZ(85,"mat-radio-group",41)(86,"mat-radio-button",42),t._uU(87," Yes "),t.qZA(),t.TgZ(88,"mat-radio-button",42),t._uU(89," No "),t.qZA()()()()(),t.YNc(90,ve,23,1,"div",43),t.YNc(91,ye,21,1,"ng-template",null,44,t.W1O),t.TgZ(93,"div",45)(94,"label",22),t._uU(95,"Remarks "),t.qZA(),t._UZ(96,"textarea",46),t.qZA()(),t.TgZ(97,"div",47),t.YNc(98,Te,3,0,"ng-container",48),t.YNc(99,Ce,2,0,"ng-template",null,49,t.W1O),t.YNc(101,Pe,3,0,"ng-container",48),t.YNc(102,we,2,0,"ng-template",null,50,t.W1O),t.YNc(104,Ue,3,0,"ng-container",48),t.YNc(105,ke,2,0,"ng-template",null,51,t.W1O),t.qZA()),2&e){const r=t.MAs(56),s=t.MAs(67),c=t.MAs(92),l=t.MAs(100),u=t.MAs(103),x=t.MAs(106);t.xp6(9),t.Q6J("routerLink",t.DdM(25,Ne)),t.xp6(7),t.Q6J("routerLink",t.DdM(26,Ie)),t.xp6(7),t.Q6J("routerLink",t.DdM(27,Re)),t.xp6(7),t.Q6J("routerLink",t.DdM(28,Me)),t.xp6(7),t.Q6J("routerLink",t.DdM(29,Le)),t.xp6(5),t.Q6J("formGroup",i.purchaseRequestForm),t.xp6(6),t.Q6J("readonly",!0),t.xp6(5),t.Q6J("matDatepicker",r)("readonly",!0),t.xp6(1),t.Q6J("for",r),t.xp6(10),t.Q6J("matDatepicker",s)("readonly",!0),t.xp6(1),t.Q6J("for",s),t.xp6(13),t.Q6J("ngForOf",i.siteList),t.xp6(1),t.Q6J("ngIf","yes"==(null==i.details?null:i.details.local_purchase)),t.xp6(7),t.Q6J("value","yes"),t.xp6(2),t.Q6J("value","no"),t.xp6(2),t.Q6J("ngIf","yes"==(null==i.details?null:i.details.local_purchase))("ngIfElse",c),t.xp6(8),t.Q6J("ngIf",i.addPermission||i.editPermission)("ngIfElse",l),t.xp6(3),t.Q6J("ngIf",i.deletePermission)("ngIfElse",u),t.xp6(3),t.Q6J("ngIf",i.editPermission)("ngIfElse",x)}},dependencies:[P.ey,f.KE,f.R9,w.a8,g.Mq,g.hl,g.nW,A.d,y.Nt,q.VQ,q.U0,U.gD,T.Ye,h.sg,h.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,m.rH,m.Od],styles:['mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.flex-div[_ngcontent-%COMP%]{width:31%}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.requests[_ngcontent-%COMP%]{height:40px;width:1140px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:14px}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:flex;align-items:center;justify-content:center}.topcard[_ngcontent-%COMP%]{width:1110px;height:auto;margin-left:30px;margin-top:30px;box-shadow:0 2px 12px #00000040;font-family:Poppins}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin:8px 20px 20px 10px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;width:1000px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:left;padding:20px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}.scroll-bar1[_ngcontent-%COMP%]{height:auto;width:auto;margin-left:25px;margin-bottom:100px;margin-top:50px;overflow:auto}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.pr-form-field[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:6px;border:1px solid #9f9f9f;cursor:pointer;background-color:"Transparent"}.select-form-field[_ngcontent-%COMP%]{padding:10px;width:150px;border:1px solid #9f9f9f;border-radius:20px;cursor:pointer;background-color:"Transparent "!important}.action-btn-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.button-list[_ngcontent-%COMP%]{display:inline-flex;margin:15px 30px 20px 0;float:right;gap:10px}.text-area-section[_ngcontent-%COMP%]{width:95%;height:auto;margin-left:30px}']}),n})()},{path:"revise/:id",component:xe}];let Oe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Dt.S,h.ez,o.UX,D.Z,[m.Bz.forChild(Fe)]]}),n})()}}]);