"use strict";(self.webpackChunkpra=self.webpackChunkpra||[]).push([[40],{4040:(Wt,y,l)=>{l.r(y),l.d(y,{RateApprovalModule:()=>Gt});var u=l(6895),r=l(4006),m=l(8608),q=l(7489),J=l(5439),b=l(2340),t=l(4650),A=l(2126),C=l(6104),U=l(529),f=l(9299),w=l(3238),Z=l(9549),h=l(9602),k=l(4850),R=l(7392),P=l(4144),M=l(4385),L=l(3683);function V(n,a){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.label)}}const O=function(n){return["/rate-approval/update",n]};function Y(n,a){if(1&n&&(t.TgZ(0,"td",52),t._uU(1,"Approve \xa0Rates"),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,O,e._id))}}const I=function(n){return["/rate-comparative/details",n]};function D(n,a){if(1&n&&(t.TgZ(0,"td",53),t._uU(1,"Approved Vendors"),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,I,e._id))}}function S(n,a){if(1&n&&(t.TgZ(0,"td",54),t._uU(1,"Rejected Rates"),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,I,e._id))}}function F(n,a){if(1&n&&(t.TgZ(0,"td",56),t._uU(1,"Revise \xa0Rates"),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(1,O,e._id))}}function j(n,a){if(1&n&&(t.ynx(0),t.YNc(1,F,2,3,"td",55),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","revise"==e.status)}}function B(n,a){1&n&&(t.TgZ(0,"td",58),t._uU(1,"No Permission To Revise Rates"),t.qZA())}function z(n,a){if(1&n&&t.YNc(0,B,2,0,"td",57),2&n){const e=t.oxw().$implicit;t.Q6J("ngIf","revise"==e.status)}}function E(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",41),t._uU(2,"Request\xa0no\xa0 "),t.TgZ(3,"span",42),t._uU(4),t.qZA()(),t._UZ(5,"hr",43),t.TgZ(6,"td",44),t._uU(7),t.qZA(),t._UZ(8,"hr",43),t.TgZ(9,"td",45),t._uU(10,"Title\xa0"),t.TgZ(11,"span",42),t._uU(12),t.qZA()(),t._UZ(13,"hr",43),t.TgZ(14,"td",46),t._uU(15," Site\xa0"),t.TgZ(16,"span",42),t._uU(17),t.qZA()(),t.YNc(18,Y,2,3,"td",47),t.YNc(19,D,2,3,"td",48),t.YNc(20,S,2,3,"td",49),t.YNc(21,j,2,1,"ng-container",17),t.YNc(22,z,1,1,"ng-template",null,50,t.W1O),t.TgZ(24,"td",51)(25,"mat-icon"),t._uU(26," arrow_forward_ios "),t.qZA()()()),2&n){const e=a.$implicit,o=t.MAs(23),i=t.oxw(2);t.xp6(4),t.Oqu(i.reqNo(e.purchase_request_id)),t.xp6(3),t.hij("Requested on: ",e.date,""),t.xp6(5),t.Oqu(e.title),t.xp6(5),t.Oqu(e.siteData.site_name),t.xp6(1),t.Q6J("ngIf","pending"==e.status),t.xp6(1),t.Q6J("ngIf","approved"==e.status),t.xp6(1),t.Q6J("ngIf","rejected"==e.status),t.xp6(1),t.Q6J("ngIf",i.editPermission)("ngIfElse",o)}}function $(n,a){1&n&&(t.TgZ(0,"div",59),t._UZ(1,"img",60),t.TgZ(2,"span"),t._uU(3," No record found"),t.qZA()())}function G(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",19)(2,"div",20)(3,"mat-form-field",21)(4,"mat-icon",22),t._uU(5,"search"),t.qZA(),t.TgZ(6,"input",23),t.NdJ("input",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.search(i,"title"))}),t.qZA()()(),t.TgZ(7,"div",24)(8,"div",25)(9,"span"),t._uU(10,"Filter\xa0by"),t.qZA()(),t.TgZ(11,"div")(12,"mat-form-field",26)(13,"input",27),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(16);return t.KtG(i.open())})("dateChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.dateFilter(i))}),t.qZA(),t._UZ(14,"mat-datepicker-toggle",28)(15,"mat-datepicker",null,29),t.qZA()()(),t.TgZ(17,"div",24)(18,"div",30)(19,"span"),t._uU(20,"Filter\xa0by"),t.qZA()(),t.TgZ(21,"div")(22,"mat-form-field",26)(23,"input",31),t.NdJ("input",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.search(i,"site"))}),t.qZA()()()(),t.TgZ(24,"div",24)(25,"div",30)(26,"span"),t._uU(27,"Filter by Status"),t.qZA()(),t.TgZ(28,"div",32)(29,"mat-form-field",33)(30,"mat-select",34),t.NdJ("selectionChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.onStatusChange(i))}),t.YNc(31,V,2,2,"mat-option",35),t.qZA()()()()(),t.TgZ(32,"div",36)(33,"table",37)(34,"tbody"),t.YNc(35,E,27,9,"tr",38),t.qZA()(),t.YNc(36,$,4,0,"div",39),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(16),o=t.oxw();t.xp6(13),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(16),t.Q6J("formControl",o.statusOption),t.xp6(1),t.Q6J("ngForOf",o.statusList),t.xp6(4),t.Q6J("ngForOf",o.rateComparativeList),t.xp6(1),t.Q6J("ngIf",!(o.rateComparativeList&&o.rateComparativeList.length>0))}}function K(n,a){1&n&&(t.TgZ(0,"h3",61),t._uU(1,"You don't have permissions to view."),t.qZA())}const H=function(){return["/procurement"]},W=function(){return["/procurement/prlist"]},X=function(){return["/rate-comparative"]},tt=function(){return["/rate-approval"]},et=function(){return["/purchase-order"]};let nt=(()=>{class n{constructor(e,o,i){this.httpService=e,this.snack=o,this.http=i,this.statusOption=new r.NI("pending"),this.statusList=[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"},{value:"revise",label:"Revise"}],this.filter_by="status",this.filter_value="pending",this.requestType="new",this.originalRateComparativeList=[],this.purchaseList=[],this.getList({filter_by:this.filter_by,filter_value:this.filter_value,stage:"rate_approval"})}getList(e){this.httpService.GET(m.lu,e).subscribe({next:o=>{if(console.log(o.data),o.data.forEach(i=>{i.date=J(i.date).format("YYYY-MM-DD")}),"superadmin"===this.permissions.user.role)this.originalRateComparativeList=o.data,this.rateComparativeList=o.data;else{const s=o.data.filter(p=>this.siteList.some(d=>d._id===p.site));console.log(s),this.originalRateComparativeList=s,this.rateComparativeList=s}},error:o=>{if(o.errors&&!(0,q.isEmpty)(o.errors)){let i="<ul>";for(let s in o.errors)i+=`<li>${o.errors[s][0]}</li>`;i+="</ul>",this.snack.notifyHtml(i,2)}else this.snack.notify(o.message,2)}})}onStatusChange(e){this.getList({filter_by:this.filter_by,filter_value:e.value,stage:"rate_approval"})}dateFilter(e){this.originalRateComparativeList&&this.originalRateComparativeList.length>0&&(this.rateComparativeList=e.value?this.originalRateComparativeList.filter(o=>new Date(o.date)==new Date(e.value)):this.originalRateComparativeList)}search(e,o){this.originalRateComparativeList&&this.originalRateComparativeList.length>0&&(this.rateComparativeList="site"==o?e.target.value?this.originalRateComparativeList.filter(i=>i.siteData.site_name.toLowerCase().includes(e.target.value.toLowerCase())):this.originalRateComparativeList:e.target.value?this.originalRateComparativeList.filter(i=>i.title.toLowerCase().includes(e.target.value.toLowerCase())):this.originalRateComparativeList)}getReqNO(){const e=this.http.get(`${b.N.api_path}${m.Fj}`);this.httpService.multipleRequests([e],{}).subscribe(o=>{o&&(this.purchaseList=o[0].data)})}reqNo(e){return this.purchaseList.filter(i=>i._id===e)[0].purchase_request_number}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:i=>{console.log(i),this.viewPermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[0].isSelected,this.editPermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[2].isSelected},error:i=>{console.log(i)}}),this.getReqNO(),this.siteList=this.permissions.user.sites,console.log("SiteSelect",this.siteList)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.s),t.Y36(C.o),t.Y36(U.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-rate-approval-list"]],decls:45,vars:12,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","50px","margin-left","20px"],["src","./assets/images/ratehead.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],["src","./assets/images/rc.svg"],["src","./assets/images/app.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],["src","./assets/images/po.svg"],[4,"ngIf","ngIfElse"],["noView",""],[2,"display","flex","flex-direction","row","gap","10px"],[2,"margin-left","40px","width","20%","margin-top","30px"],["appearance","outline",1,"searchbar"],["matSuffix",""],["matInput","","type","search","placeholder","search title",1,"search-input",3,"input"],[2,"margin-top","30px","display","flex","gap","10px"],[2,"margin-top","15px","color","#94A3B8","margin-left","40px"],["appearance","outline",1,"datebar"],["matInput","","placeholder","Date",3,"matDatepicker","click","dateChange"],["matSuffix","",3,"for"],["startPicker",""],[2,"margin-top","15px","color","#94A3B8"],["matInput","","placeholder","Site",3,"input"],[1,"custom-form-control",2,"width","50%"],["appearance","outline",2,"width","100%"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"scroll-bar1",2,"width","95%"],[2,"direction","ltr !important","margin-top","-20px"],[4,"ngFor","ngForOf"],["class","no-record-found",4,"ngIf"],[3,"value"],[2,"color","#4272BF","width","250px","text-align","left","padding","10px","font-size","15px"],[2,"color","#000000"],[2,"border","1px solid #D9D9D9","height","30px"],[2,"color","#4272BF","width","500px"],[2,"color","#4272BF","width","300px","font-size","15px"],[2,"color","#4272BF","width","700px","text-align","left","padding","10px","font-size","15px"],["style","background-color: #233A61;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["style","background-color: #54AA52;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["style","background-color: #C7323B;color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],["noEditPermission",""],[2,"width","100px"],[2,"background-color","#233A61","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],[2,"background-color","#54AA52","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],[2,"background-color","#C7323B","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],["style","background-color:rgb(26, 188, 254);color:#fff;width:200px;font-size: 14px;cursor: pointer;",3,"routerLink",4,"ngIf"],[2,"background-color","rgb(26, 188, 254)","color","#fff","width","200px","font-size","14px","cursor","pointer",3,"routerLink"],["style","background-color:rgb(26, 188, 254);color:#fff;width:200px;font-size: 14px;cursor: pointer;","disabled","",4,"ngIf"],["disabled","",2,"background-color","rgb(26, 188, 254)","color","#fff","width","200px","font-size","14px","cursor","pointer"],[1,"no-record-found"],["src","./assets/images/inbox_empty.png","alt",""],[2,"display","flex","justify-content","center","margin-top","2%","font-size","160%","font-weight","bolder","color","grey"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Rate Approval"),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"span",9),t._uU(13,"Purchase\xa0request"),t.qZA(),t.TgZ(14,"div"),t._UZ(15,"mat-divider",10),t.qZA()(),t.TgZ(16,"div",11)(17,"div"),t._UZ(18,"img",12),t.qZA(),t.TgZ(19,"span",9),t._uU(20,"Approvals"),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"mat-divider",10),t.qZA()(),t.TgZ(23,"div",11)(24,"div"),t._UZ(25,"img",13),t.qZA(),t.TgZ(26,"span",9),t._uU(27,"Rate\xa0Comparative"),t.qZA(),t.TgZ(28,"div"),t._UZ(29,"mat-divider",10),t.qZA()(),t.TgZ(30,"div",11)(31,"div"),t._UZ(32,"img",14),t.qZA(),t.TgZ(33,"span",15),t._uU(34,"Rate\xa0Approvals"),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"mat-divider",10),t.qZA()(),t.TgZ(37,"div",11)(38,"div"),t._UZ(39,"img",16),t.qZA(),t.TgZ(40,"span",9),t._uU(41,"Purchase\xa0orders"),t.qZA()()(),t.YNc(42,G,37,6,"ng-container",17),t.YNc(43,K,2,0,"ng-template",null,18,t.W1O)),2&e){const i=t.MAs(44);t.xp6(9),t.Q6J("routerLink",t.DdM(7,H)),t.xp6(7),t.Q6J("routerLink",t.DdM(8,W)),t.xp6(7),t.Q6J("routerLink",t.DdM(9,X)),t.xp6(7),t.Q6J("routerLink",t.DdM(10,tt)),t.xp6(7),t.Q6J("routerLink",t.DdM(11,et)),t.xp6(5),t.Q6J("ngIf",o.viewPermission)("ngIfElse",i)}},dependencies:[u.sg,u.O5,f.rH,f.Od,w.ey,Z.KE,Z.R9,h.Mq,h.hl,h.nW,k.d,R.Hw,P.Nt,M.gD,L.Ye,r.JJ,r.oH],styles:[".mat-form-field-appearance-outline .mat-form-field-infix{padding:.6em;width:250px}mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}input[type=text][_ngcontent-%COMP%]{width:60%;border-radius:8px;padding:12px 20px;margin:8px 0;box-sizing:border-box;border:.5px solid #94A3B8;transition:.5s;outline:none;font-family:Poppins;font-size:15px}.requests[_ngcontent-%COMP%]{height:40px;width:1120px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:15px}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:15px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:15px;display:flex;align-items:center;justify-content:center}.searchbar[_ngcontent-%COMP%]{width:100%;border-radius:20px;font-family:Poppins}.datebar[_ngcontent-%COMP%]{width:180px;border-radius:20px;font-family:Poppins}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:separate;border-spacing:0 25px;text-align:left;width:100%;font-size:12px;margin-left:30px;margin-bottom:20px;margin-right:-10px}td[_ngcontent-%COMP%]{border:none;text-align:center;padding:8px 1px;color:#233a61;font-style:normal;font-size:medium}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f4f4f5!important}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f4f4f5!important}.scroll-bar1[_ngcontent-%COMP%]{height:600px;width:93%;margin-left:20px;margin-bottom:100px;margin-top:10px;overflow:auto;direction:rtl;overflow-x:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1E293B;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.no-record-found[_ngcontent-%COMP%]{text-align:center;display:flex;gap:10px;flex-direction:column;align-items:center;justify-content:center}.no-record-found[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:188px}"]}),n})();var v=l(5938);function ot(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19)(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"input",20),t.NdJ("change",function(){const s=t.CHM(e).ngIf,p=t.oxw(2),d=p.index,c=p.$implicit,g=t.oxw().index,x=t.oxw();return t.KtG(x.handleCheckboxChange(g,d,c,s))}),t.qZA()()()()}if(2&n){const e=a.ngIf,o=t.oxw(2),i=o.index,s=o.$implicit,p=t.oxw().index,d=t.oxw();t.xp6(3),t.Oqu(e.vendor_name),t.xp6(2),t.Q6J("checked",d.VendorRate.has(p+"$"+i))("disabled",d.check(s,d.item,d.totalQuantity)&&!d.VendorRate.has(p+"$"+i))}}function it(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div"),t.YNc(2,ot,6,3,"div",13),t.TgZ(3,"div",14)(4,"div",15),t._uU(5,"Rate"),t.qZA(),t.TgZ(6,"div",16),t._uU(7),t.qZA()(),t.TgZ(8,"div",14)(9,"div",15),t._uU(10,"Qty"),t.qZA(),t.TgZ(11,"div",16),t._uU(12),t.qZA()(),t.TgZ(13,"div",14)(14,"div",15),t._uU(15,"Subtotal"),t.qZA(),t.TgZ(16,"div",16),t._uU(17),t.ALo(18,"number"),t.qZA()(),t.TgZ(19,"div",14)(20,"div",15),t._uU(21,"Freight"),t.qZA(),t.TgZ(22,"div",16),t._uU(23),t.ALo(24,"number"),t.qZA()(),t.TgZ(25,"div",14)(26,"div",15),t._uU(27,"GST Amount"),t.qZA(),t.TgZ(28,"div",16),t._uU(29),t.ALo(30,"number"),t.qZA()(),t.TgZ(31,"div",17)(32,"div",15)(33,"strong"),t._uU(34,"Grand total"),t.qZA()(),t.TgZ(35,"div",16),t._uU(36),t.ALo(37,"number"),t.qZA()()(),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Q6J("ngIf",i.findVendor(o.Vendor)),t.xp6(5),t.hij(" ",e.Rate," "),t.xp6(5),t.hij(" ",e.RequiredQuantity," "),t.xp6(5),t.hij(" ",t.xi3(18,7,e.SubTotalAmount,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(24,10,e.Freight,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(30,13,e.Total-e.SubTotalAmount-e.Freight,"1.2-2")," "),t.xp6(7),t.hij(" ",t.xi3(37,16,e.Total,"1.2-2")," ")}}function at(n,a){if(1&n&&(t.ynx(0),t.YNc(1,it,38,19,"ng-container",12),t.BQk()),2&n){const e=a.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.item.item_id==o.item.item_id)}}function rt(n,a){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,at,2,1,"ng-container",8),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngForOf",e.items)}}let st=(()=>{class n{constructor(e,o,i,s,p,d){this.formBuilder=e,this.snack=o,this.request=i,this.dialog=s,this.dialogRef=p,this.data=d,this.totalQuantity=0,this.VendorRate=new Map,this.selected=!1,this.item=d.item,this.vendorItems=d.vendorItems,this.fetchedVendorList=d.fetchedVendorList,this.pageData=d.pageData,console.log(this.pageData),this.pageData&&this.pageData.VendorRate&&this.pageData.totalQuantity&&(this.pageData.VendorRate.forEach((c,g)=>{this.VendorRate.set(g,c)}),this.totalQuantity=Number(this.pageData.totalQuantity))}onNoClick(){this.dialogRef.close({option:2,data:this.data})}onYesClick(){let e=[];this.VendorRate.forEach((o,i)=>{e.push(o)}),this.dialogRef.close({option:1,data:{VendorRate:this.VendorRate,totalQuantity:this.totalQuantity}})}handleCheckboxChange(e,o,i,s){let p=e+"$"+o;this.VendorRate.has(p)?this.deleteVendor(p,i,s):this.addVendor(p,i,s)}addVendor(e,o,i){console.log(o),this.totalQuantity+=Number(o.RequiredQuantity),o.vendor=i,this.VendorRate.set(e,o)}deleteVendor(e,o,i){this.totalQuantity-=o.RequiredQuantity,this.VendorRate.delete(e)}check(e,o,i){return console.log(o.qty),console.log(i),i+Number(e.RequiredQuantity)>o.qty}findVendor(e){return this.fetchedVendorList.find(o=>o._id==e)}onClickSubmit(){this.onYesClick()}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.qu),t.Y36(C.o),t.Y36(A.s),t.Y36(v.uw),t.Y36(v.so),t.Y36(v.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-vendor-rate-listing"]],decls:21,vars:4,consts:[["mat-dialog-title","",1,"mat-dialog-title"],[1,"row","full-width"],[1,"col-md-9"],[1,"header-subtitle"],[1,"col-md-3"],[1,"float-end","close-icon",3,"click"],["mat-dialog-content","",1,"mat-dialog-content-cstm"],[1,"vendor-wapper"],[4,"ngFor","ngForOf"],[1,"footer-template"],["type","button",1,"cancel-btn","cstm-btn",3,"click"],["type","submit","color","primary",1,"cstm-btn","theme-btn-color",3,"click"],[4,"ngIf"],["class","vendor-name-cl",4,"ngIf"],[1,"vendor-value-cont"],[1,"vendor-value-label"],[1,"vendor-value"],[1,"vendor-value-cont",2,"background-color","#073B4C14"],[1,"vendor-name-cl"],[2,"display","flex","justify-content","space-between"],["type","checkbox",2,"width","20px",3,"checked","disabled","change"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Vendors rate "),t.TgZ(4,"div",3),t._uU(5),t.qZA(),t.TgZ(6,"div",3),t._uU(7),t.qZA(),t.TgZ(8,"div",3),t._uU(9),t.qZA()(),t.TgZ(10,"div",4)(11,"mat-icon",5),t.NdJ("click",function(){return o.onNoClick()}),t._uU(12,"close"),t.qZA()()()(),t.TgZ(13,"div",6)(14,"div",7),t.YNc(15,rt,2,1,"div",8),t.qZA()(),t.TgZ(16,"div",9)(17,"button",10),t.NdJ("click",function(){return o.onNoClick()}),t._uU(18," Cancel "),t.qZA(),t.TgZ(19,"button",11),t.NdJ("click",function(){return o.onClickSubmit()}),t._uU(20," Submit "),t.qZA()()),2&e&&(t.xp6(5),t.hij(" Item : ",o.item.item_name," "),t.xp6(2),t.hij(" Max Qty : ",o.item.qty," "),t.xp6(2),t.hij(" Remaning Qty to select: ",o.item.qty-o.totalQuantity," "),t.xp6(6),t.Q6J("ngForOf",o.vendorItems))},dependencies:[u.sg,u.O5,v.uh,v.xY,R.Hw,u.JJ],styles:[".mat-mdc-dialog-title[_ngcontent-%COMP%]{border-bottom:0;padding:14px;background:#f3f3f3;display:flex;justify-content:space-between;align-items:center;font-style:normal;font-weight:400;font-size:14px;line-height:16px;text-transform:capitalize;color:#28313b}.mat-mdc-dialog-content-cstm[_ngcontent-%COMP%]{padding-top:10px}.cancel-btn[_ngcontent-%COMP%]{background:#f3f3f3;color:#333}.space-btn[_ngcontent-%COMP%]{margin:0 5px}.mat-mdc-dialog-content[_ngcontent-%COMP%]{margin:0;padding:0 15px}.close-icon[_ngcontent-%COMP%]{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:13px;width:0px;margin-top:-5px;cursor:pointer}.vendor_list_table[_ngcontent-%COMP%]{width:100%;border-radius:5px;overflow:hidden}.vendor_list_table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;padding:10px 20px;font-weight:400}.vendor_list_table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 20px}.vendor_list_table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#eee}.cstm-btn[_ngcontent-%COMP%]{border:0;border-radius:4px;padding:10px 23px;outline:none}.cstm-btn.theme-btn-color[_ngcontent-%COMP%]{background-color:#233a61;color:#fff}.footer-template[_ngcontent-%COMP%]{text-align:center;border-top:1px solid #ccc;margin:30px 0 0;padding-top:22px;display:flex;align-items:center;justify-content:center;gap:10px}.cstm-input[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;padding:5px 10px}.td-subtitle[_ngcontent-%COMP%]{font-size:11px;font-weight:400}.header-subtitle[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.vendor-wapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:40px}.vendor-wapper[_ngcontent-%COMP%]   .vendor-name-cl[_ngcontent-%COMP%]{padding:6px 15px;background:#233a61;color:#fff}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-cont[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:rgba(7,59,76,.0509803922);padding:6px 15px;margin-bottom:10px;gap:10px}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-cont[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80px;border:1px solid #ccc;border-radius:2px;padding:5px;outline:none}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-label[_ngcontent-%COMP%]{min-width:144px}"]}),n})();var pt=l(4961),lt=l(3546),N=l(1948);function dt(n,a){if(1&n&&(t.TgZ(0,"mat-option",52),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",null==e?null:e._id),t.xp6(1),t.hij(" ",null==e?null:e.name," ")}}function ct(n,a){if(1&n&&(t.TgZ(0,"mat-option",52),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.site_name," ")}}function gt(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",e.tax.name,"(",e.tax.amount,"%) ")}}function ut(n,a){if(1&n&&(t.TgZ(0,"tbody")(1,"tr",58)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td",59),t._uU(5),t.qZA(),t.TgZ(6,"td",59),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t.YNc(15,gt,2,2,"ng-container",60),t.qZA()()()),2&n){const e=a.$implicit,o=t.oxw(3);t.xp6(3),t.hij(" ",e.item_name," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.Oqu(o.myBrandName(e.brandName)),t.xp6(2),t.Q6J("ngIf",e.tax&&e.tax.amount)}}function _t(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",65)(1,"div",66)(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"input",67),t.NdJ("change",function(){const s=t.CHM(e).ngIf,p=t.oxw().ngIf,d=t.oxw().$implicit,c=t.oxw(3);return t.KtG(c.handleCheckboxChange(s._id,d,p))}),t.qZA()()()()}if(2&n){const e=a.ngIf,o=t.oxw(5);t.xp6(3),t.Oqu(e.vendor_name),t.xp6(2),t.Q6J("disabled",o.VendorRate.size>0&&!o.VendorRate.has(e._id))}}function mt(n,a){if(1&n&&(t.TgZ(0,"div")(1,"div",62)(2,"div",63),t._uU(3),t.qZA(),t.TgZ(4,"div",64),t._uU(5),t.ALo(6,"number"),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(3),t.hij("SubTotal ",e.item.item_name," "),t.xp6(2),t.hij(" ",t.xi3(6,2,e.SubTotalAmount,"1.2-2")," ")}}function ft(n,a){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,_t,6,2,"div",61),t.YNc(2,mt,7,5,"div",56),t.TgZ(3,"div",62)(4,"div",63),t._uU(5,"Total Freight (Inc* All Items)"),t.qZA(),t.TgZ(6,"div",64),t._uU(7),t.ALo(8,"number"),t.qZA()(),t.TgZ(9,"div",62)(10,"div",63),t._uU(11,"Total GST"),t.qZA(),t.TgZ(12,"div",64),t._uU(13),t.ALo(14,"number"),t.qZA()(),t.TgZ(15,"div",62)(16,"div",63),t._uU(17,"Sub Total (Inc* All Items)"),t.qZA(),t.TgZ(18,"div",64),t._uU(19),t.ALo(20,"number"),t.qZA()(),t.TgZ(21,"div",62)(22,"div",63),t._uU(23,"Grand Total (Inc* All Items)"),t.qZA(),t.TgZ(24,"div",64),t._uU(25),t.ALo(26,"number"),t.qZA()()()),2&n){const e=a.ngIf,o=t.oxw(),i=o.$implicit,s=o.index,p=t.oxw(3);t.xp6(1),t.Q6J("ngIf",p.findVendor(i.Vendor)),t.xp6(1),t.Q6J("ngForOf",p.details.vendorItems[s].items),t.xp6(5),t.hij(" ",t.xi3(8,6,e.freight,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(14,9,e.total-e.subTotal-e.freight,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(20,12,e.subTotal,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(26,15,e.total,"1.2-2")," ")}}function xt(n,a){if(1&n&&(t.TgZ(0,"div")(1,"div"),t.YNc(2,ft,27,18,"div",60),t.qZA()()),2&n){const e=a.$implicit,o=t.oxw(3);t.xp6(2),t.Q6J("ngIf",o.vendorTotal(e.items))}}function ht(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"table",55)(2,"tr")(3,"th"),t._uU(4,"Item*"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Category"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Sub\xa0category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Uom"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Quantity"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Brand Name"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Tax"),t.qZA()(),t.YNc(17,ut,16,7,"tbody",56),t.qZA(),t.TgZ(18,"div"),t._uU(19,"Select Vendor"),t.qZA(),t.TgZ(20,"div",57),t.YNc(21,xt,3,1,"div",56),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(17),t.Q6J("ngForOf",null==e.details?null:e.details.items),t.xp6(4),t.Q6J("ngForOf",e.details.vendorItems)}}function vt(n,a){1&n&&t._uU(0," Vendor Comparison is not Applicable. ")}function Zt(n,a){if(1&n&&(t.TgZ(0,"div",53),t.YNc(1,ht,22,2,"ng-container",48),t.YNc(2,vt,1,0,"ng-template",null,54,t.W1O),t.qZA()),2&n){const e=t.MAs(3),o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.CheckVendorComparision())("ngIfElse",e)}}function bt(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",e.tax.name,"(",e.tax.amount,"%) ")}}function At(n,a){1&n&&(t.ynx(0),t.TgZ(1,"p",70),t._uU(2,"Completed"),t.qZA(),t.BQk())}function Ct(n,a){1&n&&(t.TgZ(0,"p",71),t._uU(1,"Pending"),t.qZA())}function Tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tbody")(1,"tr",58)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td",59),t._uU(5),t.qZA(),t.TgZ(6,"td",59),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t.YNc(15,bt,2,2,"ng-container",60),t.qZA(),t.TgZ(16,"td")(17,"a",68),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.vendorData(s))}),t._uU(18,"Vendor Rates"),t.qZA()(),t.TgZ(19,"td"),t.YNc(20,At,3,0,"ng-container",48),t.YNc(21,Ct,2,0,"ng-template",null,69,t.W1O),t.qZA()()()}if(2&n){const e=a.$implicit,o=t.MAs(22),i=t.oxw(2);t.xp6(3),t.hij(" ",e.item_name," "),t.xp6(2),t.hij(" ",e.categoryDetail.name," "),t.xp6(2),t.hij(" ",e.subCategoryDetail.subcategory_name," "),t.xp6(2),t.hij(" ",e.uomDetail.uom_name," "),t.xp6(2),t.hij(" ",e.qty," "),t.xp6(2),t.Oqu(i.myBrandName(e.brandName)),t.xp6(2),t.Q6J("ngIf",e.tax&&e.tax.amount),t.xp6(5),t.Q6J("ngIf",i.ItemwiseVendorRate.has(e.item_id))("ngIfElse",o)}}function yt(n,a){if(1&n&&(t.TgZ(0,"div",53)(1,"table",55)(2,"tr")(3,"th"),t._uU(4,"Item*"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Category"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Sub\xa0category"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Uom"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Quantity"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Brand Name"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Tax"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Vendors"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Vendor Selection"),t.qZA()(),t.YNc(21,Tt,23,9,"tbody",56),t.qZA()()),2&n){const e=t.oxw();t.xp6(21),t.Q6J("ngForOf",null==e.details?null:e.details.items)}}function qt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Santion"),t.qZA())}function Ut(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Please wait..."),t.qZA())}function wt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateRequest("approved"))}),t.YNc(2,qt,2,0,"span",60),t.YNc(3,Ut,2,0,"span",60),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.load),t.xp6(1),t.Q6J("ngIf",!e.load),t.xp6(1),t.Q6J("ngIf",e.load)}}function kt(n,a){1&n&&(t.TgZ(0,"button",73)(1,"span"),t._uU(2,"No Permission To Santion"),t.qZA()())}function Rt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Reject"),t.qZA())}function Pt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Please wait..."),t.qZA())}function Mt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateRequest("rejected"))}),t.YNc(2,Rt,2,0,"span",60),t.YNc(3,Pt,2,0,"span",60),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.load),t.xp6(1),t.Q6J("ngIf",!e.load),t.xp6(1),t.Q6J("ngIf",e.load)}}function Lt(n,a){1&n&&(t.TgZ(0,"button",73)(1,"span"),t._uU(2,"No Permission To Reject"),t.qZA()())}function Ot(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Revise"),t.qZA())}function It(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Please wait..."),t.qZA())}function Nt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateRequest("revise"))}),t.YNc(2,Ot,2,0,"span",60),t.YNc(3,It,2,0,"span",60),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.load),t.xp6(1),t.Q6J("ngIf",!e.load),t.xp6(1),t.Q6J("ngIf",e.load)}}function Qt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"No Permission To Revise"),t.qZA())}function Jt(n,a){if(1&n&&(t.TgZ(0,"button",73),t.YNc(1,Qt,2,0,"span",60),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.load)}}const Vt=function(){return["/procurement"]},Yt=function(){return["/procurement/prlist"]},Dt=function(){return["/rate-comparative"]},St=function(){return["/rate-approval"]},Ft=function(){return["/purchase-order"]},Q=function(n){return{active:n}};let jt=(()=>{class n{constructor(e,o,i,s,p,d,c,g){this.router=e,this.httpService=o,this.snack=i,this.formBuilder=s,this.route=p,this.dialog=d,this.http=c,this.userService=g,this.load=!1,this.VendorRate=new Map,this.ItemwiseVendorRate=new Map,this.compareBy="item",this.purchaseRequestForm=new r.cw({title:new r.NI({value:"",disabled:!0},r.kI.required),date:new r.NI({value:"",disabled:!0},r.kI.required),expected_delivery_date:new r.NI({value:"",disabled:!0},r.kI.required),handle_by:new r.NI({value:"",disabled:!0},r.kI.required),rate_approval_number:new r.NI(""),site:new r.NI({value:"",disabled:!0},r.kI.required),local_purchase:new r.NI({value:"",disabled:!0},r.kI.required),remarks:new r.NI({value:"",disabled:!0},[]),items:this.formBuilder.array([]),_id:new r.NI}),this.details={},this.users=[],this.getList(),this.getBrandList(),this.getVendorList(),this.userService.getUserss().subscribe(x=>{this.users=x})}vendorData(e){this.dialog.open(st,{data:{item:e,vendorItems:this.details.vendorItems,fetchedVendorList:this.fetchedVendorList,pageData:this.ItemwiseVendorRate.get(e.item_id)}}).afterClosed().subscribe(i=>{i&&i.data&&i.data.VendorRate&&(console.log(i.data),i.data.VendorRate.size>0?this.ItemwiseVendorRate.set(e.item_id,i.data):this.ItemwiseVendorRate.delete(e.item_id))})}getList(){const e=this.http.get(`${b.N.api_path}${m.S3}`),o=this.http.get(`${b.N.api_path}${m.TK}`);this.httpService.multipleRequests([e,o],{}).subscribe(i=>{i&&(console.log(i[1].data),this.siteList=i[0].data,this.purchaseList=i[1].data)})}compare(e){this.VendorRate.clear(),this.ItemwiseVendorRate.clear(),this.compareBy="vendor"==e?"vendor":"item"}patchData(e){this.purchaseRequestForm.patchValue({title:e.title,date:e.date,expected_delivery_date:e.expected_delivery_date,rate_approval_number:e.rate_approval_number,handle_by:e.handle_by,site:e.site,local_purchase:e.local_purchase,remarks:e.remarks}),this.curr_site=e.site,this.purchaseRequestForm.controls.remarks.disable()}createItemArrayForm(){return new r.cw({item_id:new r.NI("",r.kI.required),qty:new r.NI("",r.kI.required),category:new r.NI(""),subCategory:new r.NI(""),attachment:new r.NI(""),remark:new r.NI("",r.kI.required),uom:new r.NI("",r.kI.required)})}addItems(e){this.items=this.purchaseRequestForm.get("items"),e&&this.items.push(this.createItem(e))}createItem(e){if(e)return new r.cw({item_id:new r.NI(e.item_id,r.kI.required),qty:new r.NI(e.qty,r.kI.required),category:new r.NI(e.categoryDetail.name),subCategory:new r.NI(e.subCategoryDetail.subcategory_name),attachment:new r.NI(e.attachment),remark:new r.NI(e.remark,r.kI.required),uom:new r.NI(e.uomDetail._id,r.kI.required)})}getSiteList(){this.httpService.GET(m.S3,{}).subscribe(e=>{this.siteList=e})}getVendorList(){this.httpService.GET("/vendor",{}).subscribe(e=>{this.fetchedVendorList=e.data})}findVendor(e){return this.fetchedVendorList.find(o=>o._id==e)}CheckVendorComparision(){console.log(this.details);let e=!1;for(const o of this.details.vendorItems)if(o.items.length===this.details.items.length){e=!0;break}return e}vendorTotal(e){console.log("check Item",e);let o=0,i=0,s=0,p=0,d=0,c=0;return e.forEach(g=>{o=g.SubTotalAmount+o,i=+g.Total+ +i,s=+g.Freight+ +s,p=i-o-s,d=g.Rate,c=g.RequiredQuantity}),{subTotal:o,gstAmount:p,total:i,freight:s,rate:d,qty:c}}handleCheckboxChange(e,o,i){this.VendorRate.has(e)?this.deleteVendor(e,o,i):this.addVendor(e,o,i)}deleteVendor(e,o,i){this.VendorRate.delete(e)}addVendor(e,o,i){this.VendorRate.set(e,{...o,...i})}getBrandList(){this.httpService.GET(m.Lk,{}).subscribe(e=>{this.brandList=e.data})}myBrandName(e){return this.brandList.filter(i=>i._id==e)[0].brand_name}updateRequest(e){if("revise"==e)this.details.status=e,this.details.stage="rate_comparitive";else if("rejected"==e)this.details.status=e;else{this.siteList.find(_=>_._id==this.curr_site).site_name.replace(/[ ,]/g,"_");const s=(new Date).getFullYear(),p=s+1,x=(String(s).slice(-2),String(p).slice(-2),this.purchaseList.filter(_=>_.billing_address.company_name.includes("Pragati Infra Solutions Pvt. Ltd.")).length+1);if(this.po_no=x,"vendor"==this.compareBy){let _=[];this.VendorRate.forEach((T,Kt)=>{_.push(T)}),this.details.vendorRatesVendorWise=_,this.details.compareBy=this.compareBy,this.details.po_number=this.po_no,this.details.Pocount=x,"revise"==this.details.status&&(this.details.isRevised=!0),this.details.status="approved"}else{let _=[];this.ItemwiseVendorRate.forEach((T,Kt)=>{T.VendorRate.forEach((Ht,Xt)=>{_.push(Ht)})}),this.details.vendorRatesItemWise=_,this.details.compareBy=this.compareBy,this.details.po_number=this.po_no,this.details.Pocount=x,"revise"==this.details.status&&(this.details.isRevised=!0),this.details.status="approved"}if(!this.purchaseRequestForm.valid)return}this.load=!0,this.httpService.PUT(m.lu,this.details).subscribe(o=>{this.snack.notify("Detail has been updated",1),this.router.navigate(["/rate-approval"]),this.load=!1},o=>{if(this.load=!1,o.errors&&!(0,q.isEmpty)(o.errors)){let i="<ul>";for(let s in o.errors)i+=`<li>${o.errors[s][0]}</li>`;i+="</ul>",this.snack.notifyHtml(i,2)}else this.snack.notify(o.message,2)})}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("loginData")),this.httpService.GET(`/roles/role/${this.permissions.user.role}`,{}).subscribe({next:i=>{console.log(i),this.viewPermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[0].isSelected,this.addPermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[1].isSelected,this.editPermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[2].isSelected,this.deletePermission=i.dashboard_permissions[0].ParentChildchecklist[21].childList[3].isSelected},error:i=>{console.log(i)}}),this.route.params.subscribe(i=>{i.id&&this.httpService.GET(`${m.bG}`,{_id:i.id}).subscribe({next:s=>{this.details=s.data.details,console.log("API",this.details),this.patchData(s.data.details)}})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.F0),t.Y36(A.s),t.Y36(C.o),t.Y36(r.qu),t.Y36(f.gz),t.Y36(v.uw),t.Y36(U.eN),t.Y36(pt.f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-rate-approval-update"]],decls:118,vars:33,consts:[[2,"height","100px","background-color","#fff"],[2,"margin-top","50px","margin-left","20px"],["src","./assets/images/RA.svg"],[2,"font-family","Poppins","margin-top","40px","font-style","normal","font-weight","600","font-size","30px","color","#1E293B","margin-left","10px"],[1,"example-spacer"],[2,"width","1130px","border","2px solid #C5C5C5","margin-left","30px"],[2,"display","flex","flex-direction","row","font-family","Poppins","font-weight","600"],[2,"margin-top","20px","margin-left","30px","display","flex"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","30px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/box.svg"],[2,"color","#97989D","margin-left","5px","font-size","14px"],[2,"width","90px","margin-left","10px","margin-top","10px","border","1px dashed"],["routerLinkActive","active-link",2,"margin-top","20px","margin-left","10px","display","flex","cursor","pointer",3,"routerLink"],["src","./assets/images/approval.svg"],["src","./assets/images/rc.svg"],["src","./assets/images/app.svg"],[2,"color","#233A61","margin-left","5px","font-size","14px"],["src","./assets/images/po.svg"],[3,"formGroup"],[1,"topcard"],[2,"display","flex","flex-wrap","wrap","gap","10px","max-width","100%"],[1,"flex-div",2,"display","flex","flex-direction","column"],[2,"color","#4272BF","font-size","14px"],["appearance","outline"],["placeholder","Enter title","formControlName","title","matInput",""],["matInput","","formControlName","date","placeholder","Auto generate Request Date","readonly","",3,"matDatepicker"],["matSuffix","",3,"for"],["date",""],[1,"flex-div","custom-form-group"],["for","",1,"custom-label",2,"color","#4272BF","font-size","14px"],[1,"star"],[1,"custom-form-control"],["matInput","","formControlName","expected_delivery_date","placeholder","Enter Required by","readonly","",3,"matDatepicker"],["requiredByStartDate",""],["matInput","","formControlName","handle_by"],[3,"value",4,"ngFor","ngForOf"],["id","site","placeholder","Select site","formControlName","site"],[1,"flex-div",2,"display","flex","flex-direction","column","margin-left","10px"],[2,"color","#4272BF","margin-bottom","10px"],["aria-labelledby","example-radio-group-label","color","primary","formControlName","local_purchase",1,"example-radio-group"],[1,"example-radio-button",2,"margin-right","10px",3,"value"],[1,"example-radio-button",3,"value"],[1,"requests"],[3,"ngClass","click"],["class","scroll-bar1",4,"ngIf"],[1,"text-area-section"],["name","","id","","cols","30","rows","5","formControlName","remarks"],[1,"button-list"],[4,"ngIf","ngIfElse"],["noAddPermission",""],["noDeletePermission",""],["noEditPermission",""],[3,"value"],[1,"scroll-bar1"],["noview",""],[2,"direction","ltr !important","border-left","2px solid #000 !important"],[4,"ngFor","ngForOf"],[1,"vendor-wapper"],[2,"background-color","#F4F4F5"],[2,"color","#000"],[4,"ngIf"],["class","vendor-name-cl",4,"ngIf"],[1,"vendor-value-cont"],[1,"vendor-value-label"],[1,"vendor-value"],[1,"vendor-name-cl"],[2,"display","flex","justify-content","space-between"],["type","checkbox",2,"width","20px",3,"disabled","change"],[1,"p-btns",2,"display","inline-block","padding","10px 20px","background-color","#233a61","color","#fff","text-decoration","none","border-radius","5px",3,"click"],["pendingView",""],[2,"color","green"],[2,"color","red"],[1,"p-btns-button",3,"disabled","click"],["disabled","",1,"p-btns-button"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"span",3),t._uU(4,"Rate Approval "),t.qZA(),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div"),t._UZ(7,"hr",5),t.qZA(),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div"),t._UZ(12,"img",9),t.qZA(),t.TgZ(13,"span",10),t._uU(14,"Purchase\xa0request"),t.qZA(),t.TgZ(15,"div"),t._UZ(16,"mat-divider",11),t.qZA()(),t.TgZ(17,"div",12)(18,"div"),t._UZ(19,"img",13),t.qZA(),t.TgZ(20,"span",10),t._uU(21,"Approvals"),t.qZA(),t.TgZ(22,"div"),t._UZ(23,"mat-divider",11),t.qZA()(),t.TgZ(24,"div",12)(25,"div"),t._UZ(26,"img",14),t.qZA(),t.TgZ(27,"span",10),t._uU(28,"Rate\xa0Comparative"),t.qZA(),t.TgZ(29,"div"),t._UZ(30,"mat-divider",11),t.qZA()(),t.TgZ(31,"div",12)(32,"div"),t._UZ(33,"img",15),t.qZA(),t.TgZ(34,"span",16),t._uU(35,"Rate\xa0Approvals"),t.qZA(),t.TgZ(36,"div"),t._UZ(37,"mat-divider",11),t.qZA()(),t.TgZ(38,"div",12)(39,"div"),t._UZ(40,"img",17),t.qZA(),t.TgZ(41,"span",10),t._uU(42,"Purchase\xa0orders"),t.qZA()()()(),t.TgZ(43,"form",18)(44,"mat-card",19)(45,"div",20)(46,"div",21)(47,"label",22),t._uU(48,"Request title "),t.qZA(),t.TgZ(49,"mat-form-field",23),t._UZ(50,"input",24),t.qZA()(),t.TgZ(51,"div",21)(52,"label",22),t._uU(53,"Request date"),t.qZA(),t.TgZ(54,"mat-form-field",23),t._UZ(55,"input",25)(56,"mat-datepicker-toggle",26)(57,"mat-datepicker",null,27),t.qZA()(),t.TgZ(59,"div",28)(60,"label",29),t._uU(61," Required by "),t.TgZ(62,"span",30),t._uU(63,"*"),t.qZA()(),t.TgZ(64,"div",31)(65,"mat-form-field",23),t._UZ(66,"input",32)(67,"mat-datepicker-toggle",26)(68,"mat-datepicker",null,33),t.qZA()()(),t.TgZ(70,"div",28)(71,"label",29),t._uU(72," Handle by "),t.TgZ(73,"span",30),t._uU(74,"*"),t.qZA()(),t.TgZ(75,"div",31)(76,"mat-form-field",23)(77,"mat-select",34),t.YNc(78,dt,2,2,"mat-option",35),t.qZA()()()(),t.TgZ(79,"div",21)(80,"label",22),t._uU(81,"Site name "),t.TgZ(82,"span",30),t._uU(83,"*"),t.qZA()(),t.TgZ(84,"mat-form-field",23)(85,"mat-select",36),t.YNc(86,ct,2,2,"mat-option",35),t.qZA()()(),t.TgZ(87,"div",37)(88,"label",38),t._uU(89,"Local Purchase "),t.TgZ(90,"span",30),t._uU(91,"*"),t.qZA()(),t.TgZ(92,"mat-radio-group",39)(93,"mat-radio-button",40),t._uU(94," Yes "),t.qZA(),t.TgZ(95,"mat-radio-button",41),t._uU(96," No "),t.qZA()()()()(),t.TgZ(97,"div",42)(98,"div",43),t.NdJ("click",function(){return o.compare("vendor")}),t._uU(99,"Compare By Vendor"),t.qZA(),t.TgZ(100,"div",43),t.NdJ("click",function(){return o.compare("item")}),t._uU(101,"Compare by Items"),t.qZA()(),t.YNc(102,Zt,4,2,"div",44),t.YNc(103,yt,22,1,"div",44),t.TgZ(104,"div",45)(105,"label",22),t._uU(106,"Remarks "),t.qZA(),t._UZ(107,"textarea",46),t.qZA(),t.TgZ(108,"div",47),t.YNc(109,wt,4,3,"ng-container",48),t.YNc(110,kt,3,0,"ng-template",null,49,t.W1O),t.YNc(112,Mt,4,3,"ng-container",48),t.YNc(113,Lt,3,0,"ng-template",null,50,t.W1O),t.YNc(115,Nt,4,3,"ng-container",48),t.YNc(116,Jt,2,1,"ng-template",null,51,t.W1O),t.qZA()()),2&e){const i=t.MAs(58),s=t.MAs(69),p=t.MAs(111),d=t.MAs(114),c=t.MAs(117);t.xp6(10),t.Q6J("routerLink",t.DdM(24,Vt)),t.xp6(7),t.Q6J("routerLink",t.DdM(25,Yt)),t.xp6(7),t.Q6J("routerLink",t.DdM(26,Dt)),t.xp6(7),t.Q6J("routerLink",t.DdM(27,St)),t.xp6(7),t.Q6J("routerLink",t.DdM(28,Ft)),t.xp6(5),t.Q6J("formGroup",o.purchaseRequestForm),t.xp6(12),t.Q6J("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(10),t.Q6J("matDatepicker",s),t.xp6(1),t.Q6J("for",s),t.xp6(11),t.Q6J("ngForOf",o.users),t.xp6(8),t.Q6J("ngForOf",o.siteList),t.xp6(7),t.Q6J("value","yes"),t.xp6(2),t.Q6J("value","no"),t.xp6(3),t.Q6J("ngClass",t.VKq(29,Q,"vendor"==o.compareBy)),t.xp6(2),t.Q6J("ngClass",t.VKq(31,Q,"item"==o.compareBy)),t.xp6(2),t.Q6J("ngIf","vendor"==o.compareBy),t.xp6(1),t.Q6J("ngIf","item"==o.compareBy),t.xp6(6),t.Q6J("ngIf",o.editPermission||o.addPermission)("ngIfElse",p),t.xp6(3),t.Q6J("ngIf",o.deletePermission)("ngIfElse",d),t.xp6(3),t.Q6J("ngIf",o.editPermission)("ngIfElse",c)}},dependencies:[u.mk,u.sg,u.O5,f.rH,f.Od,w.ey,Z.KE,Z.R9,lt.a8,h.Mq,h.hl,h.nW,k.d,P.Nt,N.VQ,N.U0,M.gD,L.Ye,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,u.JJ],styles:['mat-toolbar[_ngcontent-%COMP%]{height:100px;background-color:#fff}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.requests[_ngcontent-%COMP%]{height:40px;width:1140px;background-color:#d9d9d9;display:flex;justify-content:space-around;align-items:center;margin-top:20px;margin-left:30px;font-size:14px}.requests[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{height:40px;width:250px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;flex:1}.requests[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background:rgba(0,0,0,.2)}.requests[_ngcontent-%COMP%]   div.active[_ngcontent-%COMP%]{background-color:#233a61!important;color:#fff}.innerreq[_ngcontent-%COMP%]{color:#233a61;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px}.createreq[_ngcontent-%COMP%]{background-color:#233a61;color:#fff;height:40px;width:250px;margin-left:-80px;font-family:Poppins;font-weight:600;font-style:normal;font-size:14px;display:flex;align-items:center;justify-content:center}.topcard[_ngcontent-%COMP%]{width:100%;height:auto;font-family:Poppins;box-shadow:none;border:1px solid #ccc;border-radius:4px}table[_ngcontent-%COMP%]{font-family:Poppins,sans-serif!important;border-collapse:collapse;font-size:14px;margin-bottom:20px;margin-right:20px;margin-top:8px}th[_ngcontent-%COMP%]{background-color:#233a61;border:1px solid #94a3b8;text-align:left;padding:10px 40px!important;color:#fff;font-weight:100;font-size:14px;font-style:normal}td[_ngcontent-%COMP%]{border:1px solid #94a3b8;text-align:left;padding:20px;color:#233a61;font-style:normal;font-size:14px;font-family:Poppins}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#e5e6eb!important}form[_ngcontent-%COMP%]{padding:10px 20px}.scroll-bar1[_ngcontent-%COMP%]{margin-top:50px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;height:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border:1px solid lightgrey;border-radius:5px;background-color:#d3d3d3}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e293b;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:lightblue}.pr-form-field[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:6px;border:1px solid #9f9f9f;cursor:pointer;background-color:"Transparent"}.select-form-field[_ngcontent-%COMP%]{padding:10px;width:150px;border:1px solid #9f9f9f;border-radius:20px;cursor:pointer;background-color:"Transparent "!important}.action-btn-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding:5px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#233a61;opacity:.8;font-size:13px}.action-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:.7}.button-list[_ngcontent-%COMP%]{display:inline-flex;margin:15px 0 20px;float:right;gap:10px}.text-area-section[_ngcontent-%COMP%]{width:100%;height:auto;margin:30px 0 0}.text-area-section[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{display:block;width:100%}.flex-div[_ngcontent-%COMP%]{width:31%}.mat-form-field[_ngcontent-%COMP%]{display:block}.pending[_ngcontent-%COMP%]{padding:8px;width:120px;background-color:#ccc;color:#333;font-size:14px;font-family:Poppins;height:50px;border:none}.p-btns[_ngcontent-%COMP%]{background:#233a61;padding:5px 10px;border-radius:4px;font-size:12px;cursor:pointer}.p-btns[_ngcontent-%COMP%]:hover{opacity:.7}.p-btns-button[_ngcontent-%COMP%]{background:#233a61;border:1px solid #233a61;padding:7px 40px;border-radius:4px;font-size:12px;cursor:pointer;color:#fff}.p-btns-button[_ngcontent-%COMP%]:hover{opacity:.7}.vendor-wapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:40px}.vendor-wapper[_ngcontent-%COMP%]   .vendor-name-cl[_ngcontent-%COMP%]{padding:6px 15px;background:#233a61;color:#fff}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-cont[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:rgba(7,59,76,.0509803922);padding:6px 15px;margin-bottom:10px;gap:10px}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-cont[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80px;border:1px solid #ccc;border-radius:2px;padding:5px;outline:none}.vendor-wapper[_ngcontent-%COMP%]   .vendor-value-label[_ngcontent-%COMP%]{min-width:144px}input[readonly=true][_ngcontent-%COMP%], input[readonly][_ngcontent-%COMP%], .mat-select-disabled[_ngcontent-%COMP%]{opacity:.6}']}),n})();var Bt=l(9836),zt=l(8898),Et=l(1283);const $t=[{path:"",component:nt},{path:"update/:id",component:jt}];let Gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,f.Bz,zt.S,r.UX,Bt.w,Et.Z,[f.Bz.forChild($t)]]}),n})()}}]);