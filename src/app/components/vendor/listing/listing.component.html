<div class="section-wrapper">
  <ng-container *ngIf="viewPermission; else noView">
    <div class="section-header">
      <div class="header-left">
        <h2>Vendor Master</h2>
      </div>
      <div class="header-right">
        <div class="buttons-containers">
          <div class="filter-con">
            <div dir="ltr" class="labeled-outlined-field-wrapper">
              <mat-form-field
                class="full-width drop-down outline-filter-field hide-form-bottom-field"
                appearance="outline"
              >
                <input
                  matInput
                  placeholder="Search by name"
                  (input)="search($event)"
                />
              </mat-form-field>
            </div>
          </div>
          <button mat-button class="submit-btn" (click)="add()">Add New</button>
          <button mat-button class="submit-btn" (click)="fileInput.click()">Import</button>
          <button mat-button class="other-btn" (click)="exportXlSX()">
            Export
          </button>
          <input type="file" #fileInput style="display: none;" (change)="onFileSelected($event)" />
        </div>
      </div>
    </div>
    <div class="section-body">
      <div style="overflow-x: auto;overflow-y: auto; max-height: 700px; "> <!-- Only horizontal scrolling -->
        <table class="table pragati-table" style="min-width: 1500px;"> <!-- Increased table width -->
          <thead>
            <tr>
              <th scope="col" style="min-width: 50px;">Sr. No.</th>
              <th scope="col" style="min-width: 150px;">Vendor Name</th>
              <th scope="col" style="min-width: 100px;">Code</th>
              <th scope="col" style="min-width: 100px;">Vendor Type</th>
              <th scope="col" style="min-width: 100px;">Scope</th>
              <th scope="col" style="min-width: 150px;">Category</th>
              <th scope="col" style="min-width: 150px;">Sub Category</th>
              <th scope="col" style="min-width: 150px;">Contact Person</th>
              <th scope="col" style="min-width: 120px;">Phone Number</th>
              <th scope="col" style="min-width: 150px;">GST Number</th>
              <th scope="col" style="min-width: 150px;">PAN Number</th>
              <th scope="col" style="min-width: 150px;">MSME Number</th>
              <th scope="col" style="min-width: 200px;">Email</th>
              <th scope="col" style="min-width: 400px;">Address</th>
              <th scope="col" style="min-width: 150px;">City</th>
              <th scope="col" style="min-width: 150px;">State</th>
              <th scope="col" style="min-width: 150px;">Payment Term</th>
              <th scope="col" style="min-width: 200px;">Term & Condition</th>
              <th scope="col" style="min-width: 100px;">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of vendorList; let i = index">
              <td scope="row" style="text-align: right;">{{ i + 1 }}</td>
              <td style="text-align: left;">{{ item?.vendor_name }}</td>
              <td style="text-align: left;">{{ item?.code }}</td>
              <td style="text-align: left;"></td>
              <td style="text-align: left;"></td>
              <td style="text-align: left;">{{ item?.category }}</td>
              <td style="text-align: left;">{{ item?.SubCategory }}</td>
              <td style="text-align: left;">{{ item?.contact_person }}</td>
              <td style="text-align: right;">{{ item?.phone_number }}</td>
              <td style="text-align: left;">{{ item?.gst_number }}</td>
              <td style="text-align: left;">{{ item?.pan_number }}</td>
              <td style="text-align: left;"></td>
              <td style="text-align: left;">{{ item?.email }}</td>
              <td style="text-align: left;">{{combineAddress( item?.address) }}</td>
              <td style="text-align: left;">{{ item?.address?.city}}</td>
              <td style="text-align: left;">{{item?.address?.state }}</td>
              <td style="text-align: left;">{{ item?.payment_terms }}</td>
              <td style="text-align: left;">{{ item?.terms_condition }}</td>
              <td>
                <div class="action-btn-wrapper">
                  <a class="action-btn" (click)="edit(item._id)" title="Edit">
                    <i class="fa fa-edit"></i>
                  </a>
                  <a class="action-btn" (click)="delete(item._id)" title="Delete">
                    <i class="fa fa-trash"></i>
                  </a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    
  </ng-container>
  <ng-template #noView>
    <h3
      style="
        display: flex;
        justify-content: center;
        margin-top: 2%;
        font-size: 160%;
        font-weight: bolder;
        color: grey;
      "
    >
      You don't have permissions to view.
    </h3>
  </ng-template>
</div>

<!-- Error Dialog Template -->

<ng-template #errorDialog let-data>
  <h1 mat-dialog-title style="font-size: 15px; font-weight: bold;">Error in Imported Vendor List</h1>
  <div mat-dialog-content [innerHTML]="data.message" class="error-dialog-content"></div>
  <div mat-dialog-actions class="modal-actions">
    <button mat-button class="modal-close-button" (click)="dialog.closeAll()">Close</button>
  </div>
</ng-template>


