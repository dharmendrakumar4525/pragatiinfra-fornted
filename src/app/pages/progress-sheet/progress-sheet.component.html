<mat-toolbar style="background-color: #fff !important;">
  <mat-toolbar-row fxLayoutAlign="space-between center">
    <div style="padding: 1rem;margin-top: 110px;">
      <!-- <form [formGroup]="projectNameForm">
        <select style="padding: 10px;width:300px;border: none;font-size: 30px;font-weight: 600;font-family: 'Poppins';"
          (change)="onChangeProject($event)" formControlName="_id">
          <option *ngFor=" let one of projectsList" [value]="one._id">
            <h1
              style="background-color: #2E2E2E;font-size: 200px;font-weight: 400;font-style: normal;font-family: 'Poppins';">
              {{one?.projectName}}</h1>
          </option>
        </select>
      </form> -->
      <span
        style="font-size: 10px;position: relative;bottom: 40px;left:320px;font-family: 'Poppins';font-weight: bold;"><img
          src=".\assets\images\ontrack.svg">&nbsp; On Track</span>
    </div>
    <div>
      <button mat-button class="button" [routerLink]="['/add-project']">Add Project + </button>
    </div>
    <div>
      <button mat-button class="button" (click)="addMember()"> <mat-icon
          style="font-size: medium;position: relative;right:-10px;">group_add</mat-icon>
        Add Member </button>

      <button mat-button [matMenuTriggerFor]="menu"><mat-icon [matBadge]="recentActivitiesLen" matBadgeColor="warn"
          style="margin-left:-10px">notifications</mat-icon></button>
      <mat-menu #menu="matMenu">
        <div style="height: 450px;margin-top: 20px;">
          <div class="scroll-bar2" fxLayout="column">
            <div fxFlex="row" fxLayoutAlign="start" *ngFor="let data of recentActivities">
              <div mat-card-avatar class="example-header-image"></div>

              <div class="notification-container">
                <div class="content">{{data.description}}
                  <div class="time" style="color: #BBBBBB;">{{data.time}}</div><br>
                </div>
              </div>

            </div><br>


          </div>
        </div>
      </mat-menu>

    </div>
  </mat-toolbar-row>

  <mat-toolbar-row>
    <hr style="width:100%">
  </mat-toolbar-row>
</mat-toolbar>

<div>
  <ul class="toptext" style="background-color: #fff !important;list-style: none;">
    <li style="border-right: 1px solid #D9D9D9;padding-right: 10px;"><a style="color: #000;" [routerLink]="['/dpr']"
        routerLinkActive="active-link"><i class="fa fa-eye" aria-hidden="true" style="color:#97989D;"></i> <span
          style="color:#97989D;">&nbsp;Projects</span></a></li>
    <li style="border-right: 1px solid #D9D9D9;padding-right: 20px;"><a style="color: #000;"
        [routerLink]="['/view-project/data-analysis',projectId]" routerLinkActive="active-link-active"
        [routerLinkActiveOptions]="{exact: true}"><i class="fa fa-eye" aria-hidden="true" style="color:#97989D;"></i>
        <span style="color:#97989D;">&nbsp;Data-Analysis</span></a></li>
    <li style="border-right: 1px solid #D9D9D9; padding-right: 20px;"><a style="color: #000;"
        [routerLink]="['/view-project/progress-sheet',projectId]" routerLinkActive="active-link-active"><i
          class="fa fa-edit" aria-hidden="true" style="color:#233A61;"></i> <span
          style="color:#233A61">&nbsp;Progress-sheet</span></a></li>
    <li><a style="color: #000;" [routerLink]="['/view-project/calender',projectId]" routerLinkActive="active-link"><i
          class="fa fa-edit" aria-hidden="true" style="color:#97989D;"></i><span
          style="color:#97989D;">&nbsp;Calender</span></a></li>
  </ul>
</div>

<br>

<div style="background-color: #fff !important;margin-top: 20px;margin-left: 50px;">
  <h3 style="font-family: 'Poppins';">Project progress monitoring sheets(PPMS)</h3>
</div>

<!-- <button (click)="addLocation()" class="button">
  Add Location
</button> -->

<body>
  <div class="scroll-bar1" style="width: 93%;">
    <table *ngIf="progressPermissionsView?.isSelected; else noView" style="direction: ltr !important;">


      <tr>

        <th>Description <mat-icon style="margin-top: 10px;" (click)="addLocation()">add</mat-icon></th>
        <th>R1&nbsp;End&nbsp;Date</th>
        <th>R2&nbsp;End&nbsp;Date</th>
        <th>R3&nbsp;End&nbsp;Date</th>
        <th>Actual&nbsp;Revised&nbsp;Start&nbsp;Date</th>
        <th>Working&nbsp;Days&nbsp;Revised</th>
        <th>Baseline&nbsp;Start&nbsp;Date</th>
        <th>Baseline&nbsp;End&nbsp;Date</th>
        <th>Base&nbsp;Line&nbsp;Working&nbsp;Days</th>
        <th>Target&nbsp;Till&nbsp;Date&nbsp;as&nbsp;per&nbsp;Baseline</th>
        <th>No&nbsp;of&nbsp;Days&nbsp;Balance&nbsp;as&nbsp;per&nbsp;Baseline</th>
        <th>Daily&nbsp;Asking&nbsp;Rate&nbsp;as&nbsp;per&nbsp;Baseline</th>
        <th>UOM</th>
        <th>Total Quantity</th>
        <th>Cumulative&nbsp;Completed</th>
        <th>Target&nbsp;Till&nbsp;Date&nbsp;as&nbsp;per&nbsp;Revised&nbsp;End&nbsp;Date</th>
        <th>No&nbsp;of&nbsp;Days&nbsp;Balance&nbsp;as&nbsp;per&nbsp;revised&nbsp;dates</th>
        <th>Daily&nbsp;Asking&nbsp;Rate&nbsp;as&nbsp;per&nbsp;Revised&nbsp;End&nbsp;Date</th>
        <th>Activity&nbsp;Balance&nbsp;(%)</th>
        <th>Total</th>
        <th>Remarks</th>

      </tr>

      <tbody>

        <ng-container *ngFor=" let locationItem of projectLocationsList;let locationIndex=index ">

          <tr style="color:#233A61 !important;font-weight: bolder ;">
            <td>
              <div class="activityalign">
                <div style="width:120px;">{{locationItem.location_name}}

                  <div>
                    <mat-icon style="margin-top: 10px;" (click)="addStructure(locationIndex)">add</mat-icon>

                    <mat-icon style="margin-top: 10px;" (click)="deleteLocation(locationIndex)">delete</mat-icon>
                  </div>
                </div>
              </div>
            </td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>

          <ng-container *ngFor="let structureItem of locationItem.structures;let structureIndex=index">

            <tr style="color:#233A61 !important;font-weight: bolder ;">
              <td>
                <div class="activityalign structureAlign">
                  <div style="width:120px;">{{structureItem.structure_name}}
                    <div>
                      <mat-icon (click)="addActivity(locationIndex,structureIndex)">add</mat-icon>
                      <mat-icon style="margin-top: 10px;"
                        (click)="deleteStructure(locationIndex,structureIndex)">delete</mat-icon>
                    </div>

                  </div>
                </div>
              </td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>

              <td></td>
              <td></td>
              <td></td>

              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>

            <tr *ngFor="let activityItem of structureItem.activities,let activityIndex=index" style="font-size: 10px;">

              <td style="color:#595b5d;">
                <div class="descriptionalign activityAlign" style="width: 200px;">
                  <div>
                    <mat-icon (click)="addData(activityItem,locationIndex,structureIndex,activityIndex)">edit</mat-icon>
                  </div>
                  <div>{{activityItem.activity_name}}
                    <div>

                      <mat-icon (click)="deleteActivity(locationIndex,structureIndex,activityIndex)">delete</mat-icon>
                    </div>
                  </div>

                </div>
              </td>
              <td>{{activityItem?.r1EndDate | date}}</td>
              <td>{{activityItem?.r2EndDate | date}}</td>
              <td>{{activityItem?.r3EndDate | date}}</td>
              <td>{{activityItem?.actual_revised_start_date | date}}</td>
              <td>{{activityItem?.workingDaysRevised}}</td>
              <td>{{activityItem?.base_line_start_date| date}}</td>
              <td>{{activityItem?.base_line_end_date | date}}</td>
              <td>{{activityItem?.baseLineWorkingDays}}</td>
              <td>
                <span
                  *ngIf="(activityItem?.dailyCumulativeTotal == activityItem?.total) && activityItem?.dailyCumulativeTotal">Completed</span>
                <span
                  *ngIf="activityItem?.dailyCumulativeTotal !== activityItem?.total">{{activityItem?.dailyCumulativeTotal}}</span>

              </td>
              <td>{{activityItem?.noofDaysBalanceasperbaseLine}}</td>
              <td>{{activityItem?.dailyAskingRateasperbaseLine}}</td>
              <td>{{activityItem?.uom}}</td>
              <td>{{activityItem?.quantity}}</td>
              <td>{{activityItem?.dailyCumulativeTotal}}</td>
              <td>
                <span
                  *ngIf="(activityItem?.dailyCumulativeTotal == activityItem?.total) && activityItem?.dailyCumulativeTotal">Completed</span>
                <span
                  *ngIf="activityItem?.dailyCumulativeTotal !== activityItem?.total">{{activityItem?.dailyCumulativeTotal}}</span>

              </td>
              <td>{{activityItem?.noofDaysBalanceasperrevisedEnddate}}</td>
              <td>{{activityItem?.dailyAskingRateasperRevisedEndDate}}</td>
              <td>{{(100-(100 * activityItem.dailyCumulativeTotal) / activityItem.total).toFixed(0)}}</td>
              <td>{{activityItem?.dailyCumulativeTotal}}</td>
              <td><button mat-button
                  style="background-color: #233A61;color:#fff;margin-bottom: 5px;margin-top: 5px;margin-left: 8px;font-family: 'Poppins';"
                  (click)="addremarks(activityItem)">View remarks</button></td>


            </tr>

          </ng-container>

        </ng-container>




      </tbody>

    </table>
    <ng-template #noView>
      <h3>you don't have permissions to view Progress sheet</h3>
    </ng-template>

  </div>
</body>
